<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">






  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-flash.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.3.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.3.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.3.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '6.3.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="kuangbin的博客">
<meta property="og:url" content="http://kuangbin.github.io/page/7/index.html">
<meta property="og:site_name" content="kuangbin的博客">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="kuangbin的博客">



  <link rel="alternate" href="/atom.xml" title="kuangbin的博客" type="application/atom+xml" />




  <link rel="canonical" href="http://kuangbin.github.io/page/7/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>kuangbin的博客</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>
	
	<a href="https://github.com/kuangbin"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png" alt="Fork me on GitHub"></a>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">kuangbin的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首页</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-about">
    <a href="/about/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-user"></i> <br />关于</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />标签</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />分类</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />归档</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-catalogue">
    <a href="/catalogue/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />目录</a>
  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/09/30/bzoj3224/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/09/30/bzoj3224/" itemprop="url">
                  BZOJ 3224: Tyvj 1728 普通平衡树 （Scapegoat tree）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-09-30 14:15:29" itemprop="dateCreated datePublished" datetime="2014-09-30T14:15:29+08:00">2014-09-30</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 20:48:40" itemprop="dateModified" datetime="2018-07-29T20:48:40+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/" itemprop="url" rel="index"><span itemprop="name">HDU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/替罪羊树/" itemprop="url" rel="index"><span itemprop="name">替罪羊树</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://www.lydsy.com/JudgeOnline/problem.php?id=3224" target="_blank" rel="noopener">BZOJ3224</a>   水题一样。 为了练习一下替罪羊树，用这个来搞了一发。 替罪羊树可以不需要旋转来保存平衡。 当然在这题还看不到他的优势。    </p>
<h2 id="3224-Tyvj-1728-普通平衡树"><a href="#3224-Tyvj-1728-普通平衡树" class="headerlink" title="3224: Tyvj 1728 普通平衡树"></a>3224: Tyvj 1728 普通平衡树</h2><p>Time Limit: 10 Sec  Memory Limit: 128 MB Submit: 1956  Solved: 769 [<a href="http://www.lydsy.com/JudgeOnline/submitpage.php?id=3224" target="_blank" rel="noopener">Submit</a>][<a href="http://www.lydsy.com/JudgeOnline/problemstatus.php?id=3224" target="_blank" rel="noopener">Status</a>]</p>
<h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p>您需要写一种数据结构（可参考题目标题），来维护一些数，其中需要提供以下操作： 1. 插入x数 2. 删除x数(若有多个相同的数，因只删除一个) 3. 查询x数的排名(若有多个相同的数，因输出最小的排名) 4. 查询排名为x的数 5. 求x的前驱(前驱定义为小于x，且最大的数) 6. 求x的后继(后继定义为大于x，且最小的数)</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>第一行为n，表示操作的个数,下面n行每行有两个数opt和x，opt表示操作的序号(1&lt;=opt&lt;=6)</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>对于操作3,4,5,6每行输出一个数，表示对应答案</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>10 1 106465 4 1 1 317721 1 460929 1 644985 1 84185 1 89851 6 81968 1 492737 5 493598</p>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>106465 84185 492737</p>
<h2 id="HINT"><a href="#HINT" class="headerlink" title="HINT"></a>HINT</h2><p>1.n的数据范围：n&lt;=100000</p>
<p>2.每个数的数据范围：[-1e7,1e7]</p>
<h2 id="Source"><a href="#Source" class="headerlink" title="Source"></a>Source</h2><p><a href="http://www.lydsy.com/JudgeOnline/problemset.php?search=%E5%B9%B3%E8%A1%A1%E6%A0%91" target="_blank" rel="noopener">平衡树</a></p>
<pre><code>题意很简单。 直接替罪羊树练习了一发。
</code></pre><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ***************</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Author        :kuangbin</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Created Time  :2014/9/30 8:13:45</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">File Name     :E:\2014ACM\专题学习\数据结构\ScapeGoatTree\BZOJ3224.cpp</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">************************************************ */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">200010</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> alpha = <span class="number">0.75</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line"></span><br><span class="line">	Node *ch[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> size,key,nodeCount;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">bool</span> exist;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">isBad</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> ch[<span class="number">0</span>]-&gt;nodeCount &gt; alpha*nodeCount + <span class="number">5</span> || ch[<span class="number">1</span>]-&gt;nodeCount &gt; alpha*nodeCount + <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">push_up</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		size = exist + ch[<span class="number">0</span>]-&gt;size + ch[<span class="number">1</span>]-&gt;size;</span><br><span class="line"></span><br><span class="line">		nodeCount = <span class="number">1</span> + ch[<span class="number">0</span>]-&gt;nodeCount + ch[<span class="number">1</span>]-&gt;nodeCount;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ScapeGoatTree</span>&#123;</span></span><br><span class="line"></span><br><span class="line">	Node pool[MAXN];</span><br><span class="line"></span><br><span class="line">	Node *tail,*root,*null;</span><br><span class="line"></span><br><span class="line">	Node *bc[MAXN];<span class="comment">//内存回收</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> bc_top;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		tail = pool;</span><br><span class="line"></span><br><span class="line">		null = tail++;</span><br><span class="line"></span><br><span class="line">		null-&gt;ch[<span class="number">0</span>] = null-&gt;ch[<span class="number">1</span>] = null;</span><br><span class="line"></span><br><span class="line">		null-&gt;size = null-&gt;key = null-&gt;nodeCount = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		root = null;</span><br><span class="line"></span><br><span class="line">		bc_top = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">inline</span> Node *<span class="title">newNode</span><span class="params">(<span class="keyword">int</span> key)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		Node *p;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(bc_top)p = bc[--bc_top];</span><br><span class="line"></span><br><span class="line">		<span class="keyword">else</span> p = tail++;</span><br><span class="line"></span><br><span class="line">		p-&gt;ch[<span class="number">0</span>] = p-&gt;ch[<span class="number">1</span>] = null;</span><br><span class="line"></span><br><span class="line">		p-&gt;size = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">		p-&gt;key = key;</span><br><span class="line"></span><br><span class="line">		p-&gt;nodeCount = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">		p-&gt;exist = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> p;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Travel</span><span class="params">(Node *p,<span class="built_in">vector</span>&lt;Node \*&gt;&amp;v)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(p == null)<span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">		Travel(p-&gt;ch[<span class="number">0</span>],v);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(p-&gt;exist)v.push_back(p);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">else</span> bc[bc_top++] = p;</span><br><span class="line"></span><br><span class="line">		Travel(p-&gt;ch[<span class="number">1</span>],v);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">inline</span> Node *<span class="title">divide</span><span class="params">(<span class="built_in">vector</span>&lt;Node \*&gt;&amp;v,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(l &gt;= r)<span class="keyword">return</span> null;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> mid = (l+r)/<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">		Node *p = v[mid];</span><br><span class="line"></span><br><span class="line">		p-&gt;ch[<span class="number">0</span>] = divide(v,l,mid);</span><br><span class="line"></span><br><span class="line">		p-&gt;ch[<span class="number">1</span>] = divide(v,mid+<span class="number">1</span>,r);</span><br><span class="line"></span><br><span class="line">		p-&gt;push_up();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> p;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">rebuild</span><span class="params">(Node *&amp;p)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">vector</span>&lt;Node *&gt;v;</span><br><span class="line"></span><br><span class="line">		Travel(p,v);</span><br><span class="line"></span><br><span class="line">		p = divide(v,<span class="number">0</span>,v.size());</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function">Node **<span class="title">insert</span><span class="params">(Node *&amp;p,<span class="keyword">int</span> val)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(p == null)&#123;</span><br><span class="line"></span><br><span class="line">			p = newNode(val);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">return</span> &amp;null;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">			p-&gt;size++;</span><br><span class="line"></span><br><span class="line">			p-&gt;nodeCount++;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">int</span> d = (val &gt;= p-&gt;key);</span><br><span class="line"></span><br><span class="line">			Node **res = insert(p-&gt;ch[d],val);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(p-&gt;isBad())res = &amp;p;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">return</span> res;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//插入一个值为val的点</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> val)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		Node **p = insert(root,val);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(*p != null)rebuild(*p);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//删除第id个点</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">erase</span><span class="params">(Node *p,<span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(p-&gt;exist &amp;&amp; id == p-&gt;ch[<span class="number">0</span>]-&gt;size+<span class="number">1</span>)&#123;</span><br><span class="line"></span><br><span class="line">			p-&gt;exist = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">			p-&gt;size--;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		p-&gt;size--;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(id &lt;= p-&gt;ch[<span class="number">0</span>]-&gt;size+p-&gt;exist)</span><br><span class="line"></span><br><span class="line">			erase(p-&gt;ch[<span class="number">0</span>],id);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">else</span> erase(p-&gt;ch[<span class="number">1</span>],id - p-&gt;ch[<span class="number">0</span>]-&gt;size - p-&gt;exist);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//查询小于val的数的个数+1</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">rank</span><span class="params">(<span class="keyword">int</span> val)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		Node *now = root;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> ans = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span>(now != null)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(now-&gt;key &gt;= val)now = now-&gt;ch[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">				ans += now-&gt;ch[<span class="number">0</span>]-&gt;size + now-&gt;exist;</span><br><span class="line"></span><br><span class="line">				now = now-&gt;ch[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> ans;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">get_kth</span><span class="params">(<span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		Node *now = root;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span>(now != null)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(now-&gt;exist &amp;&amp; k == now-&gt;ch[<span class="number">0</span>]-&gt;size+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">				<span class="keyword">return</span> now-&gt;key;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(now-&gt;ch[<span class="number">0</span>]-&gt;size &gt;= k)now = now-&gt;ch[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">				k -= now-&gt;ch[<span class="number">0</span>]-&gt;size + now-&gt;exist;</span><br><span class="line"></span><br><span class="line">				now = now-&gt;ch[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//删除一个值为val的点</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">erase</span><span class="params">(<span class="keyword">int</span> val)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		erase(root,rank(val));</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(root-&gt;size &lt; alpha*root-&gt;nodeCount)</span><br><span class="line"></span><br><span class="line">			rebuild(root);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;tree;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("in.txt","r",stdin);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("out.txt","w",stdout);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n) == <span class="number">1</span>)&#123;</span><br><span class="line"></span><br><span class="line">		tree.init();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> op,x;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span>(n--)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;op,&amp;x);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(op == <span class="number">1</span>)tree.insert(x);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">2</span>) tree.erase(x);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">3</span>)<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,tree.rank(x));</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">4</span>)<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,tree.get_kth(x));</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">5</span>)<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,tree.get_kth(tree.rank(x)<span class="number">-1</span>));</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,tree.get_kth(tree.rank(x+<span class="number">1</span>)));</span><br><span class="line"></span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/09/27/2014shanghaionline/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/09/27/2014shanghaionline/" itemprop="url">
                  2014 ACM/ICPC Asia Regional Shanghai Online 题解
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-09-27 17:36:49" itemprop="dateCreated datePublished" datetime="2014-09-27T17:36:49+08:00">2014-09-27</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 20:16:13" itemprop="dateModified" datetime="2018-07-29T20:16:13+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Contest/" itemprop="url" rel="index"><span itemprop="name">Contest</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/套题/" itemprop="url" rel="index"><span itemprop="name">套题</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/" itemprop="url" rel="index"><span itemprop="name">HDU</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="负责出了一场网络赛，勉勉强强算是顺利过去了，虽然产生了很多意外"><a href="#负责出了一场网络赛，勉勉强强算是顺利过去了，虽然产生了很多意外" class="headerlink" title="负责出了一场网络赛，勉勉强强算是顺利过去了，虽然产生了很多意外~~"></a>负责出了一场网络赛，勉勉强强算是顺利过去了，虽然产生了很多意外~~</h4><p>本场共有12道题，教练提供了3个题给我，学弟shumj出的1011的LCT。 然后本来这场是11个题的，开场前教练担心爆零的比较多，临时叫我加了一个水题，就是1012了。 搞完这场网络赛，估计被喷出翔了, 虽然有个别题我卡的比较紧，但是也算卡的合理的，其他题目的时限都是比较宽的了. 出题一般我都会弃掉恶心的模拟，代码量很大的题，这里的题目感觉代码量都比较小。。 但是我一般出题也出模板题, 就是来拼模板的，怕不怕！！   比较抱歉的就是1001和1008的Rejudge.  出题最不应该rejudge了,  但是因为没有好的tester. 大部分题是我自己出，自己当的tester. 1001数据是没有问题的，是OJ数据上传出现问题，然后及时加上数据。 主要是1008，因为这题我暴力对拍过的，感觉数据是正确的，也没有仔细检查。  然后比赛过程中发现我的暴力对拍写错，标程也犯了一样的错误，然后修正后两个吻合了！ 然后就出现了1008的Rejudge！ 为两次Rejudge以及各种卡常数，表示深深的歉意！   我就是这么弱！ 没办法。 这也算是退役前出的最后一场比赛吧！ 下面是简单题解。 </p>
<p>1001： <a href="http://acm.hdu.edu.cn/showproblem.php?pid=5042" target="_blank" rel="noopener">HDU5042</a> 这一题其实主要就是因为GCD是分段的，所以分成一段一段去搞就可以了。 就是说，可能 [l,r1] ….[l,r2] 的gcd都是一样的。 因为如果 是 [l,r]之间的gcd的话， 随着r的增大，这个值是不增的，所以最多分成了log(10^5)段. 然后就可以胡搞了，当然也可以使用ST去求gcd,然后也可以搞出来。   这一题前面出现一片RE， 然后检查数据发现OJ没传上数据，然后进行了修正。  </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ***************</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Author        :kuangbin</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Created Time  :2014/9/5 15:28:45</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">File Name     :A.cpp</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">************************************************ */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;assert.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">100010</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">gcd</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> a,<span class="keyword">long</span> <span class="keyword">long</span> b)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(b == <span class="number">0</span>)<span class="keyword">return</span> a;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> gcd(b,a%b);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> F[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(F[x] == <span class="number">-1</span>)<span class="keyword">return</span> x;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> F[x] = find(F[x]);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bing</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> t1 = find(x);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> t2 = find(y);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(t1 != t2)F[t2] = t1;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> a[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node1</span>&#123;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> r1,r2;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> val;</span><br><span class="line"></span><br><span class="line">	Node1(<span class="keyword">int</span> _r1 = <span class="number">0</span>,<span class="keyword">int</span> _r2 = <span class="number">0</span>,<span class="keyword">int</span> _val = <span class="number">0</span>)&#123;</span><br><span class="line"></span><br><span class="line">		r1 = _r1;</span><br><span class="line"></span><br><span class="line">		r2 = _r2;</span><br><span class="line"></span><br><span class="line">		val = _val;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> Node1 &amp;b)<span class="keyword">const</span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(r1 != b.r1)<span class="keyword">return</span> r1 &lt; b.r1;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">else</span> r2 &lt; b.r2;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;Node1&gt;vec1[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node2</span>&#123;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> l,r1,r2;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">long</span> <span class="keyword">long</span> sum;</span><br><span class="line"></span><br><span class="line">	Node2(<span class="keyword">int</span> _l = <span class="number">0</span>,<span class="keyword">int</span> _r1 = <span class="number">0</span>,<span class="keyword">int</span> _r2 = <span class="number">0</span>)&#123;</span><br><span class="line"></span><br><span class="line">		l = _l;</span><br><span class="line"></span><br><span class="line">		r1 = _r1;</span><br><span class="line"></span><br><span class="line">		r2 = _r2;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> Node2 &amp;b)<span class="keyword">const</span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(l != b.l)<span class="keyword">return</span> l &lt; b.l;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">return</span> r1 &lt; b.r1;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;Node2&gt;vec2[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> num1[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> b[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("A.in","r",stdin);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("A.out","w",stdout);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</span><br><span class="line"></span><br><span class="line">	assert(T &lt;= <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> n,Q;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> iCase = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(T--)&#123;</span><br><span class="line"></span><br><span class="line">		iCase++;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"Case #%d:\n"</span>,iCase);</span><br><span class="line"></span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;Q);</span><br><span class="line"></span><br><span class="line">		assert(n &gt;= <span class="number">1</span> &amp;&amp; n &lt;= <span class="number">100000</span> &amp;&amp; Q &gt;= <span class="number">1</span> &amp;&amp; Q &lt;= <span class="number">100000</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> Max = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a[i]);</span><br><span class="line"></span><br><span class="line">			assert(a[i] &gt;= <span class="number">1</span> &amp;&amp; a[i] &lt;= <span class="number">100000</span>);</span><br><span class="line"></span><br><span class="line">			vec1[i].clear();</span><br><span class="line"></span><br><span class="line">			Max = max(Max,a[i]);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= Max;i++)vec2[i].clear();</span><br><span class="line"></span><br><span class="line">		F[n+<span class="number">1</span>] = <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = n;i &gt;= <span class="number">1</span>;i--)&#123;</span><br><span class="line"></span><br><span class="line">			F[i] = <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">int</span> start = i;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">int</span> pre = i;</span><br><span class="line"></span><br><span class="line">			b[i] = a[i];</span><br><span class="line"></span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j = find(i+<span class="number">1</span>);j &lt;= n;j = find(j+<span class="number">1</span>))&#123;</span><br><span class="line"></span><br><span class="line">				b[j] = gcd(a[i],b[j]);</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span>(b[j] != b[pre])&#123;</span><br><span class="line"></span><br><span class="line">					vec1[i].push_back(Node1(start,pre,b[pre]));</span><br><span class="line"></span><br><span class="line">					vec2[b[pre]].push_back(Node2(i,start,pre));</span><br><span class="line"></span><br><span class="line">					start = pre+<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">else</span> bing(j,pre);</span><br><span class="line"></span><br><span class="line">				pre = j;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			vec1[i].push_back(Node1(start,n,b[n]));</span><br><span class="line"></span><br><span class="line">			vec2[b[n]].push_back(Node2(i,start,n));</span><br><span class="line"></span><br><span class="line">			sort(vec1[i].begin(),vec1[i].end());</span><br><span class="line"></span><br><span class="line">			<span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">			printf("i  %d\n",i);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">			int sz = vec1[i].size();</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">			for(int j = 0;j &lt; sz;j++)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">				printf("%d %d %d\n",vec1[i][j].r1,vec1[i][j].r2,vec1[i][j].val);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">				*/</span></span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		num1[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= Max;i++)&#123;</span><br><span class="line"></span><br><span class="line">			sort(vec2[i].begin(),vec2[i].end());</span><br><span class="line"></span><br><span class="line">			<span class="keyword">int</span> sz = vec2[i].size();</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(sz)num1[i] = num1[i<span class="number">-1</span>]+<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> num1[i] = num1[i<span class="number">-1</span>];</span><br><span class="line"></span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; sz;j++)&#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span>(j == <span class="number">0</span>)vec2[i][j].sum = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">else</span> vec2[i][j].sum = vec2[i][j<span class="number">-1</span>].sum;</span><br><span class="line"></span><br><span class="line">				vec2[i][j].sum += vec2[i][j].r2-vec2[i][j].r1+<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">			printf("i: %d\n",i);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">			printf("num1:%d\n",num1[i]);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">			for(int j = 0;j &lt; sz;j++)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">				printf("%d %d %d %I64d\n",vec2[i][j].l,vec2[i][j].r1,vec2[i][j].r2,vec2[i][j].sum);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">				*/</span></span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">char</span> op[<span class="number">20</span>];</span><br><span class="line"></span><br><span class="line">		<span class="keyword">long</span> <span class="keyword">long</span> k1,k2;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span>(Q--)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%s%I64d%I64d"</span>,op,&amp;k1,&amp;k2);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(op[<span class="number">0</span>] == <span class="string">'R'</span>)&#123;</span><br><span class="line"></span><br><span class="line">				assert(k1 &gt;= <span class="number">1</span> &amp;&amp; k1 &lt;= k2 &amp;&amp; k2 &lt;= n);</span><br><span class="line"></span><br><span class="line">				<span class="keyword">int</span> id ;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">int</span> sz = vec1[k1].size();</span><br><span class="line"></span><br><span class="line">				<span class="keyword">int</span> l = <span class="number">0</span>, r = sz<span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line"></span><br><span class="line">					<span class="keyword">int</span> mid = (l+r)/<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">					<span class="keyword">if</span>(vec1[k1][mid].r1 &lt;= k2 &amp;&amp; k2 &lt;= vec1[k1][mid].r2)&#123;</span><br><span class="line"></span><br><span class="line">						id = mid;</span><br><span class="line"></span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">					&#125;</span><br><span class="line"></span><br><span class="line">					<span class="keyword">else</span> <span class="keyword">if</span>(vec1[k1][mid].r2 &lt; k2)l = mid+<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">					<span class="keyword">else</span> r = mid<span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">int</span> val = vec1[k1][id].val;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">int</span> ans1 = num1[val];</span><br><span class="line"></span><br><span class="line">				id = lower_bound(vec2[val].begin(),vec2[val].end(),Node2(k1,<span class="number">0</span>,<span class="number">0</span>)) - vec2[val].begin();</span><br><span class="line"></span><br><span class="line">				<span class="keyword">long</span> <span class="keyword">long</span> ans2;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span>(id == <span class="number">0</span>)ans2 = k2 - vec2[val][id].r1 + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">else</span> ans2 = vec2[val][id<span class="number">-1</span>].sum + k2 - vec2[val][id].r1 + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">"%d %I64d\n"</span>,ans1,ans2);</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">				assert(k1 &gt;= <span class="number">1</span> &amp;&amp; k1 &lt;= (<span class="keyword">long</span> <span class="keyword">long</span>)n(n+<span class="number">1</span>)/<span class="number">2</span> &amp;&amp; k2 &gt;= <span class="number">1</span> &amp;&amp; k2 &lt;= (<span class="keyword">long</span> <span class="keyword">long</span>)n(n+<span class="number">1</span>)/<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">				<span class="keyword">int</span> id1 = lower_bound(num1+<span class="number">1</span>,num1+Max+<span class="number">1</span>,k1) - num1;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span>(id1 &gt; Max || num1[id1] != k1)&#123;</span><br><span class="line"></span><br><span class="line">					<span class="built_in">printf</span>(<span class="string">"-1\n"</span>);</span><br><span class="line"></span><br><span class="line">					<span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">int</span> sz = vec2[id1].size();</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span>(k2 &gt; vec2[id1][sz<span class="number">-1</span>].sum)&#123;</span><br><span class="line"></span><br><span class="line">					<span class="built_in">printf</span>(<span class="string">"-1\n"</span>);</span><br><span class="line"></span><br><span class="line">					<span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">int</span> l = <span class="number">0</span>, r = sz<span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">int</span> id2 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line"></span><br><span class="line">					<span class="keyword">int</span> mid = (l+r)/<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">					<span class="keyword">long</span> <span class="keyword">long</span> ss = vec2[id1][mid].sum - (vec2[id1][mid].r2 - vec2[id1][mid].r1 + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">					<span class="keyword">if</span>(k2 &gt; ss)&#123;</span><br><span class="line"></span><br><span class="line">						id2 = mid;</span><br><span class="line"></span><br><span class="line">						l = mid+<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">					&#125;</span><br><span class="line"></span><br><span class="line">					<span class="keyword">else</span> r = mid<span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				k2 -= vec2[id1][id2].sum - (vec2[id1][id2].r2 - vec2[id1][id2].r1 + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>,vec2[id1][id2].l,(<span class="keyword">int</span>)(vec2[id1][id2].r1 + k2 - <span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<pre><code>1002题： [HDU5043](http://acm.hdu.edu.cn/showproblem.php?pid=5043) 这个题就是Lucas定理的简单应用啊~~ 数位DP可搞。 这题是5倍以后标程啊，我没卡常数~ 小问题答案其实是 C(M,k1) * C(M-k1,k2) * C(M-k1-k2,k3)*********** M = k1+k2+k3+.. 如果要模P不等于0，就是k1,k2,...kn的P进制的和不能有进位。 然后就是数位DP可搞。
</code></pre><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ***************</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Author        :kuangbin</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Created Time  :2014/9/25 0:07:36</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">File Name     :1002.cpp</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">************************************************ */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;assert.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MOD = <span class="number">1e8</span>+<span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> &amp;a,<span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	a += b;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(a &gt;= MOD)a -= MOD;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> vis[<span class="number">10</span>][<span class="number">33</span>][<span class="number">22</span>][<span class="number">1</span>&lt;&lt;<span class="number">10</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> dp[<span class="number">10</span>][<span class="number">33</span>][<span class="number">22</span>][<span class="number">1</span>&lt;&lt;<span class="number">10</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> TT;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> prime;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> bit[<span class="number">10</span>][<span class="number">33</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> id,<span class="keyword">int</span> pos,<span class="keyword">int</span> sum,<span class="keyword">int</span> s)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(id == n)&#123;</span><br><span class="line"></span><br><span class="line">		id = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		pos--;</span><br><span class="line"></span><br><span class="line">		sum = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(pos == <span class="number">-1</span>)<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(vis[id][pos][sum][s] == TT)<span class="keyword">return</span> dp[id][pos][sum][s];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> end = (s&amp;(<span class="number">1</span>&lt;&lt;id))?bit[id][pos]:prime<span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= end;i++)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(sum + i &gt;= prime)<span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">		Add(ans,dfs(id+<span class="number">1</span>,pos,sum+i,i == end? s : (s &amp; (~(<span class="number">1</span>&lt;&lt;id)))));</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	vis[id][pos][sum][s] = TT;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> dp[id][pos][sum][s] = ans;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> x[<span class="number">10</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">memset</span>(bit,<span class="number">0</span>,<span class="keyword">sizeof</span>(bit));</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> Max = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">do</span>&#123;</span><br><span class="line"></span><br><span class="line">			bit[i][cnt++] = x[i]%prime;</span><br><span class="line"></span><br><span class="line">			x[i] /= prime;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span>(x[i]);</span><br><span class="line"></span><br><span class="line">		Max = max(Max,cnt);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> dfs(<span class="number">0</span>,Max<span class="number">-1</span>,<span class="number">0</span>,(<span class="number">1</span>&lt;&lt;n)<span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("in.txt","r",stdin);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("out.txt","w",stdout);</span></span><br><span class="line"></span><br><span class="line">	TT = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span>(vis));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</span><br><span class="line"></span><br><span class="line">	assert(T &lt;= <span class="number">50</span> &amp;&amp; T &gt;= <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> iCase = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(T--)&#123;</span><br><span class="line"></span><br><span class="line">		iCase++;</span><br><span class="line"></span><br><span class="line">		TT++;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;prime);</span><br><span class="line"></span><br><span class="line">		assert(n &gt;= <span class="number">1</span> &amp;&amp; n &lt;= <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">		assert(prime == <span class="number">2</span></span><br><span class="line"></span><br><span class="line">				|| prime == <span class="number">3</span></span><br><span class="line"></span><br><span class="line">				|| prime == <span class="number">5</span></span><br><span class="line"></span><br><span class="line">				|| prime == <span class="number">7</span></span><br><span class="line"></span><br><span class="line">				|| prime == <span class="number">11</span></span><br><span class="line"></span><br><span class="line">				|| prime == <span class="number">13</span></span><br><span class="line"></span><br><span class="line">				|| prime == <span class="number">17</span></span><br><span class="line"></span><br><span class="line">				|| prime == <span class="number">19</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">long</span> <span class="keyword">long</span> tot = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x[i]);</span><br><span class="line"></span><br><span class="line">			assert(x[i] &gt;= <span class="number">1</span> &amp;&amp; x[i] &lt;= <span class="number">1000000000</span>);</span><br><span class="line"></span><br><span class="line">			tot = tot*(<span class="number">1</span>+x[i])%MOD;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		tot -= solve();</span><br><span class="line"></span><br><span class="line">		tot = (tot%MOD+MOD)%MOD;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"Case #%d: %d\n"</span>,iCase,(<span class="keyword">int</span>)tot);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<pre><code>1003： 很简单的题目, 因为我卡常数了，让大家的罚时大增~~ 原意是想卡掉LCT或者其他的什么nlogn, n longnlogn算法的，后来发现O(n+m)的比不上nlogn的算法。因为常数好大。 然后就变成了谁的姿势好，谁就可过。 至于出现有很多的PE，是我故意安排的。 我要求输出3行的，你们的程序n=1的时候输出2行，能不PE吗？   一种做法是Tarjan进行LCA,然后进行加减啊，然后扫一遍。 或者进行树链剖分转为线性，然后搞。 其余算法也可能可以卡过~ 但是本题要输入输出挂，标程也无耻地用了~~尽力吐槽吧
</code></pre><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ***************</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Author        :kuangbin</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Created Time  :2014/9/9 15:33:50</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">File Name     :C.cpp</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> ************************************************ */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;assert.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">100010</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> to,next;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> index;</span><br><span class="line"></span><br><span class="line">&#125;edge[MAXN*<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> head[MAXN],tot;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	tot = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="keyword">sizeof</span>(head));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> index)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	edge[tot].to = v;</span><br><span class="line"></span><br><span class="line">	edge[tot].next = head[u];</span><br><span class="line"></span><br><span class="line">	edge[tot].index = index;</span><br><span class="line"></span><br><span class="line">	head[u] = tot++;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> F[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(F[x] == <span class="number">-1</span>)<span class="keyword">return</span> x;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> F[x] = find(F[x]);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">bing</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> t1 = find(x);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> t2 = find(y);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(t1 != t2)F[t1] = t2;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> PF[MAXN],EF[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> id;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> v,val;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> next;</span><br><span class="line"></span><br><span class="line">	Node(<span class="keyword">int</span> _id = <span class="number">0</span>,<span class="keyword">int</span> _v = <span class="number">0</span>,<span class="keyword">int</span> _val = <span class="number">0</span>)&#123;</span><br><span class="line"></span><br><span class="line">		id = _id;</span><br><span class="line"></span><br><span class="line">		v = _v;</span><br><span class="line"></span><br><span class="line">		val = _val;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;query[MAXN*<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> h[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> tt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init2</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	tt = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">memset</span>(h,<span class="number">-1</span>,<span class="keyword">sizeof</span>(h));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add_query</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> id,<span class="keyword">int</span> val)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	query[tt].id = id;</span><br><span class="line"></span><br><span class="line">	query[tt].next = h[u];</span><br><span class="line"></span><br><span class="line">	query[tt].v = v;</span><br><span class="line"></span><br><span class="line">	query[tt].val = val;</span><br><span class="line"></span><br><span class="line">	h[u] = tt++;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> vis[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> fa[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> ff[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> sta[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> cur[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> pre)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">memcpy</span>(cur,head,<span class="keyword">sizeof</span>(head));</span><br><span class="line"></span><br><span class="line">	<span class="built_in">memset</span>(ff,<span class="literal">false</span>,<span class="keyword">sizeof</span>(ff));</span><br><span class="line"></span><br><span class="line">	fa[<span class="number">1</span>] = <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> top = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	sta[top++] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(top != <span class="number">0</span>)&#123;</span><br><span class="line"></span><br><span class="line">		u = sta[top<span class="number">-1</span>];</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(!ff[u])ff[u] = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">bool</span> flag = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = cur[u];i != <span class="number">-1</span>;i = edge[i].next)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">int</span> v = edge[i].to;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(ff[v])<span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">			fa[v] = u;</span><br><span class="line"></span><br><span class="line">			sta[top++] = v;</span><br><span class="line"></span><br><span class="line">			flag = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">			cur[u] = edge[i].next;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(!flag)&#123;</span><br><span class="line"></span><br><span class="line">			top--;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i = h[u];i != <span class="number">-1</span>;i = query[i].next)&#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">int</span> v = query[i].v;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">int</span> type = query[i].id;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">int</span> w = query[i].val;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span>(vis[v])&#123;</span><br><span class="line"></span><br><span class="line">					<span class="keyword">if</span>(type == <span class="number">1</span>)&#123;</span><br><span class="line"></span><br><span class="line">						PF[find(v)] -= w;</span><br><span class="line"></span><br><span class="line">						<span class="keyword">if</span>(fa[find(v)] != <span class="number">-1</span>)PF[fa[find(v)]] -= w;</span><br><span class="line"></span><br><span class="line">						PF[v] += w;</span><br><span class="line"></span><br><span class="line">					&#125;</span><br><span class="line"></span><br><span class="line">					<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">						EF[find(v)] -= <span class="number">2</span>*w;</span><br><span class="line"></span><br><span class="line">						EF[v] += w;</span><br><span class="line"></span><br><span class="line">					&#125;</span><br><span class="line"></span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">					<span class="keyword">if</span>(type == <span class="number">1</span>)PF[v] += w;</span><br><span class="line"></span><br><span class="line">					<span class="keyword">else</span> EF[v] += w;</span><br><span class="line"></span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(fa[u] != <span class="number">-1</span>)bing(u,fa[u]);</span><br><span class="line"></span><br><span class="line">			vis[u] = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> a[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> ans1[MAXN],ans2[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> gg[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> pre)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> l,r;</span><br><span class="line"></span><br><span class="line">	gg[l = r = <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(;l &lt;= r;l++)</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = head[gg[l]];i != <span class="number">-1</span>;i = edge[i].next)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">int</span> v = edge[i].to;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(v == fa[gg[l]])<span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">			gg[++r] = v;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(l--;l;l--)&#123;</span><br><span class="line"></span><br><span class="line">		u = gg[l];</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = head[u];i != <span class="number">-1</span>;i = edge[i].next)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">int</span> v = edge[i].to;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(v == fa[u])<span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">			EF[u] += EF[v];</span><br><span class="line"></span><br><span class="line">			PF[u] += PF[v];</span><br><span class="line"></span><br><span class="line">			ans2[edge[i].index] = EF[v];</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		ans1[u] = PF[u] + a[u];</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//适用于正负整数</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">inline</span> <span class="title">bool</span> <span class="title">scan_d</span>(<span class="title">T</span> &amp;<span class="title">ret</span>) &#123;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">char</span> c; <span class="keyword">int</span> sgn;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(c=getchar(),c==EOF) <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">//EOF</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(c!=<span class="string">'-'</span>&amp;&amp;(c&lt;<span class="string">'0'</span>||c&gt;<span class="string">'9'</span>)) c=getchar();</span><br><span class="line"></span><br><span class="line">	sgn=(c==<span class="string">'-'</span>)?<span class="number">-1</span>:<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">	ret=(c==<span class="string">'-'</span>)?<span class="number">0</span>:(c-<span class="string">'0'</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(c=getchar(),c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>) ret=ret*<span class="number">10</span>+(c-<span class="string">'0'</span>);</span><br><span class="line"></span><br><span class="line">	ret*=sgn;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">out</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> x)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(x&gt;<span class="number">9</span>) out(x/<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">putchar</span>(x%<span class="number">10</span>+<span class="string">'0'</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//freopen("C.in","r",stdin);</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//freopen("C.out","w",stdout);</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//freopen("in.txt","r",stdin);</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//freopen("out1.txt","w",stdout);</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> n,m;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> T;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> iCase = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(T--)&#123;</span><br><span class="line"></span><br><span class="line">		iCase++;</span><br><span class="line"></span><br><span class="line">		init();</span><br><span class="line"></span><br><span class="line">		<span class="comment">//scanf("%d%d",&amp;n,&amp;m);</span></span><br><span class="line"></span><br><span class="line">		scan_d(n);</span><br><span class="line"></span><br><span class="line">		scan_d(m);</span><br><span class="line"></span><br><span class="line">		assert(n &gt;= <span class="number">1</span> &amp;&amp; n &lt;= <span class="number">100000</span> &amp;&amp; m &gt;= <span class="number">1</span> &amp;&amp; m &lt;= <span class="number">100000</span>);</span><br><span class="line"></span><br><span class="line">		<span class="built_in">memset</span>(a,<span class="number">0</span>,<span class="keyword">sizeof</span>(a));</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> u,v,w;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; n;i++)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="comment">//scanf("%d%d",&amp;u,&amp;v);</span></span><br><span class="line"></span><br><span class="line">			scan_d(u);</span><br><span class="line"></span><br><span class="line">			scan_d(v);</span><br><span class="line"></span><br><span class="line">			addedge(u,v,i);</span><br><span class="line"></span><br><span class="line">			addedge(v,u,i);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">char</span> op[<span class="number">20</span>];</span><br><span class="line"></span><br><span class="line">		init2();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span>(m--)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="comment">//scanf("%s%d%d%d",op,&amp;u,&amp;v,&amp;w);</span></span><br><span class="line"></span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%s"</span>,op);</span><br><span class="line"></span><br><span class="line">			scan_d(u);</span><br><span class="line"></span><br><span class="line">			scan_d(v);</span><br><span class="line"></span><br><span class="line">			scan_d(w);</span><br><span class="line"></span><br><span class="line">			assert(u &gt;= <span class="number">1</span> &amp;&amp; u &lt;= n);</span><br><span class="line"></span><br><span class="line">			assert(v &gt;= <span class="number">1</span> &amp;&amp; v &lt;= n);</span><br><span class="line"></span><br><span class="line">			assert(<span class="built_in">abs</span>(w) &lt;= <span class="number">100000</span>);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(op[<span class="number">3</span>] == <span class="string">'1'</span>)&#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span>(u == v)a[u] += w;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">					<span class="comment">//	vec[u].push_back(Node(1,v,w));</span></span><br><span class="line"></span><br><span class="line">					<span class="comment">//vec[v].push_back(Node(1,u,w));</span></span><br><span class="line"></span><br><span class="line">					add_query(u,v,<span class="number">1</span>,w);</span><br><span class="line"></span><br><span class="line">					add_query(v,u,<span class="number">1</span>,w);</span><br><span class="line"></span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span>(u == v)<span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">					<span class="comment">//vec[u].push_back(Node(2,v,w));</span></span><br><span class="line"></span><br><span class="line">					<span class="comment">//vec[v].push_back(Node(2,u,w));</span></span><br><span class="line"></span><br><span class="line">					add_query(u,v,<span class="number">2</span>,w);</span><br><span class="line"></span><br><span class="line">					add_query(v,u,<span class="number">2</span>,w);</span><br><span class="line"></span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">memset</span>(PF,<span class="number">0</span>,<span class="keyword">sizeof</span>(PF));</span><br><span class="line"></span><br><span class="line">		<span class="built_in">memset</span>(EF,<span class="number">0</span>,<span class="keyword">sizeof</span>(EF));</span><br><span class="line"></span><br><span class="line">		<span class="built_in">memset</span>(F,<span class="number">-1</span>,<span class="keyword">sizeof</span>(F));</span><br><span class="line"></span><br><span class="line">		<span class="built_in">memset</span>(vis,<span class="literal">false</span>,<span class="keyword">sizeof</span>(vis));</span><br><span class="line"></span><br><span class="line">		dfs1(<span class="number">1</span>,<span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">		<span class="comment">//for(int i = 1;i &lt;= n;i++)</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">//printf("%I64d  %I64d\n",PF[i],EF[i]);</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">//memset(ans1,0,sizeof(ans1));</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">//memset(ans2,0,sizeof(ans2));</span></span><br><span class="line"></span><br><span class="line">		dfs2(<span class="number">1</span>,<span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"Case #%d:\n"</span>,iCase);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="comment">//printf("%I64d",ans1[i]);</span></span><br><span class="line"></span><br><span class="line">			out(ans1[i]);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(i &lt; n)<span class="built_in">printf</span>(<span class="string">" "</span>);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; n;i++)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="comment">//printf("%I64d",ans2[i]);</span></span><br><span class="line"></span><br><span class="line">			out(ans2[i]);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(i &lt; n<span class="number">-1</span>)<span class="built_in">printf</span>(<span class="string">" "</span>);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>  树链剖分：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ***************</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Author        :kuangbin</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Created Time  :2014/9/24 14:12:20</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">File Name     :F:\题目_上海网络赛\2014上海网络赛题目\C\标程\C3.cpp</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">************************************************ */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">100010</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> to,next;</span><br><span class="line"></span><br><span class="line">&#125;edge[MAXN*<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> head[MAXN],tot;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> top[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> fa[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> deep[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> num[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> p[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> fp[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> son[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> pos;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	tot = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="keyword">sizeof</span>(head));</span><br><span class="line"></span><br><span class="line">	pos = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">memset</span>(son,<span class="number">-1</span>,<span class="keyword">sizeof</span>(son));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	edge[tot].to = v;</span><br><span class="line"></span><br><span class="line">	edge[tot].next = head[u];</span><br><span class="line"></span><br><span class="line">	head[u] = tot++;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> pre,<span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	deep[u] = d;</span><br><span class="line"></span><br><span class="line">	fa[u] = pre;</span><br><span class="line"></span><br><span class="line">	num[u] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = head[u];i != <span class="number">-1</span>;i = edge[i].next)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> v = edge[i].to;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(v != pre)&#123;</span><br><span class="line"></span><br><span class="line">			dfs1(v,u,d+<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">			num[u] += num[v];</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(son[u] == <span class="number">-1</span> || num[v] &gt; num[son[u]])</span><br><span class="line"></span><br><span class="line">				son[u] = v;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">getpos</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> sp)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	top[u] = sp;</span><br><span class="line"></span><br><span class="line">	p[u] = pos++;</span><br><span class="line"></span><br><span class="line">	fp[p[u]] = u;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(son[u] == <span class="number">-1</span>)<span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">	getpos(son[u],sp);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = head[u];i != <span class="number">-1</span>;i = edge[i].next)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> v = edge[i].to;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(v != son[u] &amp;&amp; v != fa[u])</span><br><span class="line"></span><br><span class="line">			getpos(v,v);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> w1[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add1</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> f1 = top[u],f2 = top[v];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(f1 != f2)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(deep[f1] &lt; deep[f2])&#123;</span><br><span class="line"></span><br><span class="line">			swap(f1,f2);</span><br><span class="line"></span><br><span class="line">			swap(u,v);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		w1[p[f1]] += w;</span><br><span class="line"></span><br><span class="line">		w1[p[u]+<span class="number">1</span>] -= w;</span><br><span class="line"></span><br><span class="line">		u = fa[f1];</span><br><span class="line"></span><br><span class="line">		f1 = top[u];</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(deep[u] &gt; deep[v])swap(u,v);</span><br><span class="line"></span><br><span class="line">	w1[p[u]] += w;</span><br><span class="line"></span><br><span class="line">	w1[p[v]+<span class="number">1</span>] -= w;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> w2[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add2</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> f1 = top[u], f2 = top[v];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(f1 != f2)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(deep[f1] &lt; deep[f2])&#123;</span><br><span class="line"></span><br><span class="line">			swap(f1,f2);</span><br><span class="line"></span><br><span class="line">			swap(u,v);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		w2[p[f1]] += w;</span><br><span class="line"></span><br><span class="line">		w2[p[u]+<span class="number">1</span>] -= w;</span><br><span class="line"></span><br><span class="line">		u = fa[f1];</span><br><span class="line"></span><br><span class="line">		f1 = top[u];</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(u == v)<span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(deep[u] &gt; deep[v])swap(u,v);</span><br><span class="line"></span><br><span class="line">	w2[p[son[u]]] += w;</span><br><span class="line"></span><br><span class="line">	w2[p[v]+<span class="number">1</span>] -= w;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//适用于正负整数</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">inline</span> <span class="title">bool</span> <span class="title">scan_d</span>(<span class="title">T</span> &amp;<span class="title">ret</span>) &#123;</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">char</span> c; <span class="keyword">int</span> sgn;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span>(c=getchar(),c==EOF) <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">//EOF</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">while</span>(c!=<span class="string">'-'</span>&amp;&amp;(c&lt;<span class="string">'0'</span>||c&gt;<span class="string">'9'</span>)) c=getchar();</span><br><span class="line"></span><br><span class="line">   sgn=(c==<span class="string">'-'</span>)?<span class="number">-1</span>:<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">   ret=(c==<span class="string">'-'</span>)?<span class="number">0</span>:(c-<span class="string">'0'</span>);</span><br><span class="line"></span><br><span class="line">   <span class="keyword">while</span>(c=getchar(),c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>) ret=ret*<span class="number">10</span>+(c-<span class="string">'0'</span>);</span><br><span class="line"></span><br><span class="line">   ret*=sgn;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">out</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> x)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span>(x&gt;<span class="number">9</span>) out(x/<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">   <span class="built_in">putchar</span>(x%<span class="number">10</span>+<span class="string">'0'</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;pp[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> link[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> ans1[MAXN],ans2[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> __size__ = <span class="number">256</span> &lt;&lt; <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> * __p__ = (<span class="keyword">char</span> *) <span class="built_in">malloc</span>(__size__) + __size__;</span><br><span class="line"></span><br><span class="line">__asm__(<span class="string">"movl %0,%%esp\n"</span>::<span class="string">"r"</span>(__p__));</span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("in.txt","r",stdin);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("out2.txt","w",stdout);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> n,m;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> T;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> iCase = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(T--)&#123;</span><br><span class="line"></span><br><span class="line">		iCase++;</span><br><span class="line"></span><br><span class="line">		init();</span><br><span class="line"></span><br><span class="line">		scan_d(n);</span><br><span class="line"></span><br><span class="line">		scan_d(m);</span><br><span class="line"></span><br><span class="line">		<span class="built_in">memset</span>(w1,<span class="number">0</span>,<span class="keyword">sizeof</span>(w1));</span><br><span class="line"></span><br><span class="line">		<span class="built_in">memset</span>(w2,<span class="number">0</span>,<span class="keyword">sizeof</span>(w2));</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> u,v,w;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; n;i++)&#123;</span><br><span class="line"></span><br><span class="line">			scan_d(u);</span><br><span class="line"></span><br><span class="line">			scan_d(v);</span><br><span class="line"></span><br><span class="line">			addedge(u,v);</span><br><span class="line"></span><br><span class="line">			addedge(v,u);</span><br><span class="line"></span><br><span class="line">			pp[i] = make_pair(u,v);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		dfs1(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">		getpos(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; n;i++)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(deep[pp[i].first] &gt; deep[pp[i].second])</span><br><span class="line"></span><br><span class="line">				swap(pp[i].first,pp[i].second);</span><br><span class="line"></span><br><span class="line">			link[pp[i].second] = i;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">char</span> op[<span class="number">10</span>];</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span>(m--)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%s"</span>,op);</span><br><span class="line"></span><br><span class="line">			scan_d(u);</span><br><span class="line"></span><br><span class="line">			scan_d(v);</span><br><span class="line"></span><br><span class="line">			scan_d(w);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(op[<span class="number">3</span>] == <span class="string">'1'</span>)&#123;</span><br><span class="line"></span><br><span class="line">				add1(u,v,w);</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> add2(u,v,w);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line"></span><br><span class="line">			w1[i] += w1[i<span class="number">-1</span>];</span><br><span class="line"></span><br><span class="line">			w2[i] += w2[i<span class="number">-1</span>];</span><br><span class="line"></span><br><span class="line">			ans1[fp[i]] = w1[i];</span><br><span class="line"></span><br><span class="line">			ans2[link[fp[i]]] = w2[i];</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"Case #%d:\n"</span>,iCase);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="comment">//printf("%I64d",ans1[i]);</span></span><br><span class="line"></span><br><span class="line">			out(ans1[i]);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(i &lt; n)<span class="built_in">printf</span>(<span class="string">" "</span>);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; n;i++)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="comment">//printf("%I64d",ans2[i]);</span></span><br><span class="line"></span><br><span class="line">			out(ans2[i]);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(i &lt; n<span class="number">-1</span>)<span class="built_in">printf</span>(<span class="string">" "</span>);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>  1004 <a href="http://acm.hdu.edu.cn/showproblem.php?pid=5045" target="_blank" rel="noopener">HDU5045</a> 直接状压DP。 可能题意好多人没理解，但是该表述的都表述清楚了，英语太渣了。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ***************</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Author        :kuangbin</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Created Time  :2014/9/10 20:04:53</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">File Name     :D.cpp</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">************************************************ */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> dp[<span class="number">1010</span>][<span class="number">1</span>&lt;&lt;<span class="number">10</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> vis[<span class="number">1010</span>][<span class="number">1</span>&lt;&lt;<span class="number">10</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> p[<span class="number">10</span>][<span class="number">1010</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> id,<span class="keyword">int</span> s)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(s == (<span class="number">1</span>&lt;&lt;n)<span class="number">-1</span>)s = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(vis[id][s])<span class="keyword">return</span> dp[id][s];</span><br><span class="line"></span><br><span class="line">	vis[id][s] = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">	dp[id][s] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(id == m)<span class="keyword">return</span> dp[id][s];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(s&amp;(<span class="number">1</span>&lt;&lt;i))<span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">		dp[id][s] = max(dp[id][s],(<span class="number">1</span>-p[i][id])*solve(id+<span class="number">1</span>,s|(<span class="number">1</span>&lt;&lt;i))+p[i][id]*(solve(id+<span class="number">1</span>,s|(<span class="number">1</span>&lt;&lt;i))+<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> dp[id][s];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("D.in","r",stdin);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("D.out","w",stdout);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> iCase = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(T--)&#123;</span><br><span class="line"></span><br><span class="line">		iCase++;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)</span><br><span class="line"></span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; m;j++)</span><br><span class="line"></span><br><span class="line">				<span class="built_in">scanf</span>(<span class="string">"%lf"</span>,&amp;p[i][j]);</span><br><span class="line"></span><br><span class="line">		<span class="built_in">memset</span>(vis,<span class="literal">false</span>,<span class="keyword">sizeof</span>(vis));</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"Case #%d: %.5lf\n"</span>,iCase,solve(<span class="number">0</span>,<span class="number">0</span>));</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>  1005： <a href="http://acm.hdu.edu.cn/showproblem.php?pid=5046" target="_blank" rel="noopener">HDU5046</a> 直接DLX模板题！！！ 有点裸！ 而且貌似好多人被卡了！！！模板不够优啊！ 这题3倍标程了，感觉也够了。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;assert.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxnode = <span class="number">4000</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MaxM = <span class="number">70</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MaxN = <span class="number">70</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> K;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">DLX</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> n,m,size;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> U[maxnode],D[maxnode],R[maxnode],L[maxnode],Row[maxnode],Col[maxnode];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> H[MaxN],S[MaxM];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> ands,ans[MaxN];</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> _n,<span class="keyword">int</span> _m)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line"></span><br><span class="line">		n = _n;</span><br><span class="line"></span><br><span class="line">		m = _m;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= m;i++)</span><br><span class="line"></span><br><span class="line">		&#123;</span><br><span class="line"></span><br><span class="line">			S[i] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">			U[i] = D[i] = i;</span><br><span class="line"></span><br><span class="line">			L[i] = i<span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">			R[i] = i+<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		R[m] = <span class="number">0</span>; L[<span class="number">0</span>] = m;</span><br><span class="line"></span><br><span class="line">		size = m;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)</span><br><span class="line"></span><br><span class="line">			H[i] = <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Link</span><span class="params">(<span class="keyword">int</span> r,<span class="keyword">int</span> c)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line"></span><br><span class="line">		++S[Col[++size]=c];</span><br><span class="line"></span><br><span class="line">		Row[size] = r;</span><br><span class="line"></span><br><span class="line">		D[size] = D[c];</span><br><span class="line"></span><br><span class="line">		U[D[c]] = size;</span><br><span class="line"></span><br><span class="line">		U[size] = c;</span><br><span class="line"></span><br><span class="line">		D[c] = size;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(H[r] &lt; <span class="number">0</span>)H[r] = L[size] = R[size] = size;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line"></span><br><span class="line">		&#123;</span><br><span class="line"></span><br><span class="line">			R[size] = R[H[r]];</span><br><span class="line"></span><br><span class="line">			L[R[H[r]]] = size;</span><br><span class="line"></span><br><span class="line">			L[size] = H[r];</span><br><span class="line"></span><br><span class="line">			R[H[r]] = size;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">remove</span><span class="params">(<span class="keyword">int</span> c)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = D[c];i != c;i = D[i])</span><br><span class="line"></span><br><span class="line">			L[R[i]] = L[i], R[L[i]] = R[i];</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">resume</span><span class="params">(<span class="keyword">int</span> c)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = U[c];i != c;i = U[i])</span><br><span class="line"></span><br><span class="line">			L[R[i]]=R[L[i]]=i;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">bool</span> v[maxnode];</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">f</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> ret = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> c = R[<span class="number">0</span>];c != <span class="number">0</span>;c = R[c])v[c] = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> c = R[<span class="number">0</span>];c != <span class="number">0</span>;c = R[c])</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(v[c])</span><br><span class="line"></span><br><span class="line">			&#123;</span><br><span class="line"></span><br><span class="line">				ret++;</span><br><span class="line"></span><br><span class="line">				v[c] = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> i = D[c];i != c;i = D[i])</span><br><span class="line"></span><br><span class="line">					<span class="keyword">for</span>(<span class="keyword">int</span> j = R[i];j != i;j = R[j])</span><br><span class="line"></span><br><span class="line">						v[Col[j]] = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> ret;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">Dance</span><span class="params">(<span class="keyword">int</span> d)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">    	<span class="keyword">if</span>(d + f() &gt; K)<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    	<span class="keyword">if</span>(R\[<span class="number">0</span>\] == <span class="number">0</span>)<span class="keyword">return</span> d &lt;= K;</span><br><span class="line">    	<span class="keyword">int</span> c = R\[<span class="number">0</span>\];</span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> i = R\[<span class="number">0</span>\];i != <span class="number">0</span>;i = R\[i\])</span><br><span class="line">    		<span class="keyword">if</span>(S\[i\] &lt; S\[c\])</span><br><span class="line">    			c = i;</span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> i = D\[c\];i != c;i = D\[i\])</span><br><span class="line">    	&#123;</span><br><span class="line">    		remove(i);</span><br><span class="line">    		<span class="keyword">for</span>(<span class="keyword">int</span> j = R\[i\];j != i;j = R\[j\])remove(j);</span><br><span class="line">    		<span class="keyword">if</span>(Dance(d+<span class="number">1</span>))<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    		<span class="keyword">for</span>(<span class="keyword">int</span> j = L\[i\];j != i;j = L\[j\])resume(j);</span><br><span class="line">    		resume(i);</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">DLX g;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> x,y;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">input</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;city[MaxM];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">dis</span><span class="params">(Point a,Point b)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> (<span class="keyword">long</span> <span class="keyword">long</span>)<span class="built_in">abs</span>(a.x-b.x)+(<span class="keyword">long</span> <span class="keyword">long</span>)<span class="built_in">abs</span>(a.y-b.y);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("E.in","r",stdin);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("E.out","w",stdout);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> iCase = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(T--)</span><br><span class="line"></span><br><span class="line">	&#123;</span><br><span class="line"></span><br><span class="line">		iCase++;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;K);</span><br><span class="line"></span><br><span class="line">		assert(n &gt;= <span class="number">1</span> &amp;&amp; n &lt;= <span class="number">60</span> &amp;&amp; K &gt;= <span class="number">1</span> &amp;&amp; K &lt;= n);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)&#123;</span><br><span class="line"></span><br><span class="line">			city[i].input();</span><br><span class="line"></span><br><span class="line">			assert(<span class="built_in">abs</span>(city[i].x) &lt;= <span class="number">1000000000</span>);</span><br><span class="line"></span><br><span class="line">			assert(<span class="built_in">abs</span>(city[i].y) &lt;= <span class="number">1000000000</span>);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">long</span> <span class="keyword">long</span> l = <span class="number">0</span>, r = <span class="number">100000000000L</span>L;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">long</span> <span class="keyword">long</span> ans = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span>(l &lt;= r)</span><br><span class="line"></span><br><span class="line">		&#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">long</span> <span class="keyword">long</span> mid = (l+r)/<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">			g.init(n,n);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)</span><br><span class="line"></span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; n;j++)</span><br><span class="line"></span><br><span class="line">					<span class="keyword">if</span>(dis(city[i],city[j]) &lt;= mid)</span><br><span class="line"></span><br><span class="line">						g.Link(i+<span class="number">1</span>,j+<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(g.Dance(<span class="number">0</span>))&#123;r = mid<span class="number">-1</span>;ans = mid;&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> l = mid+<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"Case #%d: %I64d\n"</span>,iCase,ans);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<pre><code>1006： [HDU5047](http://acm.hdu.edu.cn/showproblem.php?pid=5047) 直接根据多少个交点，多少个边，然后就是推公式。 很简单，故意组数比较多，可能少数JAVA.         sorry.  
</code></pre><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ***************</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Author        :kuangbin</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Created Time  :2014/9/11 13:19:51</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">File Name     :F.cpp</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">************************************************ */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;assert.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> * 高精度，支持乘法和加法</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">BigInt</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">static</span> <span class="keyword">int</span> mod = <span class="number">10000</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">static</span> <span class="keyword">int</span> DLEN = <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> a[<span class="number">600</span>],len;</span><br><span class="line"></span><br><span class="line">	BigInt()</span><br><span class="line"></span><br><span class="line">	&#123;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">memset</span>(a,<span class="number">0</span>,<span class="keyword">sizeof</span>(a));</span><br><span class="line"></span><br><span class="line">		len = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	BigInt(<span class="keyword">long</span> <span class="keyword">long</span> v)</span><br><span class="line"></span><br><span class="line">	&#123;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">memset</span>(a,<span class="number">0</span>,<span class="keyword">sizeof</span>(a));</span><br><span class="line"></span><br><span class="line">		len = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">do</span></span><br><span class="line"></span><br><span class="line">		&#123;</span><br><span class="line"></span><br><span class="line">			a[len++] = v%mod;</span><br><span class="line"></span><br><span class="line">			v /= mod;</span><br><span class="line"></span><br><span class="line">		&#125;<span class="keyword">while</span>(v);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	BigInt(<span class="keyword">const</span> <span class="keyword">char</span> s[])</span><br><span class="line"></span><br><span class="line">	&#123;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">memset</span>(a,<span class="number">0</span>,<span class="keyword">sizeof</span>(a));</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> L = <span class="built_in">strlen</span>(s);</span><br><span class="line"></span><br><span class="line">		len = L/DLEN;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(L%DLEN)len++;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = L<span class="number">-1</span>;i &gt;= <span class="number">0</span>;i -= DLEN)</span><br><span class="line"></span><br><span class="line">		&#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">int</span> t = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">int</span> k = i - DLEN + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(k &lt; <span class="number">0</span>)k = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j = k;j &lt;= i;j++)</span><br><span class="line"></span><br><span class="line">				t = t*<span class="number">10</span> + s[j] - <span class="string">'0'</span>;</span><br><span class="line"></span><br><span class="line">			a[index++] = t;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	BigInt <span class="keyword">operator</span> +(<span class="keyword">const</span> BigInt &amp;b)<span class="keyword">const</span></span><br><span class="line"></span><br><span class="line">	&#123;</span><br><span class="line"></span><br><span class="line">		BigInt res;</span><br><span class="line"></span><br><span class="line">		res.len = max(len,b.len);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= res.len;i++)</span><br><span class="line"></span><br><span class="line">			res.a[i] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; res.len;i++)</span><br><span class="line"></span><br><span class="line">		&#123;</span><br><span class="line"></span><br><span class="line">			res.a[i] += ((i &lt; len)?a[i]:<span class="number">0</span>)+((i &lt; b.len)?b.a[i]:<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">			res.a[i+<span class="number">1</span>] += res.a[i]/mod;</span><br><span class="line"></span><br><span class="line">			res.a[i] %= mod;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(res.a[res.len] &gt; <span class="number">0</span>)res.len++;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> res;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	BigInt <span class="keyword">operator</span> *(<span class="keyword">const</span> BigInt &amp;b)<span class="keyword">const</span></span><br><span class="line"></span><br><span class="line">	&#123;</span><br><span class="line"></span><br><span class="line">		BigInt res;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len;i++)</span><br><span class="line"></span><br><span class="line">		&#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">int</span> up = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; b.len;j++)</span><br><span class="line"></span><br><span class="line">			&#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">int</span> temp = a[i]*b.a[j] + res.a[i+j] + up;</span><br><span class="line"></span><br><span class="line">				res.a[i+j] = temp%mod;</span><br><span class="line"></span><br><span class="line">				up = temp/mod;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(up != <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">				res.a[i + b.len] = up;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		res.len = len + b.len;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span>(res.a[res.len - <span class="number">1</span>] == <span class="number">0</span> &amp;&amp;res.len &gt; <span class="number">1</span>)res.len--;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> res;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">output</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d"</span>,a[len<span class="number">-1</span>]);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = len<span class="number">-2</span>;i &gt;=<span class="number">0</span> ;i--)</span><br><span class="line"></span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%04d"</span>,a[i]);</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">BigInt A,B;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("F.in","r",stdin);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("F.out","w",stdout);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> iCase = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> T;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</span><br><span class="line"></span><br><span class="line">	assert(T &gt;= <span class="number">1</span> &amp;&amp; T &lt;= <span class="number">100000</span>);</span><br><span class="line"></span><br><span class="line">	assert(T == <span class="number">100000</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">long</span> <span class="keyword">long</span> n;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(T--)&#123;</span><br><span class="line"></span><br><span class="line">		iCase++;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%I64d"</span>,&amp;n);</span><br><span class="line"></span><br><span class="line">		assert(n &gt;= <span class="number">0</span> &amp;&amp; n &lt;= <span class="number">1000000000000L</span>L);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(n == <span class="number">0</span>)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"Case #%d: 1\n"</span>,iCase);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		A = (BigInt(n)*BigInt(<span class="number">8</span>*n<span class="number">-7</span>))+<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"Case #%d: "</span>,iCase);</span><br><span class="line"></span><br><span class="line">		A.output();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<pre><code>1007: [HDU5048](http://acm.hdu.edu.cn/showproblem.php?pid=5048) 比较水的几何了。 只要解方程去求线段和椭球的交点。
</code></pre><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ***************</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Author        :kuangbin</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Created Time  :2014/9/15 17:56:58</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">File Name     :E:\2014ACM\题目_上海网络赛\color\标程\G.cpp</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">************************************************ */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;assert.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-8</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">sqr</span><span class="params">(<span class="keyword">double</span> x)</span></span>&#123;<span class="keyword">return</span> x*x;&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span>&#123;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">double</span> x,y,z;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">input</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%lf%lf%lf"</span>,&amp;x,&amp;y,&amp;z);</span><br><span class="line"></span><br><span class="line">		assert(<span class="built_in">fabs</span>(x) &lt;= <span class="number">10000</span>);</span><br><span class="line"></span><br><span class="line">		assert(<span class="built_in">fabs</span>(y) &lt;= <span class="number">10000</span>);</span><br><span class="line"></span><br><span class="line">		assert(<span class="built_in">fabs</span>(z) &lt;= <span class="number">10000</span>);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Line</span>&#123;</span></span><br><span class="line"></span><br><span class="line">	Point s,e;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">input</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		s.input();</span><br><span class="line"></span><br><span class="line">		e.input();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">double</span> <span class="title">len</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">sqrt</span>((s.x-e.x)(s.x-e.x)+(s.y-e.y)(s.y-e.y)+(s.z-e.z)*(s.z-e.z));</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Ellipsoid</span>&#123;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">double</span> x,y,z,a,b,c;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">char</span> color[<span class="number">5</span>];</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">input</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%lf%lf%lf%lf%lf%lf%s"</span>,&amp;x,&amp;y,&amp;z,&amp;a,&amp;b,&amp;c,color);</span><br><span class="line"></span><br><span class="line">		assert(<span class="built_in">fabs</span>(x) &lt;= <span class="number">10000</span>);</span><br><span class="line"></span><br><span class="line">		assert(<span class="built_in">fabs</span>(y) &lt;= <span class="number">10000</span>);</span><br><span class="line"></span><br><span class="line">		assert(<span class="built_in">fabs</span>(z) &lt;= <span class="number">10000</span>);</span><br><span class="line"></span><br><span class="line">		assert(a &gt;= <span class="number">1</span> &amp;&amp; a &lt;= <span class="number">10000</span>);</span><br><span class="line"></span><br><span class="line">		assert(b &gt;= <span class="number">1</span> &amp;&amp; b &lt;= <span class="number">10000</span>);</span><br><span class="line"></span><br><span class="line">		assert(c &gt;= <span class="number">1</span> &amp;&amp; c &lt;= <span class="number">10000</span>);</span><br><span class="line"></span><br><span class="line">		assert(color[<span class="number">0</span>] == <span class="string">'R'</span> || color[<span class="number">0</span>] == <span class="string">'G'</span> || color[<span class="number">0</span>] == <span class="string">'B'</span>);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">output</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%lf %lf %lf %lf %lf %lf %s\n"</span>,x,y,z,a,b,c,color);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">calc</span><span class="params">(<span class="built_in">vector</span>&lt;Line&gt;line,<span class="built_in">vector</span>&lt;Ellipsoid&gt;el)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//for(int i = 0; i &lt; el.size();i++)</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">//el[i].output();</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">double</span> ans = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> sz1 = line.size();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; sz1;i++)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">vector</span>&lt;pair&lt;<span class="keyword">double</span>,<span class="keyword">int</span>&gt; &gt;vec;</span><br><span class="line"></span><br><span class="line">		vec.push_back(make_pair(<span class="number">0.0</span>,<span class="number">0</span>));</span><br><span class="line"></span><br><span class="line">		vec.push_back(make_pair(<span class="number">1.0</span>,<span class="number">0</span>));</span><br><span class="line"></span><br><span class="line">		<span class="keyword">double</span> len = line[i].len();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">fabs</span>(len) &lt; eps)<span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">double</span> x1 = line[i].s.x;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">double</span> y1 = line[i].s.y;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">double</span> z1 = line[i].s.z;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">double</span> dx = line[i].e.x - line[i].s.x;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">double</span> dy = line[i].e.y - line[i].s.y;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">double</span> dz = line[i].e.z - line[i].s.z;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//printf("%lf %lf %lf %lf %lf %lf\n",line[i].s.x,line[i].s.y,line[i].s.z,line[i].e.x,line[i].e.y,line[i].e.z);</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> sz = el.size();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; sz;j++)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">double</span> a = sqr(dx)/sqr(el[j].a) + sqr(dy)/sqr(el[j].b) + sqr(dz)/sqr(el[j].c);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">double</span> b = <span class="number">2</span>*dx*(x1-el[j].x)/sqr(el[j].a) + </span><br><span class="line"></span><br><span class="line">				<span class="number">2</span>*dy*(y1-el[j].y)/sqr(el[j].b) + <span class="number">2</span>*dz*(z1-el[j].z)/sqr(el[j].c);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">double</span> c = sqr(x1-el[j].x)/sqr(el[j].a) + sqr(y1-el[j].y)/sqr(el[j].b)</span><br><span class="line"></span><br><span class="line">				\+ sqr(z1-el[j].z)/sqr(el[j].c) - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">double</span> delta = b*b - <span class="number">4</span>*a*c;</span><br><span class="line"></span><br><span class="line">			<span class="comment">//cout&lt;&lt;delta&lt;&lt;endl;</span></span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(delta &lt; eps)<span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">double</span> k1 = (-b+<span class="built_in">sqrt</span>(delta))/(<span class="number">2</span>*a);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">double</span> k2 = (-b-<span class="built_in">sqrt</span>(delta))/(<span class="number">2</span>*a);</span><br><span class="line"></span><br><span class="line">			<span class="comment">//printf("a  %.10lf  b %.10lf  c %.10lf \n",a,b,c);</span></span><br><span class="line"></span><br><span class="line">			<span class="comment">//printf("%.10lf  %.10lf\n",k1,k2);</span></span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(k1 &gt; k2)swap(k1,k2);</span><br><span class="line"></span><br><span class="line">			k1 = max(<span class="number">0.0</span>,k1);</span><br><span class="line"></span><br><span class="line">			k2 = min(<span class="number">1.0</span>,k2);</span><br><span class="line"></span><br><span class="line">			<span class="comment">//printf("%.10lf  %.10lf\n",k1,k2);</span></span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(k1 &gt;= k2)<span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">			vec.push_back(make_pair(k1,<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">			vec.push_back(make_pair(k2,<span class="number">-1</span>));</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		sort(vec.begin(),vec.end());</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> sz2 = vec.size();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">double</span> pre = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; sz2;j++)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(cnt &gt; <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">				ans += (vec[j].first - pre)*len;</span><br><span class="line"></span><br><span class="line">			pre = vec[j].first;</span><br><span class="line"></span><br><span class="line">			cnt += vec[j].second;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Line line[<span class="number">110</span>];</span><br><span class="line"></span><br><span class="line">Ellipsoid el[<span class="number">110</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;Line&gt;vec1;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;Ellipsoid&gt;vec2;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("G.in","r",stdin);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("G.out","w",stdout);</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> T;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</span><br><span class="line"></span><br><span class="line">	assert(T &gt;= <span class="number">1</span> &amp;&amp; T  &lt;= <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> iCase = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> n,m;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(T--)&#123;</span><br><span class="line"></span><br><span class="line">		iCase++;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)line[i].input();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; m;i++)&#123;</span><br><span class="line"></span><br><span class="line">			el[i].input();</span><br><span class="line"></span><br><span class="line">		<span class="comment">//	printf("i %d  %c\n",i,el[i].color[0]);</span></span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		vec1.clear();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)vec1.push_back(line[i]);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">double</span> tot = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)tot += line[i].len();</span><br><span class="line"></span><br><span class="line">		vec2.clear();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; m;i++)</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(el[i].color[<span class="number">0</span>] == <span class="string">'R'</span>)</span><br><span class="line"></span><br><span class="line">				vec2.push_back(el[i]);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">double</span> R = calc(vec1,vec2);</span><br><span class="line"></span><br><span class="line">		vec2.clear();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; m;i++)</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(el[i].color[<span class="number">0</span>] == <span class="string">'G'</span>)</span><br><span class="line"></span><br><span class="line">				vec2.push_back(el[i]);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">double</span> G = calc(vec1,vec2);</span><br><span class="line"></span><br><span class="line">		vec2.clear();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; m;i++)</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(el[i].color[<span class="number">0</span>] == <span class="string">'B'</span>)</span><br><span class="line"></span><br><span class="line">				vec2.push_back(el[i]);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">double</span> B = calc(vec1,vec2);</span><br><span class="line"></span><br><span class="line">		vec2.clear();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; m;i++)</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(el[i].color[<span class="number">0</span>] == <span class="string">'R'</span> || el[i].color[<span class="number">0</span>] == <span class="string">'G'</span>)</span><br><span class="line"></span><br><span class="line">				vec2.push_back(el[i]);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">double</span> RG = calc(vec1,vec2);</span><br><span class="line"></span><br><span class="line">		vec2.clear();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; m;i++)</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(el[i].color[<span class="number">0</span>] == <span class="string">'R'</span> || el[i].color[<span class="number">0</span>] == <span class="string">'B'</span>)</span><br><span class="line"></span><br><span class="line">				vec2.push_back(el[i]);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">double</span> RB = calc(vec1,vec2);</span><br><span class="line"></span><br><span class="line">		vec2.clear();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; m;i++)</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(el[i].color[<span class="number">0</span>] == <span class="string">'G'</span> || el[i].color[<span class="number">0</span>] == <span class="string">'B'</span>)</span><br><span class="line"></span><br><span class="line">				vec2.push_back(el[i]);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">double</span> GB = calc(vec1,vec2);</span><br><span class="line"></span><br><span class="line">		vec2.clear();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; m;i++)</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(el[i].color[<span class="number">0</span>] == <span class="string">'R'</span> || el[i].color[<span class="number">0</span>] == <span class="string">'G'</span> || el[i].color[<span class="number">0</span>] == <span class="string">'B'</span>)</span><br><span class="line"></span><br><span class="line">				vec2.push_back(el[i]);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">double</span> RGB = calc(vec1,vec2);</span><br><span class="line"></span><br><span class="line">		<span class="comment">//printf("tot  %.6lf  R  %lf  G %lf  B %lf RG %lf RB %lf GB %lf RGB %lf\n",tot,R,G,B,RG,RB,GB,RGB);</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">double</span> ans1 = RGB - GB;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">double</span> ans2 = RGB - RB;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">double</span> ans3 = RGB - RG;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">double</span> ans4 = RGB - B - ans1 - ans2;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">double</span> ans5 = RGB - G - ans1 - ans3;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">double</span> ans6 = RGB - R - ans2 - ans3;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">double</span> ans7 = R + G - RG - ans4;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">double</span> aa = tot-RGB;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">fabs</span>(aa) &lt; eps)aa = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">fabs</span>(ans1) &lt; eps)ans1 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">fabs</span>(ans2) &lt; eps)ans2 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">fabs</span>(ans3) &lt; eps)ans3 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">fabs</span>(ans4) &lt; eps)ans4 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">fabs</span>(ans5) &lt; eps)ans5 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">fabs</span>(ans6) &lt; eps)ans6 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">fabs</span>(ans7) &lt; eps)ans7 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//printf("Case #%d:\n",iCase);</span></span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%.10lf\n"</span>,aa);</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%.10lf\n"</span>,ans1);</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%.10lf\n"</span>,ans2);</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%.10lf\n"</span>,ans3);</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%.10lf\n"</span>,ans4);</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%.10lf\n"</span>,ans5);</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%.10lf\n"</span>,ans6);</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%.10lf\n"</span>,ans7);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<pre><code>1008： [HDU5049](http://acm.hdu.edu.cn/showproblem.php?pid=5049) 就是一个简单的DP。 使用矩阵去优化。  故意把范围设的不大的，太大一想就是矩阵了。 注意特判一些情况。 还有答案为0，可能不是 Impossible. 故意造的数据。
</code></pre><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ***************</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Author        :kuangbin</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Created Time  :2014/9/16 22:41:06</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">File Name     :E:\2014ACM\题目_上海网络赛\Guess\标程\H.cpp</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">************************************************ */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;assert.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MOD = <span class="number">20140927</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Matrix</span>&#123;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> mat[<span class="number">2</span>][<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">memset</span>(mat,<span class="number">0</span>,<span class="keyword">sizeof</span>(mat));</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Matrix <span class="keyword">operator</span> *(<span class="keyword">const</span> Matrix &amp;b)<span class="keyword">const</span>&#123;</span><br><span class="line"></span><br><span class="line">		Matrix ret;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">2</span>;i++)</span><br><span class="line"></span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; <span class="number">2</span>;j++)&#123;</span><br><span class="line"></span><br><span class="line">				ret.mat[i][j] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>;k &lt; <span class="number">2</span>;k++)&#123;</span><br><span class="line"></span><br><span class="line">					ret.mat[i][j] += (<span class="keyword">long</span> <span class="keyword">long</span>)mat[i][k]*b.mat[k][j]%MOD;</span><br><span class="line"></span><br><span class="line">					<span class="keyword">if</span>(ret.mat[i][j] &gt;= MOD)</span><br><span class="line"></span><br><span class="line">						ret.mat[i][j] -= MOD;</span><br><span class="line"></span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> ret;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">output</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d %d\n%d %d\n"</span>,mat[<span class="number">0</span>][<span class="number">0</span>],mat[<span class="number">0</span>][<span class="number">1</span>],mat[<span class="number">1</span>][<span class="number">0</span>],mat[<span class="number">1</span>][<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function">Matrix <span class="title">pow_M</span><span class="params">(Matrix A,<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	Matrix ret;</span><br><span class="line"></span><br><span class="line">	ret.mat[<span class="number">0</span>][<span class="number">0</span>] = ret.mat[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">	ret.mat[<span class="number">0</span>][<span class="number">1</span>] = ret.mat[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	Matrix tmp = A;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(n)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(n&amp;<span class="number">1</span>)ret = ret*tmp;</span><br><span class="line"></span><br><span class="line">		tmp = tmp*tmp;</span><br><span class="line"></span><br><span class="line">		n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Matrix A[<span class="number">11</span>*<span class="number">11</span>*<span class="number">11</span> + <span class="number">100</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;vec;</span><br><span class="line"></span><br><span class="line">Matrix B;</span><br><span class="line"></span><br><span class="line">Matrix C;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Matrix2</span>&#123;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> mat[<span class="number">2</span>][<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">memset</span>(mat,<span class="number">0</span>,<span class="keyword">sizeof</span>(mat));</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Matrix2 <span class="keyword">operator</span> *(<span class="keyword">const</span> Matrix2 &amp;b)<span class="keyword">const</span>&#123;</span><br><span class="line"></span><br><span class="line">		Matrix2 ret;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">2</span>;i++)</span><br><span class="line"></span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; <span class="number">2</span>;j++)&#123;</span><br><span class="line"></span><br><span class="line">				ret.mat[i][j] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>;k &lt; <span class="number">2</span>;k++)</span><br><span class="line"></span><br><span class="line">					<span class="keyword">if</span>(mat[i][k] &amp;&amp; b.mat[k][j])</span><br><span class="line"></span><br><span class="line">						ret.mat[i][j] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> ret;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function">Matrix2 <span class="title">pow_M</span><span class="params">(Matrix2 A,<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	Matrix2 ret;</span><br><span class="line"></span><br><span class="line">	ret.mat[<span class="number">0</span>][<span class="number">0</span>] = ret.mat[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">	ret.mat[<span class="number">0</span>][<span class="number">1</span>] = ret.mat[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	Matrix2 tmp = A;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(n)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(n&amp;<span class="number">1</span>)ret = ret*tmp;</span><br><span class="line"></span><br><span class="line">		tmp = tmp*tmp;</span><br><span class="line"></span><br><span class="line">		n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Matrix2 A2[<span class="number">11</span>*<span class="number">11</span>*<span class="number">11</span> + <span class="number">100</span>];</span><br><span class="line"></span><br><span class="line">Matrix2 B2;</span><br><span class="line"></span><br><span class="line">Matrix2 C2;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> &amp;a,<span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(a || b)a = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("H.in","r",stdin);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("H.out","w",stdout);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">11</span>*<span class="number">11</span>*<span class="number">11</span>;i++)A[i].init();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">11</span>*<span class="number">11</span>*<span class="number">11</span>;i++)A2[i].init();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> x = <span class="number">0</span>;x &lt; <span class="number">11</span>;x++)</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> y = <span class="number">0</span>;y &lt; <span class="number">11</span>;y++)</span><br><span class="line"></span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> z = <span class="number">0</span>; z &lt; <span class="number">11</span>;z++)&#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">int</span> id = x*<span class="number">11</span>*<span class="number">11</span> + y*<span class="number">11</span> + z;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">10</span>;i++)&#123;</span><br><span class="line"></span><br><span class="line">					<span class="keyword">if</span>(x != <span class="number">10</span> &amp;&amp; x != i)<span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">					<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; <span class="number">10</span>;j++)&#123;</span><br><span class="line"></span><br><span class="line">						<span class="keyword">if</span>(y != <span class="number">10</span> &amp;&amp; y != j)<span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">						<span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>;k &lt; <span class="number">10</span>;k++)&#123;</span><br><span class="line"></span><br><span class="line">							<span class="keyword">if</span>(z != <span class="number">10</span> &amp;&amp; z != k)<span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">							<span class="keyword">if</span>(i + j == k)A[id].mat[<span class="number">0</span>][<span class="number">0</span>]++;</span><br><span class="line"></span><br><span class="line">							<span class="keyword">if</span>(i + j == <span class="number">10</span> + k)A[id].mat[<span class="number">0</span>][<span class="number">1</span>]++;</span><br><span class="line"></span><br><span class="line">							<span class="keyword">if</span>(i + j + <span class="number">1</span> == k)A[id].mat[<span class="number">1</span>][<span class="number">0</span>]++;</span><br><span class="line"></span><br><span class="line">							<span class="keyword">if</span>(i + j + <span class="number">1</span> == <span class="number">10</span> + k)A[id].mat[<span class="number">1</span>][<span class="number">1</span>]++;</span><br><span class="line"></span><br><span class="line">							<span class="keyword">if</span>(i + j == k)Add(A2[id].mat[<span class="number">0</span>][<span class="number">0</span>],<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">							<span class="keyword">if</span>(i + j == <span class="number">10</span> + k)Add(A2[id].mat[<span class="number">0</span>][<span class="number">1</span>],<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">							<span class="keyword">if</span>(i + j + <span class="number">1</span> == k)Add(A2[id].mat[<span class="number">1</span>][<span class="number">0</span>],<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">							<span class="keyword">if</span>(i + j + <span class="number">1</span> == <span class="number">10</span> + k)Add(A2[id].mat[<span class="number">1</span>][<span class="number">1</span>],<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">						&#125;</span><br><span class="line"></span><br><span class="line">					&#125;</span><br><span class="line"></span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> T;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> iCase = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> n1,m1,n2,m2,n3,m3;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(T--)&#123;</span><br><span class="line"></span><br><span class="line">		iCase++;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n1,&amp;m1);</span><br><span class="line"></span><br><span class="line">		assert(n1 &gt;= <span class="number">1</span> &amp;&amp; n1 &lt;= <span class="number">10000000</span>);</span><br><span class="line"></span><br><span class="line">		assert(m1 &gt;= <span class="number">0</span> &amp;&amp; m1 &lt;= n1);</span><br><span class="line"></span><br><span class="line">		<span class="built_in">map</span>&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;mp1;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">map</span>&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;mp2;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">map</span>&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;mp3;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">bool</span> flag = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">		vec.clear();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> id,x;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span>(m1--)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;id,&amp;x);</span><br><span class="line"></span><br><span class="line">			id = n1 - <span class="number">1</span> - id;</span><br><span class="line"></span><br><span class="line">			vec.push_back(id);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(mp1.find(id) != mp1.end())&#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span>(mp1[id] != x)flag = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> mp1[id] = x;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n2,&amp;m2);</span><br><span class="line"></span><br><span class="line">		assert(n2 &gt;= <span class="number">1</span> &amp;&amp; n2 &lt;= <span class="number">10000000</span>);</span><br><span class="line"></span><br><span class="line">		assert(m2 &gt;= <span class="number">0</span> &amp;&amp; m2 &lt;= n2);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span>(m2--)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;id,&amp;x);</span><br><span class="line"></span><br><span class="line">			id = n2 - <span class="number">1</span> - id;</span><br><span class="line"></span><br><span class="line">			vec.push_back(id);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(mp2.find(id) != mp2.end())&#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span>(mp2[id] != x)flag = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> mp2[id] = x;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n3,&amp;m3);</span><br><span class="line"></span><br><span class="line">		assert(n3 &gt;= <span class="number">1</span> &amp;&amp; n3 &lt;= <span class="number">10000000</span>);</span><br><span class="line"></span><br><span class="line">		assert(m3 &gt;= <span class="number">0</span> &amp;&amp; m3 &lt;= n3);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span>(m3--)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;id,&amp;x);</span><br><span class="line"></span><br><span class="line">			id = n3 - <span class="number">1</span> - id;</span><br><span class="line"></span><br><span class="line">			vec.push_back(id);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(mp3.find(id) != mp3.end())&#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span>(mp3[id] != x)flag = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> mp3[id] = x;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>((!flag) || (n1 &lt; max(n2,n3)) || (n1 &gt; max(n2,n3)+<span class="number">1</span>))&#123;</span><br><span class="line"></span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"Case #%d: IMPOSSIBLE\n"</span>,iCase);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//vec.push_back(n1-1);</span></span><br><span class="line"></span><br><span class="line">		vec.push_back(n2<span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">		vec.push_back(n3<span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">		sort(vec.begin(),vec.end());</span><br><span class="line"></span><br><span class="line">		vec.erase(unique(vec.begin(),vec.end()),vec.end());</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> mn = max(n2,n3);</span><br><span class="line"></span><br><span class="line">		B.init();</span><br><span class="line"></span><br><span class="line">		B.mat[<span class="number">0</span>][<span class="number">0</span>] = B.mat[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">		B2.init();</span><br><span class="line"></span><br><span class="line">		B2.mat[<span class="number">0</span>][<span class="number">0</span>] = B2.mat[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(vec[<span class="number">0</span>] &gt; <span class="number">0</span>)B = B * pow_M(A[<span class="number">10</span>*<span class="number">11</span>*<span class="number">11</span>+<span class="number">10</span>*<span class="number">11</span>+<span class="number">10</span>],vec[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(vec[<span class="number">0</span>] &gt; <span class="number">0</span>)B2 = B2 * pow_M(A2[<span class="number">10</span>*<span class="number">11</span>*<span class="number">11</span>+<span class="number">10</span>*<span class="number">11</span>+<span class="number">10</span>],vec[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> sz = vec.size();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; sz;i++)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="comment">//printf("%d\n",vec[i]);</span></span><br><span class="line"></span><br><span class="line">			<span class="comment">//B.output();</span></span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(i &gt; <span class="number">0</span>)&#123;</span><br><span class="line"></span><br><span class="line">				B = B * pow_M(A[<span class="number">10</span>*<span class="number">11</span>*<span class="number">11</span>+<span class="number">10</span>*<span class="number">11</span>+<span class="number">10</span>],vec[i]-vec[i<span class="number">-1</span>]<span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">int</span> x,y,z;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(mp2.find(vec[i]) == mp2.end())x = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> x = mp2[vec[i]];</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(vec[i] &gt;= n2)x = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(mp3.find(vec[i]) == mp3.end())y = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> y = mp3[vec[i]];</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(vec[i] &gt;= n3)y = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(mp1.find(vec[i]) == mp1.end())z = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> z = mp1[vec[i]];</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(vec[i] &gt;= n1)z = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(vec[i] != n2<span class="number">-1</span> &amp;&amp; vec[i] != n3<span class="number">-1</span>)&#123;</span><br><span class="line"></span><br><span class="line">				B = B * A[x*<span class="number">11</span>*<span class="number">11</span>+y*<span class="number">11</span>+z];</span><br><span class="line"></span><br><span class="line">				B2 = B2 * A2[x*<span class="number">11</span>*<span class="number">11</span>+y*<span class="number">11</span>+z];</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">				C.init();</span><br><span class="line"></span><br><span class="line">				C2.init();</span><br><span class="line"></span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> p = <span class="number">0</span>;p &lt; <span class="number">10</span>;p++)</span><br><span class="line"></span><br><span class="line">					<span class="keyword">for</span>(<span class="keyword">int</span> q = <span class="number">0</span>;q &lt; <span class="number">10</span>;q++)</span><br><span class="line"></span><br><span class="line">						<span class="keyword">for</span>(<span class="keyword">int</span> r = <span class="number">0</span>;r &lt; <span class="number">10</span>;r++)&#123;</span><br><span class="line"></span><br><span class="line">							<span class="keyword">if</span>(x != <span class="number">10</span> &amp;&amp; p != x)<span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">							<span class="keyword">if</span>(y != <span class="number">10</span> &amp;&amp; q != y)<span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">							<span class="keyword">if</span>(z != <span class="number">10</span> &amp;&amp; r != z)<span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">							<span class="keyword">if</span>(n2 != <span class="number">1</span> &amp;&amp; vec[i] == n2<span class="number">-1</span> &amp;&amp; p == <span class="number">0</span>)<span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">							<span class="keyword">if</span>(n3 != <span class="number">1</span> &amp;&amp; vec[i] == n3<span class="number">-1</span> &amp;&amp; q == <span class="number">0</span>)<span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">							<span class="keyword">if</span>(vec[i] &gt;= n2 &amp;&amp; p != <span class="number">0</span>)<span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">							<span class="keyword">if</span>(vec[i] &gt;= n3 &amp;&amp; q != <span class="number">0</span>)<span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">							<span class="keyword">if</span>(p+q == r)C.mat[<span class="number">0</span>][<span class="number">0</span>]++;</span><br><span class="line"></span><br><span class="line">							<span class="keyword">if</span>(p+q == r+<span class="number">10</span>)C.mat[<span class="number">0</span>][<span class="number">1</span>]++;</span><br><span class="line"></span><br><span class="line">							<span class="keyword">if</span>(p+q+<span class="number">1</span> == r)C.mat[<span class="number">1</span>][<span class="number">0</span>]++;</span><br><span class="line"></span><br><span class="line">							<span class="keyword">if</span>(p+q+<span class="number">1</span> == r + <span class="number">10</span>)C.mat[<span class="number">1</span>][<span class="number">1</span>]++;</span><br><span class="line"></span><br><span class="line">    						<span class="keyword">if</span>(p+q == r)Add(C2.mat\[<span class="number">0</span>\]\[<span class="number">0</span>\],<span class="number">1</span>);</span><br><span class="line">    						<span class="keyword">if</span>(p+q == r+<span class="number">10</span>)Add(C2.mat\[<span class="number">0</span>\]\[<span class="number">1</span>\],<span class="number">1</span>);</span><br><span class="line">    						<span class="keyword">if</span>(p+q+<span class="number">1</span> == r)Add(C2.mat\[<span class="number">1</span>\]\[<span class="number">0</span>\],<span class="number">1</span>);</span><br><span class="line">    						<span class="keyword">if</span>(p+q+<span class="number">1</span> == r + <span class="number">10</span>)Add(C2.mat\[<span class="number">1</span>\]\[<span class="number">1</span>\],<span class="number">1</span>);</span><br><span class="line">    					&#125;</span><br><span class="line">    			<span class="comment">//C.output();</span></span><br><span class="line">    			B = B*C;</span><br><span class="line">    			B2 = B2*C2;</span><br><span class="line">    		&#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    	<span class="keyword">int</span> ans2 = <span class="number">0</span>;</span><br><span class="line">    	<span class="keyword">if</span>(n1 == max(n2,n3))&#123;</span><br><span class="line">    		ans = B.mat\[<span class="number">0</span>\]\[<span class="number">0</span>\];</span><br><span class="line">    		ans2 = B2.mat\[<span class="number">0</span>\]\[<span class="number">0</span>\];</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">else</span>&#123;</span><br><span class="line">    		<span class="keyword">if</span>(mp1.find(n1<span class="number">-1</span>) != mp1.end() &amp;&amp; mp1\[n1<span class="number">-1</span>\] != <span class="number">1</span>)&#123;</span><br><span class="line">    			<span class="built_in">printf</span>(<span class="string">"Case #%d: IMPOSSIBLE\\n"</span>,iCase);</span><br><span class="line">    			<span class="keyword">continue</span>;</span><br><span class="line">    		&#125;</span><br><span class="line">    		ans = B.mat\[<span class="number">0</span>\]\[<span class="number">1</span>\];</span><br><span class="line">    		ans2 = B2.mat\[<span class="number">0</span>\]\[<span class="number">1</span>\];</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="comment">//printf("%d %d\\n",ans,ans2);</span></span><br><span class="line">    	<span class="keyword">if</span>(ans2 == <span class="number">0</span>)<span class="built_in">printf</span>(<span class="string">"Case #%d: IMPOSSIBLE\\n"</span>,iCase);</span><br><span class="line">    	<span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"Case #%d: %d\\n"</span>,iCase,ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<pre><code>1009： [HDU5050](http://acm.hdu.edu.cn/showproblem.php?pid=5050) 就是求两个大数的GCD。 JAVA可以随便搞！ 本题定位就是签到题。当然C++也可以搞。
</code></pre><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ***************</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Author        :kuangbin</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Created Time  :2014/9/18 16:43:54</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">File Name     :F:\题目_上海网络赛\dividedland\标程\I.cpp</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">************************************************ */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">BigNum</span>&#123;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> a[<span class="number">10100</span>];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">input</span><span class="params">(<span class="keyword">char</span> str[])</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		n = <span class="built_in">strlen</span>(str);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)</span><br><span class="line"></span><br><span class="line">			a[i] = str[n<span class="number">-1</span>-i]-<span class="string">'0'</span>;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> BigNum &amp;b)<span class="keyword">const</span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(n &lt; b.n)<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(n &gt; b.n)<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = n<span class="number">-1</span>;i &gt;= <span class="number">0</span>;i--)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(a[i] &lt; b.a[i])<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(a[i] &gt; b.a[i])<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	BigNum <span class="keyword">operator</span> -(<span class="keyword">const</span> BigNum &amp;b)<span class="keyword">const</span>&#123;</span><br><span class="line"></span><br><span class="line">		BigNum ret;</span><br><span class="line"></span><br><span class="line">		ret.n = n;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> mu = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">int</span> tmp;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(i &lt; b.n)tmp = a[i] - b.a[i] - mu;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> tmp = a[i] - mu;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(tmp &gt;= <span class="number">0</span>)&#123;</span><br><span class="line"></span><br><span class="line">				mu = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">				ret.a[i] = tmp;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">				mu = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">				ret.a[i] = tmp+<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span>(ret.n &gt; <span class="number">0</span> &amp;&amp; ret.a[ret.n<span class="number">-1</span>] == <span class="number">0</span>)ret.n--;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> ret;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function">BigNum <span class="title">div2</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		BigNum ret;</span><br><span class="line"></span><br><span class="line">		ret.n = n<span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n<span class="number">-1</span>;i++)</span><br><span class="line"></span><br><span class="line">			ret.a[i] = a[i+<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> ret;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">output</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = n<span class="number">-1</span>;i &gt;= <span class="number">0</span>;i--)</span><br><span class="line"></span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%d"</span>,a[i]);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">gcd</span><span class="params">(BigNum a,BigNum b)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> c2 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(a.n &amp;&amp; b.n)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(a.a[<span class="number">0</span>])&#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(b.a[<span class="number">0</span>])&#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span>(b &lt; a)a = a-b;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">else</span> b = b-a;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> b = b.div2();</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(b.a[<span class="number">0</span>])a = a.div2();</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">				a = a.div2();</span><br><span class="line"></span><br><span class="line">				b = b.div2();</span><br><span class="line"></span><br><span class="line">				c2++;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(a.n)a.output();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">else</span> b.output();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(c2--)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"0"</span>);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> str[<span class="number">10010</span>];</span><br><span class="line"></span><br><span class="line">BigNum a,b,c;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("I.in","r",stdin);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("I.out","w",stdout);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> iCase = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(T--)&#123;</span><br><span class="line"></span><br><span class="line">		iCase++;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>,str);</span><br><span class="line"></span><br><span class="line">		a.input(str);</span><br><span class="line"></span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>,str);</span><br><span class="line"></span><br><span class="line">		b.input(str);</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"Case #%d: "</span>,iCase);</span><br><span class="line"></span><br><span class="line">		gcd(a,b);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<pre><code>1010： [HDU5051](http://acm.hdu.edu.cn/showproblem.php?pid=5051) Benford&apos;s law http://baike.baidu.com/view/1405011.htm?from_id=11319476&amp;type=syn&amp;fromtitle=Benford%27s+law&amp;fr=aladdin http://zh.wikipedia.org/wiki/%E6%9C%AC%E7%A6%8F%E7%89%B9%E5%AE%9A%E5%BE%8B 这个教练提供的题。 特判一些情况就可以AC了。
</code></pre><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ***************</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Author        :kuangbin</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Created Time  :2014/9/18 20:01:40</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">File Name     :F:\题目_上海网络赛\fraction\标程\J.cpp</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">************************************************ */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("J.in","r",stdin);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("J.out","w",stdout);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> iCase = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> n,b,q;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(T--)&#123;</span><br><span class="line"></span><br><span class="line">		iCase++;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;n,&amp;b,&amp;q);</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"Case #%d: "</span>,iCase);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(q == <span class="number">1</span>)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">bool</span> flag = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">while</span>(b)&#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span>(n == b)&#123;</span><br><span class="line"></span><br><span class="line">					flag = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				b /= <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(flag)<span class="built_in">printf</span>(<span class="string">"1.00000\n"</span>);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"0.00000\n"</span>);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(q == <span class="number">10</span> || q == <span class="number">100</span> || q == <span class="number">1000</span>)&#123;</span><br><span class="line"></span><br><span class="line">			b *= <span class="number">100000</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">bool</span> flag = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">while</span>(b)&#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span>(n == b)&#123;</span><br><span class="line"></span><br><span class="line">					flag = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				b /= <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(flag)<span class="built_in">printf</span>(<span class="string">"1.00000\n"</span>);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"0.00000\n"</span>);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">double</span> ans = (<span class="built_in">log</span>(n+<span class="number">1</span>)-<span class="built_in">log</span>(n))/<span class="built_in">log</span>(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%.5lf\n"</span>,ans);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<pre><code>1011： [HDU5052](http://acm.hdu.edu.cn/showproblem.php?pid=5052) shumj出的LCT题。 直接LCT搞就可以了。 LCT的姿势不够优美可能被卡。
</code></pre><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ***************</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Author        :kuangbin</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Created Time  :2014/9/18 21:59:15</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">File Name     :K.cpp</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">************************************************ */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;assert.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">50010</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> *<span class="title">null</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line"></span><br><span class="line">	Node *fa,*ch[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> val;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> Max,Min;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> mm;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> rmm;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> rev,add;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">clear</span><span class="params">(<span class="keyword">int</span> _val)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		fa = ch[<span class="number">0</span>] = ch[<span class="number">1</span>] = null;</span><br><span class="line"></span><br><span class="line">		val = Max = Min = _val;</span><br><span class="line"></span><br><span class="line">		mm = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		rmm = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		rev = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		add = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">push_up</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(<span class="keyword">this</span> == null)<span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">		mm = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		mm = max(mm,ch[<span class="number">0</span>]-&gt;mm);</span><br><span class="line"></span><br><span class="line">		mm = max(mm,ch[<span class="number">1</span>]-&gt;mm);</span><br><span class="line"></span><br><span class="line">		mm = max(mm,max(val,ch[<span class="number">1</span>]-&gt;Max)-ch[<span class="number">0</span>]-&gt;Min);</span><br><span class="line"></span><br><span class="line">		mm = max(mm,ch[<span class="number">1</span>]-&gt;Max-min(ch[<span class="number">0</span>]-&gt;Min,val));</span><br><span class="line"></span><br><span class="line">		rmm = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		rmm = max(rmm,ch[<span class="number">0</span>]-&gt;rmm);</span><br><span class="line"></span><br><span class="line">		rmm = max(rmm,ch[<span class="number">1</span>]-&gt;rmm);</span><br><span class="line"></span><br><span class="line">		rmm = max(rmm,max(val,ch[<span class="number">0</span>]-&gt;Max)-ch[<span class="number">1</span>]-&gt;Min);</span><br><span class="line"></span><br><span class="line">		rmm = max(rmm,ch[<span class="number">0</span>]-&gt;Max-min(ch[<span class="number">1</span>]-&gt;Min,val));</span><br><span class="line"></span><br><span class="line">		Max = max(val,max(ch[<span class="number">0</span>]-&gt;Max,ch[<span class="number">1</span>]-&gt;Max));</span><br><span class="line"></span><br><span class="line">		Min = min(val,min(ch[<span class="number">0</span>]-&gt;Min,ch[<span class="number">1</span>]-&gt;Min));</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">setc</span><span class="params">(Node *p,<span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		ch[d] = p;</span><br><span class="line"></span><br><span class="line">		p-&gt;fa = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">d</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> fa-&gt;ch[<span class="number">1</span>] == <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">isroot</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> fa == null || fa-&gt;ch[<span class="number">0</span>] != <span class="keyword">this</span> &amp;&amp; fa-&gt;ch[<span class="number">1</span>] != <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">flip</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(<span class="keyword">this</span> == null)<span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">		swap(ch[<span class="number">0</span>],ch[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">		swap(mm,rmm);</span><br><span class="line"></span><br><span class="line">		rev ^= <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">update_add</span><span class="params">(<span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(<span class="keyword">this</span> == null)<span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">		val += w;</span><br><span class="line"></span><br><span class="line">		Min += w;</span><br><span class="line"></span><br><span class="line">		Max += w;</span><br><span class="line"></span><br><span class="line">		add += w;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">push_down</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(<span class="keyword">this</span> == null)<span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(rev)&#123;</span><br><span class="line"></span><br><span class="line">			ch[<span class="number">0</span>]-&gt;flip(); ch[<span class="number">1</span>]-&gt;flip(); rev = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(add)&#123;</span><br><span class="line"></span><br><span class="line">			ch[<span class="number">0</span>]-&gt;update_add(add);ch[<span class="number">1</span>]-&gt;update_add(add);</span><br><span class="line"></span><br><span class="line">			add = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">go</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(!isroot())fa-&gt;go();</span><br><span class="line"></span><br><span class="line">		push_down();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">rot</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		Node *f = fa, *ff = fa-&gt;fa;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> c = d(), cc = fa-&gt;d();</span><br><span class="line"></span><br><span class="line">		f-&gt;setc(ch[!c],c);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">this</span>-&gt;setc(f,!c);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(ff-&gt;ch[cc] == f)ff-&gt;setc(<span class="keyword">this</span>,cc);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">this</span>-&gt;fa = ff;</span><br><span class="line"></span><br><span class="line">		f-&gt;push_up();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">inline</span> Node* <span class="title">splay</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		go();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span>(!isroot())&#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(!fa-&gt;isroot())</span><br><span class="line"></span><br><span class="line">				d()==fa-&gt;d() ? fa-&gt;rot() : rot();</span><br><span class="line"></span><br><span class="line">			rot();</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		push_up();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">inline</span> Node* <span class="title">access</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(Node *p = <span class="keyword">this</span>, *q = null; p != null; q = p, p = p-&gt;fa)&#123;</span><br><span class="line"></span><br><span class="line">			p-&gt;splay()-&gt;setc(q,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">			p-&gt;push_up();</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> splay();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">make_root</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		access()-&gt;flip();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Node pool[MAXN],*tail;</span><br><span class="line"></span><br><span class="line">Node *node[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> to,next;</span><br><span class="line"></span><br><span class="line">&#125;edge[MAXN*<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> head[MAXN],tot;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	tot = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="keyword">sizeof</span>(head));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	edge[tot].to = v;</span><br><span class="line"></span><br><span class="line">	edge[tot].next = head[u];</span><br><span class="line"></span><br><span class="line">	head[u] = tot++;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> g[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> fa[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">(<span class="keyword">int</span> s)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> l,r;</span><br><span class="line"></span><br><span class="line">	g[l=r=<span class="number">1</span>] = s;</span><br><span class="line"></span><br><span class="line">	fa[s] = s;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> u = g[l++];</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = head[u];i != <span class="number">-1</span>;i = edge[i].next)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">int</span> v = edge[i].to;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(v == fa[u])<span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">			fa[v] = u;</span><br><span class="line"></span><br><span class="line">			node[v]-&gt;fa = node[u];</span><br><span class="line"></span><br><span class="line">			g[++r] = v;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("big1.in","r",stdin);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("out1.txt","w",stdout);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> n,m;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</span><br><span class="line"></span><br><span class="line">	assert(T &gt; <span class="number">0</span> &amp;&amp; T &lt;= <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(T--)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line"></span><br><span class="line">		<span class="comment">//assert(n &gt; 0 &amp;&amp; n &lt;= 50000);</span></span><br><span class="line"></span><br><span class="line">		tail = pool;</span><br><span class="line"></span><br><span class="line">		null = tail++;</span><br><span class="line"></span><br><span class="line">		null-&gt;fa = null-&gt;ch[<span class="number">0</span>] = null-&gt;ch[<span class="number">1</span>] = null;</span><br><span class="line"></span><br><span class="line">		null-&gt;Max = -INF;</span><br><span class="line"></span><br><span class="line">		null-&gt;Min = INF;</span><br><span class="line"></span><br><span class="line">		null-&gt;mm = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		null-&gt;add = null-&gt;rev = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> w;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;w);</span><br><span class="line"></span><br><span class="line">			<span class="comment">//assert(w &gt; 0 &amp;&amp; w &lt;= 10000);</span></span><br><span class="line"></span><br><span class="line">			node[i] = tail++;</span><br><span class="line"></span><br><span class="line">			node[i]-&gt;clear(w);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		init();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> u,v;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; n;i++)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;u,&amp;v);</span><br><span class="line"></span><br><span class="line">			addedge(u,v);</span><br><span class="line"></span><br><span class="line">			addedge(v,u);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		bfs(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;m);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span>(m--)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;u,&amp;v,&amp;w);</span><br><span class="line"></span><br><span class="line">			<span class="comment">//assert(u &gt;= 1 &amp;&amp; u &lt;= n &amp;&amp; v &gt;= 1 &amp;&amp; v &lt;= n);</span></span><br><span class="line"></span><br><span class="line">			<span class="comment">//assert(w &gt; 0 &amp;&amp; w &lt;= 10000);</span></span><br><span class="line"></span><br><span class="line">			node[u]-&gt;make_root();</span><br><span class="line"></span><br><span class="line">			node[v]-&gt;access();</span><br><span class="line"></span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,node[v]-&gt;mm);</span><br><span class="line"></span><br><span class="line">			node[v]-&gt;update_add(w);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<pre><code>1012： [HDU5053](http://acm.hdu.edu.cn/showproblem.php?pid=5053) 签到题！
</code></pre><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ***************</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Author        :kuangbin</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Created Time  :2014/9/27 10:51:53</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">File Name     :E:\2014ACM\题目_上海网络赛\cube\标程\L.cpp</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">************************************************ */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("L.in","r",stdin);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("L.out","w",stdout);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> iCase = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">long</span> <span class="keyword">long</span> a,b;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(T--)&#123;</span><br><span class="line"></span><br><span class="line">		iCase++;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%I64d%I64d"</span>,&amp;a,&amp;b);</span><br><span class="line"></span><br><span class="line">		a--;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">long</span> <span class="keyword">long</span> ans = (b(b+<span class="number">1</span>)/<span class="number">2</span>)(b(b+<span class="number">1</span>)/<span class="number">2</span>) - (a(a+<span class="number">1</span>)/<span class="number">2</span>)(a(a+<span class="number">1</span>)/<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"Case #%d: %I64d\n"</span>,iCase,ans);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<pre><code>再次为两次Rejudge深表歉意！
</code></pre>
          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/09/26/hdu4918/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/09/26/hdu4918/" itemprop="url">
                  HDU 4918 Query on the subtree （树分治）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-09-26 15:45:18" itemprop="dateCreated datePublished" datetime="2014-09-26T15:45:18+08:00">2014-09-26</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 13:43:28" itemprop="dateModified" datetime="2018-07-29T13:43:28+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/" itemprop="url" rel="index"><span itemprop="name">HDU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/数据结构/" itemprop="url" rel="index"><span itemprop="name">数据结构</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/数据结构/树分治/" itemprop="url" rel="index"><span itemprop="name">树分治</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/数据结构/树分治/树状数组/" itemprop="url" rel="index"><span itemprop="name">树状数组</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/数据结构/树分治/树状数组/算法/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=4918" target="_blank" rel="noopener">HDU4918</a> 经典的树分治的题目。 进行点分治。 题意： 给一颗树，每个点有权值。 两种操作： 一种是把某个点的权值改为v. 一种是查询距离u不超过d的权值和。   树分治结合树状数组去搞。 树分治的关键就是每个点最多被logn个点更新到。 这样的话，就很容易搞了、</p>
<h1 id="Query-on-the-subtree"><a href="#Query-on-the-subtree" class="headerlink" title="Query on the subtree"></a>Query on the subtree</h1><p><strong>Time Limit: 16000/8000 MS (Java/Others)    Memory Limit: 131072/131072 K (Java/Others) Total Submission(s): 320    Accepted Submission(s): 109</strong></p>
<p>Problem Description</p>
<p>bobo has a tree, whose vertices are conveniently labeled by 1,2,…,n. At the very begining, the i-th vertex is assigned with weight wi.There are q operations. Each operations are of the following 2 types: Change the weight of vertex v into x (denoted as “! v x”), Ask the total weight of vertices whose distance are no more than d away from vertex v (denoted as “? v d”). Note that the distance between vertex u and v is the number of edges on the shortest path between them.</p>
<p>Input</p>
<p>The input consists of several tests. For each tests:The first line contains n,q (1≤n,q≤105). The second line contains n integers w1,w2,…,wn (0≤wi≤104). Each of the following (n - 1) lines contain 2 integers ai,bidenoting an edge between vertices ai and bi (1≤ai,bi≤n). Each of the following q lines contain the operations (1≤v≤n,0≤x≤104,0≤d≤n).</p>
<p>Output</p>
<p>For each tests:For each queries, a single number denotes the total weight.</p>
<p>Sample Input</p>
<p>4 3 1 1 1 1 1 2 2 3 3 4 ? 2 1 ! 1 0 ? 2 1 3 3 1 2 3 1 2 1 3 ? 1 0 ? 1 1 ? 1 2</p>
<p>Sample Output</p>
<p>3 2 1 6 6</p>
<p>Author</p>
<p>Xiaoxu Guo (ftiasch)</p>
<p>Source</p>
<p><a href="http://acm.hdu.edu.cn/search.php?field=problem&amp;key=2014+Multi-University+Training+Contest+5&amp;source=1&amp;searchmode=source" target="_blank" rel="noopener">2014 Multi-University Training Contest 5</a></p>
<p>/* <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>***</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><br>Author        :kuangbin<br>Created Time  :2014/9/25 23:04:05<br>File Name     :E:\2014ACM\专题学习\树分治\HDU4918.cpp<br>************************************************ */</p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;string.h&gt;</p>
<p>#include <iostream></iostream></p>
<p>#include <algorithm></algorithm></p>
<p>#include <vector></vector></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include <map></map></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;</p>
<p>#include &lt;stdlib.h&gt;</p>
<p>#include &lt;time.h&gt;<br>using namespace std;<br>const int MAXN = 100010;<br>const int MAXD = 40;<br>int cc[MAXN<em>MAXD];<br>int </em>cc_tail; //记得初始化cc_tail = cc<br>//0-based BinaryIndexTree<br>struct BIT{<br>    int <em>c;<br>    int n;<br>    void init(int _n){<br>        n = _n;<br>        c = cc_tail;<br>        cc_tail = cc_tail + n;<br>        memset(c,0,sizeof(int)</em>n);<br>    }<br>    void add(int i,int val){<br>        while(i &lt; n){<br>            c[i] += val;<br>            i += ~i &amp; i+1;<br>        }<br>    }<br>    int sum(int i){<br>        i = min(i,n-1);<br>        int s = 0;<br>        while(i &gt;= 0){<br>            s += c[i];<br>            i -= ~i &amp; i+1;<br>        }<br>        return s;<br>    }<br>}bits[MAXN&lt;&lt;1];<br>struct Edge{<br>    int to,next;<br>}edge[MAXN*2];<br>int head[MAXN],tot;<br>void init(){<br>    tot = 0;<br>    memset(head,-1,sizeof(head));<br>}<br>inline void addedge(int u,int v){<br>    edge[tot].to = v;<br>    edge[tot].next = head[u];<br>    head[u] = tot++;<br>}<br>int size[MAXN],vis[MAXN],fa[MAXN],que[MAXN];<br>int TT;<br>inline int getroot(int u,int &amp;tot){<br>    int Min = MAXN, root = 0;<br>    int l,r;<br>    que[l = r = 1] = u;<br>    fa[u] = 0;<br>    for(;l &lt;= r;l++)<br>        for(int i = head[que[l]];i != -1;i = edge[i].next){<br>            int v = edge[i].to;<br>            if(v == fa[que[l]] || vis[v] == TT)continue;<br>            que[++r] = v;<br>            fa[v] = que[l];<br>        }<br>    tot = r;<br>    for(l–;l;l–){<br>        int x = que[l], Max = 0;<br>        size[x] = 1;<br>        for(int i = head[x];i != -1;i = edge[i].next){<br>            int v = edge[i].to;<br>            if(v == fa[x] || vis[v] == TT)continue;<br>            Max = max(Max,size[v]);<br>            size[x] += size[v];<br>        }<br>        Max = max(Max,r - size[x]);<br>        if(Max &lt; Min){<br>            Min = Max, root = x;<br>        }<br>    }<br>    return root;<br>}<br>struct Node{<br>    int root,subtree,dis;<br>    Node(int _root = 0, int _subtree = 0,int _dis = 0){<br>        root = _root;<br>        subtree = _subtree;<br>        dis = _dis;<br>    }<br>};<br>vector<node>vec[MAXN];<br>int id[MAXN];<br>int dist[MAXN];<br>int val[MAXN];<br>int cnt;<br>inline void go(int u,int root,int subtree){<br>    int l,r;<br>    que[l = r = 1] = u;<br>    fa[u] = 0; dist[u] = 1;<br>    for(; l &lt;= r;l++){<br>        u = que[l];<br>        vec[u].push_back(Node(id[root],subtree,dist[u]));<br>        for(int i = head[u];i != -1;i = edge[i].next){<br>            int v = edge[i].to;<br>            if(v == fa[u] || vis[v] == TT)continue;<br>            que[++r] = v;<br>            fa[v] = u;<br>            dist[v] = dist[u] + 1;<br>        }<br>    }<br>    bits[subtree].init(r+1);<br>    for(int i = 1;i &lt;= r;i++){<br>        u = que[i];<br>        bits[id[root]].add(dist[u],val[u]);<br>        bits[subtree].add(dist[u],val[u]);<br>    }<br>}<br>void solve(int u){<br>    int tot;<br>    int root = getroot(u,tot);<br>    vis[root] = TT;<br>    id[root] = cnt++;<br>    vec[root].push_back(Node(id[root],-1,0));<br>    bits[id[root]].init(tot);<br>    bits[id[root]].add(0,val[root]);<br>    for(int i = head[root];i != -1;i = edge[i].next){<br>        int v = edge[i].to;<br>        if(vis[v] == TT)continue;<br>        go(v,root,cnt);<br>        cnt++;<br>    }<br>    for(int i = head[root];i != -1;i = edge[i].next){<br>        int v = edge[i].to;<br>        if(vis[v] == TT)continue;<br>        solve(v);<br>    }<br>}<br>int main()<br>{<br>    //freopen(“in.txt”,”r”,stdin);<br>    //freopen(“out.txt”,”w”,stdout);<br>    int n,m;<br>    memset(vis,0,sizeof(vis));<br>    TT = 0;<br>    while(scanf(“%d%d”,&amp;n,&amp;m) == 2){<br>        init();<br>        TT++;<br>        cc_tail = cc;<br>        cnt = 0;<br>        for(int i = 1;i &lt;= n;i++)vec[i].clear();<br>        for(int i = 1;i &lt;= n;i++)scanf(“%d”,&amp;val[i]);<br>        int u,v;<br>        for(int i = 1;i &lt; n;i++){<br>            scanf(“%d%d”,&amp;u,&amp;v);<br>            addedge(u,v);<br>            addedge(v,u);<br>        }<br>        solve(1);<br>        char op[10];<br>        int d;<br>        while(m–){<br>            scanf(“%s%d%d”,op,&amp;u,&amp;d);<br>            if(op[0] == ‘!’){<br>                int dv = d - val[u];<br>                int sz = vec[u].size();<br>                for(int i = 0;i &lt; sz;i++){<br>                    Node tmp = vec[u][i];<br>                    bits[tmp.root].add(tmp.dis,dv);<br>                    if(tmp.subtree != -1)<br>                        bits[tmp.subtree].add(tmp.dis,dv);<br>                }<br>                val[u] += dv;<br>            }<br>            else {<br>                int ans = 0;<br>                int sz = vec[u].size();<br>                for(int i = 0;i &lt; sz;i++){<br>                    Node tmp = vec[u][i];<br>                    ans += bits[tmp.root].sum(d-tmp.dis);<br>                    if(tmp.subtree != -1)<br>                        ans -= bits[tmp.subtree].sum(d-tmp.dis);<br>                }<br>                printf(“%d\n”,ans);<br>            }<br>        }<br>    }<br>    return 0;<br>}</node></p>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/09/23/hdu4641/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/09/23/hdu4641/" itemprop="url">
                  HDU 4641 K-string （SAM）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-09-23 23:03:21" itemprop="dateCreated datePublished" datetime="2014-09-23T23:03:21+08:00">2014-09-23</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 20:56:15" itemprop="dateModified" datetime="2018-07-29T20:56:15+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/" itemprop="url" rel="index"><span itemprop="name">HDU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/算法/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/后缀自动机/" itemprop="url" rel="index"><span itemprop="name">后缀自动机</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=4641" target="_blank" rel="noopener">HDU4641</a>   因为需要一个在线的算法！ 明显可以用后缀自动机搞。 每个一个字符，就统计下每个点出现的次数，从而更新答案。   后面自动机沿着 fa 指针往前跳，可以找到所有后缀，累加值。</p>
<h1 id="K-string"><a href="#K-string" class="headerlink" title="K-string"></a>K-string</h1><p><strong>Time Limit: 4000/2000 MS (Java/Others)    Memory Limit: 102400/131072 K (Java/Others) Total Submission(s): 535    Accepted Submission(s): 175</strong></p>
<p>Problem Description</p>
<p>Given a string S. K-string is the sub-string of S and it appear in the S at least K times.It means there are at least K different pairs (i,j) so that Si,Si+1… Sj equal to this K-string. Given m operator or query:1.add a letter to the end of S; 2.query how many different K-string currently.For each query ,count the number of different K-string currently.</p>
<p>Input</p>
<p>The input consists of multiple test cases. Each test case begins with a line containing three integers n, m and K(1&lt;=n,K&lt;=50000,1&lt;=m&lt;=200000), denoting the length of string S, the number of operator or question and the least number of occurrences of K-string in the S. The second line consists string S,which only contains lowercase letters. The next m lines describe the operator or query.The description of the operator looks as two space-separated integers t c (t = 1; c is lowercase letter).The description of the query looks as one integer t (t = 2).</p>
<p>Output</p>
<p>For each query print an integer — the number of different K-string currently.</p>
<p>Sample Input</p>
<p>3 5 2 abc 2 1 a 2 1 a 2</p>
<p>Sample Output</p>
<p>0 1 1</p>
<p>Source</p>
<p><a href="http://acm.hdu.edu.cn/search.php?field=problem&amp;key=2013+Multi-University+Training+Contest+4&amp;source=1&amp;searchmode=source" target="_blank" rel="noopener">2013 Multi-University Training Contest 4</a></p>
<pre><code>写起来还是很简单的，主要是要加深对SAM的理解。
</code></pre><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ***************</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Author        :kuangbin</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Created Time  :2014/9/23 22:37:26</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">File Name     :E:\2014ACM\专题学习\后缀自动机\HDU4641.cpp</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">************************************************ */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">250010</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> CHAR = <span class="number">26</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SAM_Node</span>&#123;</span></span><br><span class="line"></span><br><span class="line">	SAM_Node *fa,*next[CHAR];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> len;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> cnt;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		fa = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">memset</span>(next,<span class="number">0</span>,<span class="keyword">sizeof</span>(next));</span><br><span class="line"></span><br><span class="line">		cnt = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;pool[MAXN*<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">SAM_Node *root,*tail;</span><br><span class="line"></span><br><span class="line"><span class="function">SAM_Node* <span class="title">newnode</span><span class="params">(<span class="keyword">int</span> len)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	SAM_Node* cur = tail++;</span><br><span class="line"></span><br><span class="line">	cur-&gt;clear();</span><br><span class="line"></span><br><span class="line">	cur-&gt;len = len;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> cur;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SAM_init</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	tail = pool;</span><br><span class="line"></span><br><span class="line">	root = newnode(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">SAM_Node* <span class="title">extend</span><span class="params">(SAM_Node* last,<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	SAM_Node *p = last, *np = newnode(p-&gt;len+<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(p &amp;&amp; !p-&gt;next[x])</span><br><span class="line"></span><br><span class="line">		p-&gt;next[x] = np, p = p-&gt;fa;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(!p)np-&gt;fa = root;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">		SAM_Node* q = p-&gt;next[x];</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(q-&gt;len == p-&gt;len+<span class="number">1</span>)np-&gt;fa = q;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">			SAM_Node* nq = newnode(p-&gt;len+<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">			<span class="built_in">memcpy</span>(nq-&gt;next,q-&gt;next,<span class="keyword">sizeof</span>(q-&gt;next));</span><br><span class="line"></span><br><span class="line">			nq-&gt;fa = q-&gt;fa;</span><br><span class="line"></span><br><span class="line">			nq-&gt;cnt = q-&gt;cnt;</span><br><span class="line"></span><br><span class="line">			q-&gt;fa = np-&gt;fa = nq;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">while</span>(p &amp;&amp; p-&gt;next[x] == q)</span><br><span class="line"></span><br><span class="line">				p-&gt;next[x] = nq, p = p-&gt;fa;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> np;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> K;</span><br><span class="line"></span><br><span class="line">SAM_Node *last;</span><br><span class="line"></span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	SAM_Node *p = last;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(p &amp;&amp; p-&gt;cnt &lt; K)&#123;</span><br><span class="line"></span><br><span class="line">		p-&gt;cnt++;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(p-&gt;cnt &gt;= K)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(p-&gt;fa)</span><br><span class="line"></span><br><span class="line">				ans += p-&gt;len - p-&gt;fa-&gt;len;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		p = p-&gt;fa;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> str[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> n,m;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;n,&amp;m,&amp;K) == <span class="number">3</span>)&#123;</span><br><span class="line"></span><br><span class="line">		SAM_init();</span><br><span class="line"></span><br><span class="line">		last = root;</span><br><span class="line"></span><br><span class="line">		ans = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>,str);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> len = <span class="built_in">strlen</span>(str);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++)&#123;</span><br><span class="line"></span><br><span class="line">			last = extend(last,str[i]-<span class="string">'a'</span>);</span><br><span class="line"></span><br><span class="line">			calc();</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> op;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span>(m--)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;op);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(op == <span class="number">2</span>)<span class="built_in">printf</span>(<span class="string">"%I64d\n"</span>,ans);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">				<span class="built_in">scanf</span>(<span class="string">"%s"</span>,str);</span><br><span class="line"></span><br><span class="line">				last = extend(last,str[<span class="number">0</span>]-<span class="string">'a'</span>);</span><br><span class="line"></span><br><span class="line">				calc();</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/09/23/hdu5016/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/09/23/hdu5016/" itemprop="url">
                  HDU 5016 Mart Master II （树分治）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-09-23 12:42:31" itemprop="dateCreated datePublished" datetime="2014-09-23T12:42:31+08:00">2014-09-23</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 13:43:28" itemprop="dateModified" datetime="2018-07-29T13:43:28+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/" itemprop="url" rel="index"><span itemprop="name">HDU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/树分治/" itemprop="url" rel="index"><span itemprop="name">树分治</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/树分治/算法/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5016" target="_blank" rel="noopener">HDU5016</a>   树分治。 题意就是要找一个点，使得可以占领的点最多。</p>
<h1 id="Mart-Master-II"><a href="#Mart-Master-II" class="headerlink" title="Mart Master II"></a>Mart Master II</h1><p><strong>Time Limit: 12000/6000 MS (Java/Others)    Memory Limit: 65536/65536 K (Java/Others) Total Submission(s): 156    Accepted Submission(s): 58</strong></p>
<p>Problem Description</p>
<p>Trader Dogy lives in city S, which consists of n districts. There are n - 1 bidirectional roads in city S, each connects a pair of districts. Indeed, city S is connected, i.e. people can travel between every pair of districts by roads. In some districts there are marts founded by Dogy’s competitors. when people go to marts, they’ll choose the nearest one. In cases there are more than one nearest marts, they’ll choose the one with minimal city number. Dogy’s money could support him to build only <strong>one</strong> new marts, he wants to attract as many people as possible, that is, to build his marts in some way that maximize the number of people who will choose his mart as favorite. Could you help him?</p>
<p>Input</p>
<p>There are multiple test cases. Please process till EOF. In each test case: First line: an integer n indicating the number of districts. Next n - 1 lines: each contains three numbers bi, ei and wi, (1 ≤ bi,ei ≤ n,1 ≤ wi ≤ 10000), indicates that there’s one road connecting city bi and ei, and its length is wi. Last line : n(1 ≤ n ≤ 105) numbers, each number is either 0 or 1, i-th number is 1 indicates that the i-th district has mart in the beginning and vice versa.</p>
<p>Output</p>
<p>For each test case, output one number, denotes the number of people you can attract, taking district as a unit.</p>
<p>Sample Input</p>
<p>5 1 2 1 2 3 1 3 4 1 4 5 1 1 0 0 0 1 5 1 2 1 2 3 1 3 4 1 4 5 1 1 0 0 0 0 1 1 1 0</p>
<p>Sample Output</p>
<p>2 4 0 1</p>
<p>Source</p>
<p><a href="http://acm.hdu.edu.cn/search.php?field=problem&amp;key=2014+ACM%2FICPC+Asia+Regional+Xi%27an+Online&amp;source=1&amp;searchmode=source" target="_blank" rel="noopener">2014 ACM/ICPC Asia Regional Xi’an Online</a></p>
<p>  找到树根。 在一颗子树的，进行分治处理。 然后不在一颗子树的， 要经过树根。 就是 dis[A] + dis[B] &lt; WW[B]. 这样A就是可以统治B的。</p>
<p>/* <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>***</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><br>Author        :kuangbin<br>Created Time  :2014/9/23 11:40:11<br>File Name     :E:\2014ACM\专题学习\树分治\HDU5016.cpp<br>************************************************ */</p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;string.h&gt;</p>
<p>#include <iostream></iostream></p>
<p>#include <algorithm></algorithm></p>
<p>#include <vector></vector></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include <map></map></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;</p>
<p>#include &lt;stdlib.h&gt;</p>
<p>#include &lt;time.h&gt;<br>using namespace std;<br>const int MAXN = 100010;<br>const int INF = 0x3f3f3f3f;<br>struct Edge{<br>    int to,next,w;<br>}edge[MAXN*2];<br>int head[MAXN],tot;<br>void init(){<br>    tot = 0;<br>    memset(head,-1,sizeof(head));<br>}<br>inline void addedge(int u,int v,int w){<br>    edge[tot].to = v;<br>    edge[tot].w = w;<br>    edge[tot].next = head[u];<br>    head[u] = tot++;<br>}<br>int size[MAXN],vis[MAXN],fa[MAXN],que[MAXN];<br>int TT;//时间戳<br>//找重心<br>inline int getroot(int u){<br>    int Min = MAXN, root = 0;<br>    int l,r;<br>    que[l = r = 1] = u;<br>    fa[u] = 0;<br>    for(;l &lt;= r;l++)<br>        for(int i = head[que[l]]; i != -1;i = edge[i].next){<br>            int v = edge[i].to;<br>            if(v == fa[que[l]] || vis[v] == TT)continue;<br>            que[++r] = v;<br>            fa[v] = que[l];<br>        }<br>    for(l–;l;l–){<br>        int x = que[l], Max = 0;<br>        size[x] = 1;<br>        for(int i = head[x];i != -1;i = edge[i].next){<br>            int v = edge[i].to;<br>            if(v == fa[x] || vis[v] == TT)continue;<br>            Max = max(Max,size[v]);<br>            size[x] += size[v];<br>        }<br>        Max = max(Max,r - size[x]);<br>        if(Max &lt; Min){<br>            Min = Max; root = x;<br>        }<br>    }<br>    return root;<br>}</p>
<p>int ans[MAXN];<br>pair&lt;int,int&gt;pp[MAXN];<br>pair&lt;int,int&gt;np[MAXN];<br>int dis[MAXN];<br>int type[MAXN];<br>inline void go(int u,int pre,int w,int tt){<br>    int l,r;<br>    que[l = r = 1] = u;<br>    fa[u] = pre; dis[u] = w;<br>    for(;l &lt;= r;l++)<br>        for(int i = head[que[l]];i != -1;i = edge[i].next){<br>            int v = edge[i].to;<br>            if(v == fa[que[l]] || vis[v] == TT)continue;<br>            que[++r] = v;<br>            fa[v] = que[l];<br>            dis[v] = dis[que[l]] + edge[i].w;<br>        }<br>    int cnt = 0;<br>    for(int i = 1;i &lt;= r;i++){<br>        int x = que[i];<br>        pp[cnt++] = make_pair(np[x].first-dis[x],np[x].second);<br>    }<br>    sort(pp,pp+cnt);<br>    for(int i = 1;i &lt;= r;i++){<br>        int x = que[i];<br>        if(type[x])continue;<br>        int id = lower_bound(pp,pp+cnt,make_pair(dis[x],x)) - pp;<br>        ans[x] += (cnt-id)*tt;<br>    }<br>}<br>void solve(int u){<br>    int root = getroot(u);<br>    vis[root] = TT;<br>    go(root,0,0,1);<br>    for(int i = head[root];i != -1;i = edge[i].next){<br>        int v = edge[i].to;<br>        if(vis[v] == TT)continue;<br>        go(v,root,edge[i].w,-1);<br>    }<br>    for(int i = head[root];i != -1;i = edge[i].next){<br>        int v = edge[i].to;<br>        if(vis[v] == TT)continue;<br>        solve(v);<br>    }<br>}<br>bool ff[MAXN];<br>int main()<br>{<br>    //freopen(“in.txt”,”r”,stdin);<br>    //freopen(“out.txt”,”w”,stdout);<br>    int n;<br>    memset(vis,0,sizeof(vis));<br>    TT = 0;<br>    while(scanf(“%d”,&amp;n) == 1){<br>        init();<br>        int u,v,w;<br>        for(int i = 1;i &lt; n;i++){<br>            scanf(“%d%d%d”,&amp;u,&amp;v,&amp;w);<br>            addedge(u,v,w);<br>            addedge(v,u,w);<br>        }<br>        for(int i = 1;i &lt;= n;i++)scanf(“%d”,&amp;type[i]);<br>        queue<int>q;<br>        for(int i = 1;i &lt;= n;i++){<br>            if(type[i]){<br>                np[i] = make_pair(0,i);<br>                ff[i] = true;<br>                q.push(i);<br>            }<br>            else{<br>                np[i] = make_pair(INF,0);<br>                ff[i] = false;<br>            }<br>        }<br>        while(!q.empty()){<br>            u = q.front();<br>            q.pop();<br>            ff[u] = false;<br>            for(int i = head[u];i != -1;i = edge[i].next){<br>                v = edge[i].to;<br>                pair&lt;int,int&gt;tmp = make_pair(np[u].first+edge[i].w,np[u].second);<br>                if(tmp &lt; np[v]){<br>                    np[v] = tmp;<br>                    if(!ff[v]){<br>                        ff[v] = true;<br>                        q.push(v);<br>                    }<br>                }<br>            }<br>        }<br>        TT++;<br>        for(int i = 1;i &lt;= n;i++)ans[i] = 0;<br>        solve(1);<br>        int ret = 0;<br>        for(int i = 1;i &lt;= n;i++)ret = max(ret,ans[i]);<br>        printf(“%d\n”,ret);<br>    }<br>    return 0;<br>}</int></p>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/09/22/hdu5039/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/09/22/hdu5039/" itemprop="url">
                  HDU 5039 Hilarity （链分治）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-09-22 23:15:21" itemprop="dateCreated datePublished" datetime="2014-09-22T23:15:21+08:00">2014-09-22</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 13:43:28" itemprop="dateModified" datetime="2018-07-29T13:43:28+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/" itemprop="url" rel="index"><span itemprop="name">HDU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/树分治/" itemprop="url" rel="index"><span itemprop="name">树分治</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/树分治/算法/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5039" target="_blank" rel="noopener">HDU5039</a>   水题当成神题做了。 明显这题直接用线段树去搞就可以的。   但是比赛时候想出来的用树链剖分的写法，把代码修正下就过了。 关于做法，可以参考QTREE4的树链剖分做法。 可以看漆子超<a href="http://wenku.baidu.com/link?url=oVTqJppSNbvT-Q5Kp0fdeLnqQjJ3AP8ogVTLwZX-gcc0aJdnLmUAccvZQs73en0v8cq__ceX6usDkBSCYXEuSkKtV7_2a2k-OEYfqVwyqBe" target="_blank" rel="noopener">论文</a> 里面关于QTREE4的树链剖分做法还是比较详细的。   其实就是把树分成一条一条链。  然后每条链使用线段树去维护，因为需要修改单点，查询。   修改的时候，最多变化logn条链。   这题的话，  维护单挑链的值，一个是 l0表示到左端点经过偶数条1边的点数，l1表示左端点经过奇数条1边的点数。 r0,r1类似。 然后sum是需要求的点数。   这种做法虽然比较烦，但是思想还是很好的。      </p>
<h1 id="Hilarity"><a href="#Hilarity" class="headerlink" title="Hilarity"></a>Hilarity</h1><p><strong>Time Limit: 12000/6000 MS (Java/Others)    Memory Limit: 262144/262144 K (Java/Others) Total Submission(s): 165    Accepted Submission(s): 32</strong></p>
<p>Problem Description</p>
<p>After June 1st, elementary students of Ted Land are still celebrating “The Sacred Day of Elementary Students”. They go to the streets and do some elementary students stuff. So we call them “elementary students”. There are N cities in Ted Land. But for simplicity, the mayor Matt only built N - 1 roads so that all cities can reach each other. Some of the roads are occupied by the “elementary students”. They will put an celebration hat on everyone who goes through the road without one. But if someone goes through the road with a celebration hat on his head, “elementary students” will steal the hat for no reason. Since Matt doesn’t have a celebration hat, he wants to know how many different paths in his land that he can end up with a hat. Two paths are considered to be different if and only if they have different start city or end city. As the counsellor of the mayor Matt, you have to answer this question for him. The celebration elementary students are not stable: sometimes a new crowd of elementary students go to an empty road; sometimes the elementary students on a road will go back home and remain the road empty. Matt will send you the monitor about the change of elementary students on road and ask you the question above. You will be fired if you answer wrong.</p>
<p>Input</p>
<p>The first line of the input contains an integer T, denoting the number of testcases. Then T test cases follow. For each test case, the first line contains N (1&lt;=N&lt;=30000) describing the number of cities. Then N lines follow. The ith line of these contains the name of the ith city, it’s a string containing only letters and will not be longer than 10. The following N - 1 lines indicate the N - 1 edges between cities. Each of these lines will contain two strings for the cities’ name and a integer for the initial status of the edge (0 for empty, 1 for crowded). Then an integer M (1&lt;=M&lt;=60000) describes the number of queries. There are two kinds of query: ● “M i” means the status changing of the ith (starting from 1) road (0 to 1, 1 to 0); ● “Q” means that Matt asks you the number of different paths.</p>
<p>Output</p>
<p>For each test case, first output one line “Case #x:”, where x is the case number (starting from 1). Then for each “Q” in input, output a line with the answer.</p>
<p>Sample Input</p>
<p>1 5 a b c d e a b 1 b c 0 c d 1 d e 1 7 Q M 1 Q M 3 Q M 4 Q</p>
<p>Sample Output</p>
<p>Case #1: 12 8 8 0</p>
<p>Source</p>
<p><a href="http://acm.hdu.edu.cn/search.php?field=problem&amp;key=2014+ACM%2FICPC+Asia+Regional+Beijing+Online&amp;source=1&amp;searchmode=source" target="_blank" rel="noopener">2014 ACM/ICPC Asia Regional Beijing Online</a></p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include <algorithm></algorithm></p>
<p>#include <iostream></iostream></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include &lt;string.h&gt;</p>
<p>#include <map></map></p>
<p>#include <vector></vector></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;<br>using namespace std;<br>const int MAXN = 30010;<br>const int INF = 0x3f3f3f3f;<br>struct Edge{<br>    int to,next;<br>    int f;<br>}edge[MAXN<em>2];<br>int head[MAXN],tot;<br>void init(){<br>    tot = 0;<br>    memset(head,-1,sizeof(head));<br>}<br>void addedge(int u,int v,int f){<br>    edge[tot].to = v;<br>    edge[tot].next = head[u];<br>    edge[tot].f = f;<br>    head[u] = tot++;<br>}<br>long long ans;<br>int num0[MAXN],num1[MAXN];<br>long long tnum[MAXN];<br>struct Node{<br>    int l0,l1;<br>    int r0,r1;<br>    int cc;<br>    long long sum;<br>    Node gao(int u){<br>        l0 = r0 = num0[u];<br>        l1 = r1 = num1[u];<br>        sum = tnum[u];<br>        cc = 0;<br>        return </em>this;<br>    }<br>};<br>int pos[MAXN];<br>int val[MAXN];<br>int fa[MAXN];<br>int cnt[MAXN];<br>int col[MAXN];<br>int link[MAXN];<br>int CHANGEU;<br>struct chain{<br>    vector<int>uu;<br>    vector<node>nde;<br>    int n;<br>    void init(){<br>        n = uu.size();<br>        nde.resize(n &lt;&lt; 2);<br>        for(int i = 0;i &lt; n;i++)pos[uu[i]] = i;<br>        build(0,n-1,1);<br>    }<br>    void up(int l,int r,int p){<br>        int mid = (l+r)&gt;&gt;1;<br>        nde[p].cc = nde[p&lt;&lt;1].cc ^ nde[(p&lt;&lt;1)|1].cc ^ val[uu[mid]];<br>        nde[p].l0 = nde[p&lt;&lt;1].l0;<br>        nde[p].l1 = nde[p&lt;&lt;1].l1;<br>        if(nde[p&lt;&lt;1].cc^val[uu[mid]]){<br>            nde[p].l0 += nde[(p&lt;&lt;1)|1].l1;<br>            nde[p].l1 += nde[(p&lt;&lt;1)|1].l0;<br>        }<br>        else {<br>            nde[p].l0 += nde[(p&lt;&lt;1)|1].l0;<br>            nde[p].l1 += nde[(p&lt;&lt;1)|1].l1;<br>        }<br>        nde[p].r0 = nde[(p&lt;&lt;1)|1].r0;<br>        nde[p].r1 = nde[(p&lt;&lt;1)|1].r1;<br>        if(nde[(p&lt;&lt;1)|1].cc^val[uu[mid]]){<br>            nde[p].r0 += nde[p&lt;&lt;1].r1;<br>            nde[p].r1 += nde[p&lt;&lt;1].r0;<br>        }<br>        else {<br>            nde[p].r0 += nde[p&lt;&lt;1].r0;<br>            nde[p].r1 += nde[p&lt;&lt;1].r1;<br>        }<br>        if(val[uu[mid]] == 0){<br>            nde[p].sum = nde[p&lt;&lt;1].sum + nde[(p&lt;&lt;1)|1].sum +<br>                (long long)nde[p&lt;&lt;1].r0<em>nde[(p&lt;&lt;1)|1].l1 +<br>                (long long)nde[p&lt;&lt;1].r1</em>nde[(p&lt;&lt;1)|1].l0;<br>        }<br>        else {<br>            nde[p].sum = nde[p&lt;&lt;1].sum + nde[(p&lt;&lt;1)|1].sum +<br>                (long long)nde[p&lt;&lt;1].r0<em>nde[(p&lt;&lt;1)|1].l0 +<br>                (long long)nde[p&lt;&lt;1].r1</em>nde[(p&lt;&lt;1)|1].l1;<br>        }<br>    }<br>    void build(int l,int r,int p){<br>        if(l == r){<br>            nde[p].gao(uu[l]);<br>            return;<br>        }<br>        int mid = (l+r)/2;<br>        build(l,mid,p&lt;&lt;1);<br>        build(mid+1,r,(p&lt;&lt;1)|1);<br>        up(l,r,p);<br>    }<br>    void update(int k,int l,int r,int p){<br>        if(l == r){<br>            nde[p].gao(uu[k]);<br>            return;<br>        }<br>        int mid = (l+r)/2;<br>        if(k &lt;= mid)update(k,l,mid,p&lt;&lt;1);<br>        else update(k,mid+1,r,(p&lt;&lt;1)|1);<br>        up(l,r,p);<br>    }<br>    int change(int y){<br>        int x = uu.back();<br>        int p = fa[x];<br>        if(p){<br>            if(x == CHANGEU)val[x] ^= 1;<br>            if(val[x]){<br>                tnum[p] -= (long long)nde[1].r0<em>(num0[p]-nde[1].r1);<br>                tnum[p] -= (long long)nde[1].r1</em>(num1[p]-nde[1].r0);<br>                num0[p] -= nde[1].r1;<br>                num1[p] -= nde[1].r0;<br>            }<br>            else {<br>                tnum[p] -= (long long)nde[1].r1<em>(num0[p]-nde[1].r0);<br>                tnum[p] -= (long long)nde[1].r0</em>(num1[p]-nde[1].r1);<br>                num0[p] -= nde[1].r0;<br>                num1[p] -= nde[1].r1;<br>            }<br>            if(x == CHANGEU)val[x] ^= 1;<br>        }<br>        ans -= nde[1].sum;<br>        update(pos[y],0,n-1,1);<br>        if(p){<br>            if(val[x]){<br>                tnum[p] += (long long)nde[1].r0<em>num0[p];<br>                tnum[p] += (long long)nde[1].r1</em>num1[p];<br>                num0[p] += nde[1].r1;<br>                num1[p] += nde[1].r0;<br>            }<br>            else {<br>                tnum[p] += (long long)nde[1].r0<em>num1[p];<br>                tnum[p] += (long long)nde[1].r1</em>num0[p];<br>                num0[p] += nde[1].r0;<br>                num1[p] += nde[1].r1;<br>            }<br>        }<br>        ans += nde[1].sum;<br>        return p;<br>    }<br>}ch[MAXN];<br>void dfs1(int u,int pre){<br>    chain &amp;c = ch[u];<br>    c.uu.clear();<br>    int v, x = 0;<br>    cnt[u] = 1;<br>    for(int i = head[u];i != -1;i = edge[i].next){<br>        v = edge[i].to;<br>        if(v == pre)continue;<br>        dfs1(v,u);<br>        link[i/2] = v;<br>        val[v] = edge[i].f;<br>        cnt[u] += cnt[v];<br>        fa[v] = u;<br>        if(cnt[v] &gt; cnt[x]) x = v;<br>    }<br>    if(!x)col[u] = u;<br>    else col[u] = col[x];<br>    ch[col[u]].uu.push_back(u);<br>    num0[u] = 1;<br>    num1[u] = 0;<br>    tnum[u] = 0;</node></int></p>
<p>}<br>void dfs2(int x){<br>    x = col[x];<br>    chain &amp;c = ch[x];<br>    int n = c.uu.size();<br>    int u,v;<br>    for(int i = 1;i &lt; n;i++){<br>        u = c.uu[i];<br>        for(int j = head[u];j != -1;j = edge[j].next){<br>            v = edge[j].to;<br>            if(v == c.uu[i-1] || fa[u] == v)continue;<br>            dfs2(v);<br>            if(val[v]){<br>                tnum[u] += (long long)num0[u]*ch[col[v]].nde[1].r0 + (long long)num1[u]*ch[col[v]].nde[1].r1;<br>                num0[u] += ch[col[v]].nde[1].r1;<br>                num1[u] += ch[col[v]].nde[1].r0;<br>            }<br>            else {<br>                tnum[u] += (long long)num1[u]*ch[col[v]].nde[1].r0 + (long long)num0[u]*ch[col[v]].nde[1].r1;<br>                num0[u] += ch[col[v]].nde[1].r0;<br>                num1[u] += ch[col[v]].nde[1].r1;<br>            }<br>        }<br>    }<br>    c.init();<br>    ans += c.nde[1].sum;<br>}<br>char str[100];<br>char str1[100],str2[100];<br>int main()<br>{<br>    int T;<br>    int iCase = 0;<br>    scanf(“%d”,&amp;T);<br>    int n;<br>    while(T–){<br>        ans = 0;<br>        iCase++;<br>        scanf(“%d”,&amp;n);<br>        map&lt;string,int&gt;mp;<br>        init();<br>        for(int i = 1;i &lt;= n;i++){<br>            scanf(“%s”,str);<br>            mp[str] = i;<br>        }<br>        int u,v,f;<br>        for(int i = 1;i &lt; n;i++){<br>            scanf(“%s%s%d”,str1,str2,&amp;f);<br>            addedge(mp[str1],mp[str2],f);<br>            addedge(mp[str2],mp[str1],f);<br>        }<br>        int Q;<br>        char op[10];<br>        scanf(“%d”,&amp;Q);<br>        printf(“Case #%d:\n”,iCase);<br>        val[1] = 0;<br>        fa[1] = 0;<br>        dfs1(1,1);<br>        dfs2(1);<br>        while(Q–){<br>            scanf(“%s”,op);<br>            if(op[0] == ‘Q’){<br>                printf(“%I64d\n”,ans*2);<br>            }<br>            else {<br>                int id ;<br>                scanf(“%d”,&amp;id);<br>                id–;<br>                u = link[id];<br>                val[u] ^= 1;<br>                CHANGEU = u;<br>                while(u)<br>                    u = ch[col[u]].change(u);<br>            }<br>        }<br>    }<br>    return 0;<br>}</p>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/09/21/hdu5029/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/09/21/hdu5029/" itemprop="url">
                  HDU 5029 Relief grain （树链剖分+线段树）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-09-21 10:25:25" itemprop="dateCreated datePublished" datetime="2014-09-21T10:25:25+08:00">2014-09-21</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 13:43:28" itemprop="dateModified" datetime="2018-07-29T13:43:28+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/" itemprop="url" rel="index"><span itemprop="name">HDU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/树链剖分/" itemprop="url" rel="index"><span itemprop="name">树链剖分</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/树链剖分/线段树/" itemprop="url" rel="index"><span itemprop="name">线段树</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5029" target="_blank" rel="noopener">HDU5029</a> 题意很简单。 做法就是进行树链剖分，这样就可以把树形转线性。 然后对区间[l,r] 加z, 可以在l加一个z, 在r+1减掉一个 z.   最后按照fp数组进行扫描一遍，用线段树进行更新，找最大值。   水题！</p>
<h1 id="Relief-grain"><a href="#Relief-grain" class="headerlink" title="Relief grain"></a>Relief grain</h1><p><strong>Time Limit: 10000/5000 MS (Java/Others)    Memory Limit: 100000/100000 K (Java/Others) Total Submission(s): 237    Accepted Submission(s): 41</strong></p>
<p>Problem Description</p>
<p>The soil is cracking up because of the drought and the rabbit kingdom is facing a serious famine. The RRC(Rabbit Red Cross) organizes the distribution of relief grain in the disaster area. We can regard the kingdom as a tree with n nodes and each node stands for a village. The distribution of the relief grain is divided into m phases. For each phases, the RRC will choose a path of the tree and distribute some relief grain of a certain type for every village located in the path. There are many types of grains. The RRC wants to figure out which type of grain is distributed the most times in every village.</p>
<p>Input</p>
<p>The input consists of at most 25 test cases. For each test case, the first line contains two integer n and m indicating the number of villages and the number of phases. The following n-1 lines describe the tree. Each of the lines contains two integer x and y indicating that there is an edge between the x-th village and the y-th village. The following m lines describe the phases. Each line contains three integer x, y and z indicating that there is a distribution in the path from x-th village to y-th village with grain of type z. (1 &lt;= n &lt;= 100000, 0 &lt;= m &lt;= 100000, 1 &lt;= x &lt;= n, 1 &lt;= y &lt;= n, 1 &lt;= z &lt;= 100000) The input ends by n = 0 and m = 0.</p>
<p>Output</p>
<p>For each test case, output n integers. The i-th integer denotes the type that is distributed the most times in the i-th village. If there are multiple types which have the same times of distribution, output the minimal one. If there is no relief grain in a village, just output 0.</p>
<p>Sample Input</p>
<p>2 4 1 2 1 1 1 1 2 2 2 2 2 2 2 1 5 3 1 2 3 1 3 4 5 3 2 3 3 1 5 2 3 3 3 0 0</p>
<p>Sample Output</p>
<p>1 2 2 3 3 0 2</p>
<p><em>Hint</em></p>
<p>For the first test case, the relief grain in the 1st village is {1, 2}, and the relief grain in the 2nd village is {1, 2, 2}.</p>
<p>/* <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>***</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><br>Author        :kuangbin<br>Created Time  :2014/9/21 8:39:49<br>File Name     :HDU5029.cpp<br>************************************************ */</p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;string.h&gt;</p>
<p>#include <iostream></iostream></p>
<p>#include <algorithm></algorithm></p>
<p>#include <vector></vector></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include <map></map></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;</p>
<p>#include &lt;stdlib.h&gt;</p>
<p>#include &lt;time.h&gt;<br>using namespace std;<br>const int MAXN = 100010;<br>struct Edge{<br>    int to,next;<br>}edge[MAXN<em>2];<br>int head[MAXN],tot;<br>int top[MAXN];<br>int fa[MAXN];<br>int deep[MAXN];<br>int num[MAXN];<br>int p[MAXN];<br>int fp[MAXN];<br>int son[MAXN];<br>int pos;<br>void init(){<br>    tot = 0;<br>    memset(head,-1,sizeof(head));<br>    pos = 1;<br>    memset(son,-1,sizeof(son));<br>}<br>void addedge(int u,int v){<br>    edge[tot].to = v;<br>    edge[tot].next = head[u];<br>    head[u] = tot++;<br>}<br>void dfs1(int u,int pre,int d){<br>    deep[u] = d;<br>    fa[u] = pre;<br>    num[u] = 1;<br>    for(int i = head[u];i != -1;i = edge[i].next){<br>        int v = edge[i].to;<br>        if(v != pre){<br>            dfs1(v,u,d+1);<br>            num[u] += num[v];<br>            if(son[u] == -1 || num[v] &gt; num[son[u]])<br>                son[u] = v;<br>        }<br>    }<br>}<br>void getpos(int u,int sp){<br>    top[u] = sp;<br>    p[u] = pos++;<br>    fp[p[u]] = u;<br>    if(son[u] == -1)return;<br>    getpos(son[u],sp);<br>    for(int i = head[u];i != -1;i = edge[i].next){<br>        int v = edge[i].to;<br>        if(v != son[u] &amp;&amp; v != fa[u])<br>            getpos(v,v);<br>    }<br>}<br>vector<int>avec[MAXN],dvec[MAXN];<br>void change(int u,int v,int z){<br>    int f1 = top[u],f2 = top[v];<br>    int tmp = 0;<br>    while(f1 != f2){<br>        if(deep[f1] &lt; deep[f2]){<br>            swap(f1,f2);<br>            swap(u,v);<br>        }<br>        avec[p[f1]].push_back(z);<br>        dvec[p[u]+1].push_back(z);<br>        u = fa[f1];<br>        f1 = top[u];<br>    }<br>    if(deep[u] &gt; deep[v])swap(u,v);<br>    avec[p[u]].push_back(z);<br>    dvec[p[v]+1].push_back(z);<br>}<br>struct Node{<br>    int l,r;<br>    int Max,id;<br>    void output(){<br>        printf(“l %d r %d Max %d id %d\n”,l,r,Max,id);<br>    }<br>}segTree[MAXN&lt;&lt;2];<br>void debug(int i){<br>    segTree[i].output();<br>    if(segTree[i].l == segTree[i].r)return;<br>    debug(i&lt;&lt;1);<br>    debug((i&lt;&lt;1)|1);<br>}<br>void push_up(int i){<br>    if(segTree[i&lt;&lt;1].Max &lt; segTree[(i&lt;&lt;1)|1].Max){<br>        segTree[i].Max = segTree[(i&lt;&lt;1)|1].Max;<br>        segTree[i].id = segTree[(i&lt;&lt;1)|1].id;<br>    }<br>    else{<br>        segTree[i].Max = segTree[i&lt;&lt;1].Max;<br>        segTree[i].id = segTree[i&lt;&lt;1].id;<br>    }<br>}<br>void build(int i,int l,int r){<br>    segTree[i].l = l;<br>    segTree[i].r = r;<br>    if(l == r){<br>        segTree[i].id = l;<br>        segTree[i].Max = 0;<br>        return;<br>    }<br>    int mid = (l+r)/2;<br>    build(i&lt;&lt;1,l,mid);<br>    build((i&lt;&lt;1)|1,mid+1,r);<br>    push_up(i);<br>}<br>void update(int i,int k,int val){<br>    if(segTree[i].l == k &amp;&amp; segTree[i].r == k){<br>        segTree[i].Max += val;<br>        return;<br>    }<br>    int mid = (segTree[i].l+segTree[i].r)/2;<br>    if(k &lt;= mid)update(i&lt;&lt;1,k,val);<br>    else update((i&lt;&lt;1)|1,k,val);<br>    push_up(i);<br>}<br>int ans[MAXN];<br>int main()<br>{<br>    //freopen(“in.txt”,”r”,stdin);<br>    //freopen(“out.txt”,”w”,stdout);<br>    int n,m;<br>    while(scanf(“%d%d”,&amp;n,&amp;m) == 2){<br>        if(n == 0 &amp;&amp; m == 0)break;<br>        init();<br>        int u,v;<br>        for(int i = 1;i &lt; n;i++){<br>            scanf(“%d%d”,&amp;u,&amp;v);<br>            addedge(u,v);<br>            addedge(v,u);<br>        }<br>        dfs1(1,0,0);<br>        getpos(1,1);<br>        for(int i = 1;i &lt;= 100000;i++){<br>            avec[i].clear();<br>            dvec[i].clear();<br>        }<br>        int z;<br>        while(m–){<br>            scanf(“%d%d%d”,&amp;u,&amp;v,&amp;z);<br>            change(u,v,z);<br>        }<br>        build(1,1,100000);<br>        for(int i = 1;i &lt;= n;i++){<br>            //debug(1);<br>            //printf(“%d %d\n”,avec[i].size(),dvec[i].size());<br>            for(int j = 0;j &lt; avec[i].size();j++){<br>                update(1,avec[i][j],1);<br>                //printf(“%d </int></em>\n”,avec[i][j]);<br>            }<br>            for(int j = 0;j &lt; dvec[i].size();j++){<br>                update(1,dvec[i][j],-1);<br>                //printf(“%d **\n”,dvec[i][j]);<br>            }<br>            u = fp[i];<br>            //printf(“i  %d  %d\n”,i,fp[i]);<br>            if(segTree[1].Max == 0)ans[u] = 0;<br>            else ans[u] = segTree[1].id;<br>        }<br>        for(int i = 1;i &lt;= n;i++)<br>            printf(“%d\n”,ans[i]);<br>    }<br>    return 0;<br>}</p>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/09/15/hdu5015/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/09/15/hdu5015/" itemprop="url">
                  HDU 5015 233 Matrix （矩阵乘法）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-09-15 23:07:22" itemprop="dateCreated datePublished" datetime="2014-09-15T23:07:22+08:00">2014-09-15</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 13:43:28" itemprop="dateModified" datetime="2018-07-29T13:43:28+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/" itemprop="url" rel="index"><span itemprop="name">HDU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/矩阵乘法/" itemprop="url" rel="index"><span itemprop="name">矩阵乘法</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/矩阵乘法/算法/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="HDU5015"><a href="#HDU5015" class="headerlink" title="HDU5015"></a><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5015" target="_blank" rel="noopener">HDU5015</a></h2><p>这题属于很水的矩形题了。 矩阵也很容易构造！</p>
<h1 id="233-Matrix"><a href="#233-Matrix" class="headerlink" title="233 Matrix"></a>233 Matrix</h1><p><strong>Time Limit: 10000/5000 MS (Java/Others)    Memory Limit: 65536/65536 K (Java/Others) Total Submission(s): 453    Accepted Submission(s): 298</strong></p>
<p>Problem Description</p>
<p>In our daily life we often use 233 to express our feelings. Actually, we may say 2333, 23333, or 233333 … in the same meaning. And here is the question: Suppose we have a matrix called 233 matrix. In the first line, it would be 233, 2333, 23333… (it means a0,1 = 233,a0,2 = 2333,a0,3 = 23333…) Besides, in 233 matrix, we got ai,j = ai-1,j +ai,j-1( i,j ≠ 0). Now you have known a1,0,a2,0,…,an,0, could you tell me an,m in the 233 matrix?</p>
<p>Input</p>
<p>There are multiple test cases. Please process till EOF. For each case, the first line contains two postive integers n,m(n ≤ 10,m ≤ 109). The second line contains n integers, a1,0,a2,0,…,an,0(0 ≤ ai,0 &lt; 231).</p>
<p>Output</p>
<p>For each case, output an,m mod 10000007.</p>
<p>Sample Input</p>
<p>1 1 1 2 2 0 0 3 7 23 47 16</p>
<p>Sample Output</p>
<p>234 2799 72937</p>
<p><em>Hint</em></p>
<p><img src="http://acm.hdu.edu.cn/data/images/C534-1009-1.jpg" alt=""></p>
<p>Source</p>
<p><a href="http://acm.hdu.edu.cn/search.php?field=problem&amp;key=2014+ACM%2FICPC+Asia+Regional+Xi%27an+Online&amp;source=1&amp;searchmode=source" target="_blank" rel="noopener">2014 ACM/ICPC Asia Regional Xi’an Online</a></p>
<pre><code>需要构造一个 n+2 维的矩形。 就是要增加一维去维护2333这样的序列。 可以发现 2333 = 233*10 + 3 所以增加了一维就 是1， 然后就可以全部转移了。   反正状态就是 一列 ，再增加一个233不停增加的，然后一个1，所以是 n+2维。 很水了。
</code></pre><p>#include &lt;stdio.h&gt;</p>
<p>#include <algorithm></algorithm></p>
<p>#include <iostream></iostream></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include &lt;string.h&gt;</p>
<p>#include <map></map></p>
<p>#include <vector></vector></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;<br>using namespace std;<br>const int MOD = 1e7+7;<br>struct Matrix{<br>    int mat[15][15];<br>    int n;<br>    void init(int _n){<br>        n = _n;<br>        memset(mat,0,sizeof(mat));<br>    }<br>    Matrix operator <em>(const Matrix &amp;b)const{<br>        Matrix ret;<br>        ret.init(n);<br>        for(int i = 0;i &lt; n;i++)<br>            for(int j = 0;j &lt; n;j++){<br>                ret.mat[i][j] = 0;<br>                for(int k = 0;k &lt; n;k++){<br>                    ret.mat[i][j] += (long long)mat[i][k]</em>b.mat[k][j]%MOD;<br>                    if(ret.mat[i][j] &gt;= MOD)<br>                        ret.mat[i][j] -= MOD;<br>                }<br>            }<br>        return ret;<br>    }<br>};<br>Matrix pow_M(Matrix a,long long n){<br>    Matrix ret;<br>    Matrix tmp = a;<br>    ret.init(a.n);<br>    for(int i = 0;i &lt; a.n;i++)ret.mat[i][i] = 1;<br>    while(n){<br>        if(n&amp;1)ret = ret<em>tmp;<br>        tmp = tmp</em>tmp;<br>        n &gt;&gt;= 1;<br>    }<br>    return ret;<br>}</p>
<p>int a[20];<br>Matrix A;<br>int main()<br>{<br>    //freopen(“in.txt”,”r”,stdin);<br>    //freopen(“out.txt”,”w”,stdout);</p>
<pre><code>int n,m;
while(scanf(&quot;%d%d&quot;,&amp;n,&amp;m) == 2){
    for(int i = 0;i &lt; n;i++){scanf(&quot;%d&quot;,&amp;a\[i\]);a\[i\]%=MOD;}
    A.init(n+2);
    for(int j = 0;j &lt; n;j++){
        for(int i = 0;i &lt;= j;i++)
            A.mat\[i\]\[j\] = 1;
        A.mat\[n\]\[j\] = 1;
    }
    A.mat\[n\]\[n\] = 10;
    A.mat\[n+1\]\[n\] = 3;
    A.mat\[n+1\]\[n+1\] = 1;
    A = pow_M(A,m);
    long long ans = 0;
    for(int i = 0;i &lt; n;i++){
        ans += (long long)a\[i\]*A.mat\[i\]\[n-1\]%MOD;
        ans %= MOD;
    }
    ans += (long long)233*A.mat\[n\]\[n-1\];
    ans%=MOD;
    ans += (long long)A.mat\[n+1\]\[n-1\];
    ans%=MOD;
    printf(&quot;%d\\n&quot;,(int)ans);
}
return 0;
</code></pre><p>}</p>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/09/15/hdu5014/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/09/15/hdu5014/" itemprop="url">
                  HDU 5014 Number Sequence 
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-09-15 23:00:05" itemprop="dateCreated datePublished" datetime="2014-09-15T23:00:05+08:00">2014-09-15</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 13:43:28" itemprop="dateModified" datetime="2018-07-29T13:43:28+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/" itemprop="url" rel="index"><span itemprop="name">HDU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/算法/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="HDU5014"><a href="#HDU5014" class="headerlink" title="HDU5014"></a><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5014" target="_blank" rel="noopener">HDU5014</a></h3><p>贪心YY下就可以了。 最后肯定是两两配对的。 从大到小去找配对的。 异或以下就可以了。 比如要找x配对的。 因为是x最高位以下的0变1,1变0， 这个值一定是比x小的。 注意最后需要long long.  </p>
<h1 id="Number-Sequence"><a href="#Number-Sequence" class="headerlink" title="Number Sequence"></a>Number Sequence</h1><p><strong>Time Limit: 4000/2000 MS (Java/Others)    Memory Limit: 65536/65536 K (Java/Others) Total Submission(s): 629    Accepted Submission(s): 297 Special Judge</strong></p>
<p>Problem Description</p>
<p>There is a special number sequence which has n+1 integers. For each number in sequence, we have two rules: ● ai ∈ [0,n] ● ai ≠ aj( i ≠ j ) For sequence a and sequence b, the integrating degree t is defined as follows(“⊕” denotes exclusive or):</p>
<p>t = (a0 ⊕ b0) + (a1 ⊕ b1) +···+ (an ⊕ bn)</p>
<p>(sequence B should also satisfy the rules described above) Now give you a number n and the sequence a. You should calculate the maximum integrating degree t and print the sequence b.</p>
<p>Input</p>
<p>There are multiple test cases. Please process till EOF. For each case, the first line contains an integer n(1 ≤ n ≤ 105), The second line contains a0,a1,a2,…,an.</p>
<p>Output</p>
<p>For each case, output two lines.The first line contains the maximum integrating degree t. The second line contains n+1 integers b0,b1,b2,…,bn. There is exactly one space between bi and bi+1<strong>(0 ≤ i ≤ n - 1)</strong>. Don’t ouput any spaces after bn.</p>
<p>Sample Input</p>
<p>4 2 0 1 4 3</p>
<p>Sample Output</p>
<p>20 1 0 2 3 4</p>
<p>Source</p>
<p><a href="http://acm.hdu.edu.cn/search.php?field=problem&amp;key=2014+ACM%2FICPC+Asia+Regional+Xi%27an+Online&amp;source=1&amp;searchmode=source" target="_blank" rel="noopener">2014 ACM/ICPC Asia Regional Xi’an Online</a></p>
<p>/* <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>***</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><br>Author        :kuangbin<br>Created Time  :2014/9/15 22:00:04<br>File Name     :E:\2014ACM\2014网络赛\2014西安\HDU5014.cpp<br>************************************************ */</p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;string.h&gt;</p>
<p>#include <iostream></iostream></p>
<p>#include <algorithm></algorithm></p>
<p>#include <vector></vector></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include <map></map></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;</p>
<p>#include &lt;stdlib.h&gt;</p>
<p>#include &lt;time.h&gt;<br>using namespace std;<br>const int MAXN = 100010;<br>int a[MAXN];<br>int b[MAXN];<br>bool vis[MAXN];</p>
<p>int main()<br>{<br>    //freopen(“in.txt”,”r”,stdin);<br>    //freopen(“out.txt”,”w”,stdout);<br>    int n;<br>    while(scanf(“%d”,&amp;n) == 1){<br>        for(int i = 0;i &lt;= n;i++)scanf(“%d”,&amp;a[i]);<br>        memset(vis,false,sizeof(vis));<br>        for(int i = n;i &gt;= 0;i–)<br>            if(!vis[i]){<br>                vis[i] = true;<br>                if(i == 0){<br>                    b[0] = 0;<br>                    continue;<br>                }<br>                int x = (1&lt;&lt;20);<br>                while((i&amp;x) == 0)x &gt;&gt;= 1;<br>                //printf(“i %d %d\n”,i,x);<br>                x = 2*x-1;<br>                x = x^i;<br>                //printf(“%d\n”,x);<br>                b[i] = x;<br>                b[x] = i;<br>                vis[x] = true;<br>            }<br>        long long ans = 0;<br>        for(int i = 0;i &lt;= n;i++)ans += (i^b[i]);<br>        printf(“%I64d\n”,ans);<br>        for(int i = 0;i &lt;= n;i++){<br>            printf(“%d”,b[a[i]]);<br>            if(i == n)printf(“\n”);<br>            else printf(“ “);<br>        }<br>    }<br>    return 0;<br>}</p>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/09/15/hdu5012/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/09/15/hdu5012/" itemprop="url">
                  HDU 5012 Dice （搜索）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-09-15 21:44:21" itemprop="dateCreated datePublished" datetime="2014-09-15T21:44:21+08:00">2014-09-15</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 13:43:28" itemprop="dateModified" datetime="2018-07-29T13:43:28+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/" itemprop="url" rel="index"><span itemprop="name">HDU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/搜索/" itemprop="url" rel="index"><span itemprop="name">搜索</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/搜索/算法/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5012" target="_blank" rel="noopener">HDU5012</a>   求最小步数，暴力bfs就可以了。 范围小，直接map进行映射。 随便搞啊</p>
<h1 id="Dice"><a href="#Dice" class="headerlink" title="Dice"></a>Dice</h1><p><strong>Time Limit: 2000/1000 MS (Java/Others)    Memory Limit: 65536/65536 K (Java/Others) Total Submission(s): 444    Accepted Submission(s): 263</strong></p>
<p>Problem Description</p>
<p>There are 2 special dices on the table. On each face of the dice, a distinct number was written. Consider a1.a2,a3,a4,a5,a6 to be numbers written on top face, bottom face, left face, right face, front face and back face of dice A. Similarly, consider b1.b2,b3,b4,b5,b6 to be numbers on specific faces of dice B. It’s guaranteed that all numbers written on dices are integers no smaller than 1 and no more than 6 while ai ≠ aj and bi ≠ bj for all i ≠ j. Specially, sum of numbers on opposite faces may not be 7. At the beginning, the two dices may face different(which means there exist some i, ai ≠ bi). Ddy wants to make the two dices look the same from all directions(which means for all i, ai = bi) only by the following four rotation operations.(Please read the picture for more information)</p>
<p><img src="http://acm.hdu.edu.cn/data/images/C534-1006-1.jpg" alt=""></p>
<p>Now Ddy wants to calculate the minimal steps that he has to take to achieve his goal.</p>
<p>Input</p>
<p>There are multiple test cases. Please process till EOF. For each case, the first line consists of six integers a1,a2,a3,a4,a5,a6, representing the numbers on dice A. The second line consists of six integers b1,b2,b3,b4,b5,b6, representing the numbers on dice B.</p>
<p>Output</p>
<p>For each test case, print a line with a number representing the answer. If there’s no way to make two dices exactly the same, output -1.</p>
<p>Sample Input</p>
<p>1 2 3 4 5 6 1 2 3 4 5 6 1 2 3 4 5 6 1 2 5 6 4 3 1 2 3 4 5 6 1 4 2 5 3 6</p>
<p>Sample Output</p>
<p>0 3 -1</p>
<p>Source</p>
<p><a href="http://acm.hdu.edu.cn/search.php?field=problem&amp;key=2014+ACM%2FICPC+Asia+Regional+Xi%27an+Online&amp;source=1&amp;searchmode=source" target="_blank" rel="noopener">2014 ACM/ICPC Asia Regional Xi’an Online</a></p>
<p>/* <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>***</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><br>Author        :kuangbin<br>Created Time  :2014/9/15 21:27:02<br>File Name     :E:\2014ACM\2014网络赛\2014西安\HDU5012.cpp<br>************************************************ */</p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;string.h&gt;</p>
<p>#include <iostream></iostream></p>
<p>#include <algorithm></algorithm></p>
<p>#include <vector></vector></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include <map></map></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;</p>
<p>#include &lt;stdlib.h&gt;</p>
<p>#include &lt;time.h&gt;<br>using namespace std;</p>
<p>string left(string ss){<br>    string ret;<br>    ret.resize(6);<br>    int a[] = {3,2,0,1,4,5};<br>    for(int i = 0;i &lt; 6;i++)<br>        ret[i] = ss[a[i]];<br>    return ret;<br>}<br>string right(string ss){<br>    string ret;<br>    ret.resize(6);<br>    int a[] = {2,3,1,0,4,5};<br>    for(int i = 0;i &lt; 6;i++)<br>        ret[i] = ss[a[i]];<br>    return ret;<br>}<br>string front(string ss){<br>    string ret;<br>    ret.resize(6);<br>    int a[] = {5,4,2,3,0,1};<br>    for(int i = 0;i &lt; 6;i++)<br>        ret[i] = ss[a[i]];<br>    return ret;<br>}<br>string back(string ss){<br>    string ret;<br>    ret.resize(6);<br>    int a[] = {4,5,2,3,1,0};<br>    for(int i = 0;i &lt; 6;i++)<br>        ret[i] = ss[a[i]];<br>    return ret;<br>}<br>int solve(string start,string end){<br>    map&lt;string,int&gt;mp;<br>    mp[start] = 0;<br>    queue<string>q;<br>    q.push(start);<br>    while(!q.empty()){<br>        string tmp = q.front();<br>        q.pop();<br>        if(tmp == end)return mp[tmp];<br>        string nn;<br>        nn = left(tmp);<br>        if(mp.find(nn) == mp.end()){<br>            mp[nn] = mp[tmp] + 1;<br>            q.push(nn);<br>        }<br>        nn = right(tmp);<br>        if(mp.find(nn) == mp.end()){<br>            mp[nn] = mp[tmp] + 1;<br>            q.push(nn);<br>        }<br>        nn = front(tmp);<br>        if(mp.find(nn) == mp.end()){<br>            mp[nn] = mp[tmp] + 1;<br>            q.push(nn);<br>        }<br>        nn = back(tmp);<br>        if(mp.find(nn) == mp.end()){<br>            mp[nn] = mp[tmp] + 1;<br>            q.push(nn);<br>        }<br>    }<br>    return -1;<br>}</string></p>
<p>int main()<br>{<br>    //freopen(“in.txt”,”r”,stdin);<br>    //freopen(“out.txt”,”w”,stdout);<br>    int a;<br>    while(scanf(“%d”,&amp;a) == 1){<br>        string str1 = “”;<br>        str1 += (char)(a+’0’);<br>        for(int i = 1;i &lt; 6;i++)<br>        {<br>            scanf(“%d”,&amp;a);<br>            str1 += (char)(a+’0’);<br>        }<br>        string str2 = “”;<br>        for(int i = 0;i &lt; 6;i++){<br>            scanf(“%d”,&amp;a);<br>            str2 += (char)(a+’0’);<br>        }<br>        printf(“%d\n”,solve(str1,str2));<br>    }<br>    return 0;<br>}</p>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/6/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><span class="page-number current">7</span><a class="page-number" href="/page/8/">8</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><a class="extend next" rel="next" href="/page/8/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/blogLogo.jpg"
                alt="kuangbin" />
            
              <p class="site-author-name" itemprop="name">kuangbin</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">127</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">150</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">53</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  <a href="https://github.com/kuangbin" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:kuangbin2009@126.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://www.zhihu.com/people/kuang-bin-95" target="_blank" title="zhihu"><i class="fa fa-fw fa-globe"></i>zhihu</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="http://www.cnblogs.com/kuangbin/" target="_blank" title="cnblogs"><i class="fa fa-fw fa-globe"></i>cnblogs</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="http://wpa.qq.com/msgrd?v=3&uin=1691626124&site=qq&menu=yes" target="_blank" title="QQ"><i class="fa fa-fw fa-globe"></i>QQ</a>
                  
                </span>
              
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-友情链接"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.cnblogs.com/kuangbin/" title="我的博客园" target="_blank">我的博客园</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://zhiyi.live/" title="MoonChasing" target="_blank">MoonChasing</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://taowusheng.cn/" title="YIFEI" target="_blank">YIFEI</a>
                  </li>
                
              </ul>
            </div>
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">kuangbin</span>

  

  
</div>




  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动 v3.7.1</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://theme-next.org">NexT.Pisces</a> v6.3.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>












  















  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.3.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.3.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.3.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.3.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.3.0"></script>



  



  










  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  
  

  

  

  

  

  

</body>
</html>
