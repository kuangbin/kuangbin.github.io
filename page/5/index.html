<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">






  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-flash.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.3.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.3.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.3.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '6.3.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="kuangbin的博客">
<meta property="og:url" content="http://kuangbin.github.io/page/5/index.html">
<meta property="og:site_name" content="kuangbin的博客">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="kuangbin的博客">



  <link rel="alternate" href="/atom.xml" title="kuangbin的博客" type="application/atom+xml" />




  <link rel="canonical" href="http://kuangbin.github.io/page/5/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>kuangbin的博客</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>
	
	<a href="https://github.com/kuangbin"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png" alt="Fork me on GitHub"></a>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">kuangbin的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首页</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-about">
    <a href="/about/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-user"></i> <br />关于</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />标签</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />分类</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />归档</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-catalogue">
    <a href="/catalogue/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />目录</a>
  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/10/22/hdu5078/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/10/22/hdu5078/" itemprop="url">
                  HDU 5078 Osu! （2014鞍山赛区I题，水题）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-10-22 23:01:09" itemprop="dateCreated datePublished" datetime="2014-10-22T23:01:09+08:00">2014-10-22</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 13:43:28" itemprop="dateModified" datetime="2018-07-29T13:43:28+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/" itemprop="url" rel="index"><span itemprop="name">HDU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/水题/" itemprop="url" rel="index"><span itemprop="name">水题</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/水题/算法/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5078" target="_blank" rel="noopener">HDU5078</a> 纯粹贴个水题！</p>
<h1 id="Osu"><a href="#Osu" class="headerlink" title="Osu!"></a>Osu!</h1><p><strong>Time Limit: 2000/1000 MS (Java/Others)    Memory Limit: 262144/262144 K (Java/Others) Total Submission(s): 103    Accepted Submission(s): 69 Special Judge</strong></p>
<p>Problem Description</p>
<p>Osu! is a very popular music game. Basically, it is a game about clicking. Some points will appear on the screen at some time, and you have to click them at a correct time.</p>
<p><img src="http://acm.hdu.edu.cn/data/images/C549-1009-1.jpg" alt=""></p>
<p>Now, you want to write an algorithm to estimate how diffecult a game is. To simplify the things, in a game consisting of N points, point i will occur at time ti at place (xi, yi), and you should click it exactly at ti at (xi, yi). That means you should move your cursor from point i to point i+1. This movement is called a jump, and the difficulty of a jump is just the distance between point i and point i+1 divided by the time between ti and ti+1. And the difficulty of a game is simply the difficulty of the most difficult jump in the game. Now, given a description of a game, please calculate its difficulty.</p>
<p>Input</p>
<p>The first line contains an integer T (T ≤ 10), denoting the number of the test cases.For each test case, the first line contains an integer N (2 ≤ N ≤ 1000) denoting the number of the points in the game.  Then N lines follow, the i-th line consisting of 3 space-separated integers, ti(0 ≤ ti &lt; ti+1 ≤ 106), xi, and yi (0 ≤ xi, yi ≤ 106) as mentioned above.</p>
<p>Output</p>
<p>For each test case, output the answer in one line.Your answer will be considered correct if and only if its absolute or relative error is less than 1e-9.</p>
<p>Sample Input</p>
<p>2 5 2 1 9 3 7 2 5 9 0 6 6 3 7 6 0 10 11 35 67 23 2 29 29 58 22 30 67 69 36 56 93 62 42 11 67 73 29 68 19 21 72 37 84 82 24 98</p>
<p>Sample Output</p>
<p>9.2195444573 54.5893762558</p>
<p><em>Hint</em></p>
<p>In memory of the best osu! player ever Cookiezi.</p>
<p>Source</p>
<p><a href="http://acm.hdu.edu.cn/search.php?field=problem&amp;key=2014+Asia+AnShan+Regional+Contest&amp;source=1&amp;searchmode=source" target="_blank" rel="noopener">2014 Asia AnShan Regional Contest</a></p>
<p>手速还是不够快！</p>
<p>/* <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>***</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><br>Author        :kuangbin<br>Created Time  :2014/10/22 22:59:21<br>File Name     :E:\2014ACM\2014现场赛\鞍山\I.cpp<br>************************************************ */</p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;string.h&gt;</p>
<p>#include <iostream></iostream></p>
<p>#include <algorithm></algorithm></p>
<p>#include <vector></vector></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include <map></map></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;</p>
<p>#include &lt;stdlib.h&gt;</p>
<p>#include &lt;time.h&gt;<br>using namespace std;<br>struct Node{<br>    double t,x,y;<br>    void input(){<br>        scanf(“%lf%lf%lf”,&amp;t,&amp;x,&amp;y);<br>    }<br>    double calc(Node b){<br>        return hypot(x-b.x,y-b.y)/(b.t-t);<br>    }<br>}node[1010];</p>
<p>int main()<br>{<br>    //freopen(“in.txt”,”r”,stdin);<br>    //freopen(“out.txt”,”w”,stdout);<br>    int T;<br>    int n;<br>    scanf(“%d”,&amp;T);<br>    while(T–){<br>        scanf(“%d”,&amp;n);<br>        for(int i = 0;i &lt; n;i++)node[i].input();<br>        double ans = -1.0;<br>        for(int i = 0;i &lt; n-1;i++)<br>            ans = max(ans,node[i].calc(node[i+1]));<br>        printf(“%.10lf\n”,ans);<br>    }<br>    return 0;<br>}</p>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/10/22/hdu5080/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/10/22/hdu5080/" itemprop="url">
                  HDU 5080 Colorful Toy （2014鞍山赛区K题，简单几何+polya）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-10-22 22:53:04" itemprop="dateCreated datePublished" datetime="2014-10-22T22:53:04+08:00">2014-10-22</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 13:43:28" itemprop="dateModified" datetime="2018-07-29T13:43:28+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/" itemprop="url" rel="index"><span itemprop="name">HDU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/数学题/" itemprop="url" rel="index"><span itemprop="name">数学题</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/数学题/数论/" itemprop="url" rel="index"><span itemprop="name">数论</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/数学题/数论/算法/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/数学题/数论/算法/计算几何/" itemprop="url" rel="index"><span itemprop="name">计算几何</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5080" target="_blank" rel="noopener">HDU5080</a> 简单题，主要是暴力搞出置换群有哪几个，然后polya计数。</p>
<h1 id="Colorful-Toy"><a href="#Colorful-Toy" class="headerlink" title="Colorful Toy"></a>Colorful Toy</h1><p><strong>Time Limit: 2000/1000 MS (Java/Others)    Memory Limit: 262144/262144 K (Java/Others) Total Submission(s): 30    Accepted Submission(s): 11</strong></p>
<p>Problem Description</p>
<p>A toy is made up of N vertices and M undirected edges in the 2D plane. As usual, you want to know how many ways there are to color the vertices of the toy. You have totally C colors. And of course, to make things fun, you think that if one color configuration can be rotated to get another, these two configurations should be considered the same. Rotation means 2D in-plane rotation and reflection is not considered as rotation.</p>
<p><img src="http://acm.hdu.edu.cn/data/images/C549-1011-1.jpg" alt=""></p>
<p>For instance, consider coloring the following toy with 2 colors. The coordinates of the vertices are: 1. (0,0) 2. (1,0) 3. (0,1) 4. (-1,0) 5. (0,-1) The toy has 6 edges: (1,2), (1,3), (2,3), (3,4), (4,5), (5,2). As a 2D being, this toy has no symmetry. So there are 32 ways to color it. Had the first two edges been removed, there would be only 12 different ways. You should output the answer modulo 109 + 7.</p>
<p>Input</p>
<p>The first line contains an integer T (T ≤ 20) denoting the number of the test cases. Each test case begins with three positive integers N (1 ≤ N ≤ 50), M (0 ≤ M ≤ N (N - 1)/2) and C(1 ≤ C ≤ 100). Then follow N lines. Each line contains 2 integers in range [-10000,10000] describing a vertex. Then follow M lines. Each line contains 2 integers in range [1,N] representing an edge. There are neither duplicate edges nor self-loops.</p>
<p>Output</p>
<p>For each test case, output one line containing the answer.</p>
<p>Sample Input</p>
<p>2 5 6 2 0 0 1 0 0 1 -1 0 0 -1 1 2 1 3 2 3 3 4 4 5 5 2 5 4 2 0 0 1 0 0 1 -1 0 0 -1 2 3 3 4 4 5 5 2</p>
<p>Sample Output</p>
<p>32 12</p>
<p>Source</p>
<p><a href="http://acm.hdu.edu.cn/search.php?field=problem&amp;key=2014+Asia+AnShan+Regional+Contest&amp;source=1&amp;searchmode=source" target="_blank" rel="noopener">2014 Asia AnShan Regional Contest</a></p>
<pre><code>虽然说旋转的角度是90度的倍数，但是我没有管这个。   我就是粗暴的计算几何的方法进行搞！ 先求平均值，确定中心。 如果和中心重合的点，另外搞出来，其余的点按照极角排序，然后角度相同，按照距离排序。 然后变换的时候肯定是递推过去的。   然后进行判断，一个是判断点可以重合，一个是判断边。 然后就搞定了。  
</code></pre><p>/* <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>***</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><br>Author        :kuangbin<br>Created Time  :2014/10/22 21:46:23<br>File Name     :E:\2014ACM\2014现场赛\鞍山\K.cpp<br>************************************************ */</p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;string.h&gt;</p>
<p>#include <iostream></iostream></p>
<p>#include <algorithm></algorithm></p>
<p>#include <vector></vector></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include <map></map></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;</p>
<p>#include &lt;stdlib.h&gt;</p>
<p>#include &lt;time.h&gt;<br>using namespace std;<br>const double eps = 1e-8;<br>int sgn(double x){<br>    if(fabs(x) &lt; eps)return 0;<br>    if(x &lt; 0)return -1;<br>    else return 1;<br>}<br>struct Point{<br>    double x,y;<br>    double alph;<br>    Point(double _x = 0,double _y = 0){<br>        x = _x;<br>        y = _y;<br>    }<br>    void input(){<br>        scanf(“%lf%lf”,&amp;x,&amp;y);<br>    }<br>    bool operator ==(Point b)const{<br>        return sgn(x-b.x) == 0 &amp;&amp; sgn(y-b.y) == 0;<br>    }<br>    Point operator -(const Point &amp;b)const{<br>        return Point(x-b.x,y-b.y);<br>    }<br>    double distance(Point p){<br>        return hypot(x-p.x,y-p.y);<br>    }<br>    Point rotate(Point p,double angle){<br>        Point v = (<em>this) - p;<br>        double c = cos(angle), s = sin(angle);<br>        return Point(p.x+v.x\</em>c-v.y*s,p.y+v.x*s+v.y*c);<br>    }<br>};<br>long long inv(long long a,long long m){<br>    if(a == 1)return 1;<br>    return inv(m%a,m)<em>(m-m/a)%m;<br>}<br>const int MOD = 1e9+7;<br>long long pow_m(long long a,long long n){<br>    long long ret = 1;<br>    long long tmp = a%MOD;<br>    while(n){<br>        if(n&amp;1)ret = ret</em>tmp%MOD;<br>        tmp = tmp*tmp%MOD;<br>        n &gt;&gt;= 1;<br>    }<br>    return ret;<br>}<br>Point p[100];<br>Point center;<br>int n;<br>int g[55][55];<br>vector<int>V;<br>bool cmp(int i,int j){<br>    if(sgn(p[i].alph - p[j].alph) != 0)<br>        return p[i].alph &lt; p[j].alph;<br>    else return center.distance(p[i]) &lt; center.distance(p[j]);<br>}<br>int link[55];<br>bool check1(){<br>    double jiao = p[link[V[0]]].alph - p[V[0]].alph;<br>    int sz = V.size();<br>    for(int i = 0;i &lt; sz;i++){<br>        Point tmp = p[V[i]].rotate(center,jiao);<br>        if(tmp == p[link[V[i]]])continue;<br>        return false;<br>    }<br>    return true;<br>}<br>bool check2(){<br>    for(int i = 0;i &lt; n;i++)<br>        for(int j = 0;j &lt; n;j++)<br>            if(g[i][j] != g[link[i]][link[j]])<br>                return false;<br>    return true;<br>}<br>bool used[100];<br>int calc(){<br>    int cnt = 0;<br>    memset(used,false,sizeof(used));<br>    for(int i = 0;i &lt; n;i++)<br>        if(!used[i]){<br>            cnt++;<br>            int tmp = i;<br>            while(!used[tmp]){<br>                used[tmp] = true;<br>                tmp = link[tmp];<br>            }<br>        }<br>    return cnt;<br>}</int></p>
<p>int main()<br>{<br>    //freopen(“in.txt”,”r”,stdin);<br>    //freopen(“out.txt”,”w”,stdout);<br>    int T;<br>    int m,C;<br>    scanf(“%d”,&amp;T);<br>    while(T–){<br>        scanf(“%d%d%d”,&amp;n,&amp;m,&amp;C);<br>        for(int i = 0;i &lt; n;i++)<br>            p[i].input();<br>        int u,v;<br>        memset(g,0,sizeof(g));<br>        while(m–){<br>            scanf(“%d%d”,&amp;u,&amp;v);<br>            u–;<br>            v–;<br>            g[u][v] = g[v][u] = 1;<br>        }<br>        if(n == 1){<br>            printf(“%d\n”,C);<br>            continue;<br>        }<br>        center.x = 0;<br>        center.y = 0;<br>        for(int i = 0;i &lt; n;i++){<br>            center.x += p[i].x;<br>            center.y += p[i].y;<br>        }<br>        center.x /= n;<br>        center.y /= n;<br>        V.clear();<br>        for(int i = 0;i &lt; n;i++){<br>            if(p[i] == center){<br>                link[i] = i;<br>                continue;<br>            }<br>            V.push_back(i);<br>            p[i].alph = atan2(p[i].y-center.y,p[i].x-center.x);<br>        }<br>        sort(V.begin(),V.end(),cmp);<br>        long long ans = 0;<br>        int cnt = 0;<br>        int sz = V.size();<br>        for(int i = 0;i &lt; sz;i++){<br>            for(int j = 0;j &lt; sz;j++)<br>                link[V[j]] = V[(j+i)%sz];<br>            if(!check1())continue;<br>            if(!check2())continue;<br>            ans += pow_m(C,calc());<br>            ans %= MOD;<br>            cnt++;<br>        }<br>        ans = ans*inv(cnt,MOD)%MOD;<br>        printf(“%d\n”,(int)ans);<br>    }<br>    return 0;<br>}</p>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/10/20/2014regional/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/10/20/2014regional/" itemprop="url">
                  2014区域赛小结（牡丹江&&鞍山）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-10-20 10:10:25" itemprop="dateCreated datePublished" datetime="2014-10-20T10:10:25+08:00">2014-10-20</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 20:08:10" itemprop="dateModified" datetime="2018-07-29T20:08:10+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/小结/" itemprop="url" rel="index"><span itemprop="name">小结</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最后的两场区域赛结束了！   ICPC生涯的最后两场区域赛，选择了前两个赛区——牡丹江和鞍山，主要是时间比较靠前，而且我向来对东北赛区有特殊的偏好，我打过的区域赛几乎都是在东北（除了第一年打酱油的时候）。 而且特别想回到牡丹江去，在那个曾经打过比赛的地方再打一次比赛，拿回自己想要的。 而且今年岐哥也要打前两场，所以就选择了前两个赛区和岐哥一起打退役赛！ 两场比赛采用队名——Final_Battle (最后一战)，决心背水一战，认真打完两场退役赛！ 牡丹江时候状态低迷，卡个水题结束了第一战！发现了最大的问题就是卡题，一卡题全场奔溃！ 牡丹江回来后，痛定思痛，恢复了一周，然后最后一场鞍山站，决心背水一战，然后勉强还算比较顺利，没怎么卡题，紧紧跟着榜！封榜后成功A了两题，华丽翻盘，收获第一金，斩获一个亚军，圆满退役！   </p>
<p>先记录下两个赛站的流水账：   </p>
<p>牡丹江： 周五从上海飞到了哈尔滨，然后机场直接坐大巴去了牡丹江。 到牡丹江就已经是晚上了，去牡丹江师范学院吃了一顿自助餐，感觉很棒！然后去酒店休息了。 周六上午随便逛了下，中午又是自助餐，然后下午是开幕式+热身赛。 热身赛随便水了一发，乱测一番。晚上又是吃自助餐，然后就滚回来休息了，可能是前面几天都起得太早了，然后在牡丹江也起得好早，睡不着~ 周日正式比赛。 开场后，哥的vim环境都没配好，对面的一个妹纸开始敲A了，卧槽，仰慕！ 弄好队友开始写A了， 然后读题的时候有队伍过I，我去看了下，求信息熵的水题，然后去交换着写I， A过了不久我也过了I。  然后搞D题，一个概率题， 然后乱想一番，终于搞定做法，DP一下，在一个小时的时候写过了D吧。   然后就开始陷入窘境。 连看好几题，毫无思路。  然后电脑给队友写H的模拟。 之后B，K过了一大片，然后一直想K，K感觉就是各种乱搞，但是智商明显感觉不够了。 然后想K的过程，明显感觉自己今天完全不在状态，各种讨论K之后，想了一个错误的贪心，然后写K，然后就是一直WA了~~~~     然后这个状态持续了2个多小时，我们一直是3题。 那个时候很慌张，感觉再这样下去银牌都不保，何谈夺金！  幸好过了段时间队友把H写过了，然后K还是继续WA，完全想错了。 快封榜的时候看了下形势，6题的已经好几个了，过B和K的很多，其余题几乎没有队过。  然后突然想到一个B的做法，把K丢给了队友去写了，我改写B去了，写到一半给队友写K，然后终于过了K， 然后继续写B， 然后有几个地方没写好，各种调试。 最后提交，WA好几次，RE好几次，卧槽！爆栈了，没时间改了，然后就是结束了。 然后牡丹江赛区一个银牌惨淡收场！ 感觉牡丹江场的题完全不适合我，智商碾压，不得不服。同时祝贺xiaodao和wuyiqi均在牡丹江夺金！ 然后周一便坐火车去哈尔滨，然后滚回上海了。   回到上海，调整了正常的作息时间，要避免在赛前休息不好！ 然后一方面忙好其他事情的同时，练了一些题目，来找回自己的状态！ 找 数学lover 巨巨单挑了几场训练赛，来找感觉，特别感觉数一巨巨陪本弱比赛！ 以及岛娘给我的几个神题。  </p>
<p>鞍山： 周五出发去的鞍山，去鞍山是飞机直接从上海到达的了，相对而言时间不会很紧。到了鞍山，住进了坑爹的沈铁千山疗养院，竟然有虫子，还各种不干净，被子有怪味道。 疗养院附近找了一家饭店吃个饭，感觉不错。 然后晚上就回来玩了，本来要去那里所谓的温泉的，去看了发现又被坑了，根本没温泉。 不知道是去那吹到风了，还是因为吃了那边的食物，或者住的地方影响，那天开始就一直嗓子疼，感觉马上就要感冒了。 周六在疗养院吃早餐，报道。早餐也真是够坑的，啥都没有。 然后中午在那吃了个自助餐，感觉不错。 然后就开始退掉了疗养院，搬到辽宁科技大学附近去住了。 然后是热身赛，好像是原题，但是我也只会做一题，C题虽然大致知道怎么搞，但是有个容斥的地方搞错，直接导致复杂度超大，啪啪啪写了一大堆代码。 热身赛就攒一些RP吧，照常进行了一些测试，感觉电脑速度一般，没有牡丹江的快，但也不慢。 然后热身赛就结束了，吃个晚饭，晚上回到住的地方，打了一发BC，水水群就睡觉了。 周日是最后一场正式赛的时候了，早上起来喝了几瓶红牛，吃完早餐就去赛场比赛了。 比赛前，再次想了下不能卡题了，而且按照岛娘的教导“紧紧跟榜，不抢FB”。 开场前看了下气球颜色，上来我配好电脑，就首先看的I，果然是水题，确认下题意开始写，刚开始写果然有些紧张，然后5min 1Y。 然后E题很快有人过了，过的速度很快应该是水题，就交给队友去看了，自己开始看其他题，然后E 26min 1Y了。 紧接着D的FB被抢了，回去又看了一眼D，终于看懂，发现是水题。 然后我就去写D了，48min 1Y了D。 然后看到C有人做出来，继续想C。 期间很长时间没有新的题目被做出了。 发现旁边的电子科技大学的好像在写B吧，然后让队友去看B，好像是模拟，队友就开始写B的模拟了，反正我是一般情况下都不会去写模拟题的。 期间C做出的越来越多，我还一直没想到比较好的做法。 这个状态持续了比较长的时间。   又想起了牡丹江在第四题卡死，历史总是惊人的相似，感觉好可怕！ 为了避免再卡C，我想了种 比较麻烦的方法，各种容斥结合一起放大招解决胡搞一下C。然后我先来写C了， 拿出模板，把需要的模板都敲上去，然后各种容斥联合求解，写了好长一段代码。 调试了一段时间把一些错误都纠正过来，勉强可以过样例， 暴力对拍了一组数据，感觉问题不大，然后提交了， 161 min 1Y了C，感觉C做得太艰难了。 这段时间排名回到了第十左右。 然后看了下形势，B和K有过的，其余题都还没人过，还有2个多小时，决定让队友都去先搞B了，我去看K去了。 发现K其实不难，而且是我很喜欢的类型，算法很明确，只要我啪啪啪把模板敲上去就差不多了。 然后队友交B WA了，我开始写K了，把简单的几何模板敲上去，期间换队友改了几发B，队友在217min把B题AC了。 然后我继续写K，队友好像在看H，感觉此时写代码状态还是比较好的，各种细节都考虑到了，封榜前把样例调出来了，出了数据也是正确的，为了保险期间稍微检查了下，然后封榜后提交了K，然后246 min 1Y了K题。 此时6题应该是比较靠前的了，金是没有问题了，而且也应该可以学校前10顺利出线了。 最后的时间给队友们搞H。 我这个时候就稍微看看别的题目的题意，只是感觉此时我的体力几乎耗完了，写C确实耗费了我太大的元气。 然后看队友写H， 我也没怎么想H，好像就是在打表随机搞吧。 围观周围队伍的过题情况，没发现有新的题。 然后时间慢慢过去，临近结束前队友把H过掉了，真是太棒了。 然后7题结束，结束前为了纪念最后一场regional,把每个题都提交了一遍。 结束后据说7题的队伍只有两个，然后我们就意外的捧杯了。 然后去参加颁奖，领到了亚军奖杯。上海大学第一块金牌，首次捧杯！ 同时祝贺wuyiqi再次在鞍山斩获金牌。 之后收到了各方的祝贺，非常感谢大家在赛前的鼓励，你们的支持是我最大的动力。岛娘一直在带领我刷神题，教我神奇的技能，一直鼓励着我。          </p>
<p> 今年的两场区域赛算是结束了。总算是可以退役了。一银一金，也算是圆满结束了。 感觉acm这一路走来，真是太不容易了。这其中的辛酸只有自己才知道。 如果最后一场比赛再没有拿金，真的会面临巨大的压力，将会遗憾退役，各种被D。 从上年长春站银牌第一，再到牡丹江时候惨败拿银，鞍山真是背水一战，再不拿金，就再也没有机会了。 对于弱校，金牌是一件想都不敢想的事情，拿块银就已经是不错的成绩了。 当年我开始搞acm的时候，只会C的一点基本语法，A+B都不会，那个时候就被下一届的虐了，大家都已经很厉害了，那个时候各种被D。转眼三年半过去了，这过程中同一届的以及下一届的早就退役了，而我却还在，我感觉自己总是比别人慢了一大拍。 对于一个非计算机专业的来说，一直在参赛也确实让很多人不解。对于外界的各种质疑，以及各种实际情况，我一直在思考弱者为何而战！      每一天，白天要去忙碌各种其他的事情，然后中午回寝室休息的时候会写写代码，晚上回来也是默默地写代码刷题。以至于放寝室的笔记本电脑成了刷题写代码专用，离开寝室就做别的事情，回到寝室就可以刷刷题了。 生活于一个写代码被认为是一个稀罕的事情的世界里，写代码的动物成了一个稀有动物。对于各种异样的目光，我或许早就习惯了，我被视为一个不务正业的人。 反正白天只能去忙碌别的事情，写代码刷题只能回到寝室默默地做着。 到后来自己默默地出来比赛，也没啥人知道我是出来比赛了。 真的一直好想把上大带入世界级舞台，来实现自己当初的愿望。 或许这只是一个小小的心愿，也是一种责任。 本来上一年就应该夺金，凭借优惠名额进军World Final的，但是我没能做到，只能遗憾拿到银牌第一，机会擦肩而过。 今年迫不得已再战一年，去北京邀请赛没拿到金，然后牡丹江也没拿到金，鞍山总算夺金了，总算不会遗憾退役了。  我搞了这么久才拿到第一个金牌，也真是够弱的了。   很多事情说多了都是泪，回去有空的时候再补一个退役帖吧！（这次是真的退役了，鉴于很多人吐槽我上年写了退役帖然后诈尸回来了。）     愿后面的赛区各位一切顺利！</p>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/10/07/hdu4656/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/10/07/hdu4656/" itemprop="url">
                  HDU 4656 Evaluation （快速数论变换NTT）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-10-07 22:54:10" itemprop="dateCreated datePublished" datetime="2014-10-07T22:54:10+08:00">2014-10-07</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 20:58:16" itemprop="dateModified" datetime="2018-07-29T20:58:16+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/算法/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/" itemprop="url" rel="index"><span itemprop="name">HDU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/数学题/" itemprop="url" rel="index"><span itemprop="name">数学题</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/数论/" itemprop="url" rel="index"><span itemprop="name">数论</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=4656" target="_blank" rel="noopener">HDU4656</a>   关于快速数论变换资料，参考ACDdreamer大神博客：<a href="http://blog.csdn.net/acdreamers/article/details/39026505" target="_blank" rel="noopener">here</a>   本题需要公式推导，然后使用NTT来求卷积运算。     </p>
<p>$$F_{x_k} = \sum_{i=0}^{n-1} a_i (bc^{2k}+d)^i$$ $$=\sum_{i=0}^{n-1} a_i \sum_{j=0}^{i}C_i^j (bc^{2k})^j d ^ {i-j} $$ $$=\sum_{j=0}^{n-1}(bc^{2k})^j j!^{-1} \sum_{i=j}^{n-1}a_i d^{i-j} i! (i-j)!^{-1} $$ $$=\sum_{j=0}^{n-1}(bc^{2k})^j j!^{-1} \sum_{i=0}^{n-1-j}a_{n-1-i}(n-1-i)! d^{n-1-i-j} (n-1-i-j)!^{-1} $$ $$=\sum_{j=0}^{n-1} (bc^{2k})^j j!^{-1} p_j $$ $$=\sum_{j=0}^{n-1} b^j j!^{-1} p_j c^{2jk} $$ $$=c^{k^2} \sum_{j=0}^{n-1} b^j j!^{-1} p_j c^{j^2} c^{-(k-j)^2} $$ $$=c^{k^2} q_k$$      </p>
<h1 id="Evaluation"><a href="#Evaluation" class="headerlink" title="Evaluation"></a>Evaluation</h1><p><strong>Time Limit: 6000/3000 MS (Java/Others)    Memory Limit: 131072/65536 K (Java/Others) Total Submission(s): 78    Accepted Submission(s): 15</strong></p>
<p>Problem Description</p>
<p>xk=b*c(2k)+d F(x)=a0 x0+a1 x1+a2 x2+…+an-1 xn-1 Given n, b, c, d, a0, …, an-1, calculate F(x0), …, F(xn-1).</p>
<p>Input</p>
<p>There is only one test case. First line, four integers, n, b, c, d. Second line, n integers, a0, …, an-1.1&lt;=n&lt;=105 1&lt;= b, c, d &lt;=106 0&lt;=ai&lt;=106</p>
<p>Output</p>
<p>n lines. i-th line contains one integer, F(xi-1). Since the answers may be very large, you should output them modulo 106+3.</p>
<p>Sample Input</p>
<p>2 1 2 3 0 1</p>
<p>Sample Output</p>
<p>4 7</p>
<p>Source</p>
<p><a href="http://acm.hdu.edu.cn/search.php?field=problem&amp;key=2013+Multi-University+Training+Contest+6&amp;source=1&amp;searchmode=source" target="_blank" rel="noopener">2013 Multi-University Training Contest 6</a></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ***************</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Author        :kuangbin</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Created Time  :2014/10/7 21:21:32</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">File Name     :E:\2014ACM\专题学习\数学\快速数论变换\HDU4656.cpp</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">************************************************ */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//*************</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//快速数论变换(NTT)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//求A和B的卷积，结果对P取模</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//做长度为N1的变换，选取两个质数P1和P2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//P1-1和P2-1必须是N1的倍数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//E1和E2分别是P1,P2的原根</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//F1是E1模P1的逆元,F2是E2模P2的逆元</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//I1是N1对模P1的逆元,I2是N1对模P2的逆元</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//然后使用中国剩余定理，保证了结果是小于MM=P1*P2的</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//M1 = (P2对P1的逆元)*P2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//M2 = (P1对P2的逆元)*P1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">1000003</span>;<span class="comment">//结果对P取模</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N1 = <span class="number">262144</span>;<span class="comment">// 2^&#123;18&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N2 = N1+<span class="number">1</span>;<span class="comment">//数组大小</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P1 = <span class="number">998244353</span>;<span class="comment">//P1 = 2^&#123;23&#125;*7*17 + 1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P2 = <span class="number">995622913</span>;<span class="comment">//P2 = 2^&#123;19&#125;*3*3*211 + 1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> E1 = <span class="number">996173970</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> E2 = <span class="number">88560779</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> F1 = <span class="number">121392023</span>;<span class="comment">//E1*F1 = 1(mod P1)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> F2 = <span class="number">840835547</span>;<span class="comment">//E2*F2 = 1(mod P2)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> I1 = <span class="number">998240545</span>;<span class="comment">//I1*N1 = 1(mod P1)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> I2 = <span class="number">995619115</span>;<span class="comment">//I2*N1 = 1(mod P2)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> M1 = <span class="number">397550359381069386L</span>L;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> M2 = <span class="number">596324591238590904L</span>L;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> MM = <span class="number">993874950619660289L</span>L;<span class="comment">//MM = P1*P2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//计算x*y对z取模</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">mul</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> x,<span class="keyword">long</span> <span class="keyword">long</span> y,<span class="keyword">long</span> <span class="keyword">long</span> z)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> (x*y - (<span class="keyword">long</span> <span class="keyword">long</span>)(x/(<span class="keyword">long</span> <span class="keyword">double</span>)z*y+<span class="number">1e-3</span>)*z+z)%z;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">trf</span><span class="params">(<span class="keyword">int</span> x1,<span class="keyword">int</span> x2)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> (mul(M1,x1,MM)+mul(M2,x2,MM))%MM%P;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> A[N2],B[N2],C[N2];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> A1[N2],B1[N2],C1[N2];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fft</span><span class="params">(<span class="keyword">int</span> *A,<span class="keyword">int</span> PM,<span class="keyword">int</span> PW)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> m = N1,h;h = m/<span class="number">2</span>, m &gt;= <span class="number">2</span>;PW = (<span class="keyword">long</span> <span class="keyword">long</span>)PW*PW%PM,m=h)</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>,w=<span class="number">1</span>;i &lt; h;i++, w = (<span class="keyword">long</span> <span class="keyword">long</span>)w*PW%PM)</span><br><span class="line"></span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j = i;j &lt; N1;j += m)&#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">int</span> k = j+h, x = (A[j]-A[k]+PM)%PM;</span><br><span class="line"></span><br><span class="line">				(A[j]+=A[k])%=PM;</span><br><span class="line"></span><br><span class="line">				A[k] = (<span class="keyword">long</span> <span class="keyword">long</span>)w*x%PM;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>,j = <span class="number">1</span>;j &lt; N1<span class="number">-1</span>;j++)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> k = N1/<span class="number">2</span>; k &gt; (i^=k);k /= <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(j &lt; i)swap(A[i],A[j]);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//计算A和B的卷积，结果保存在C中，结果对P取模</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mul</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">memset</span>(C,<span class="number">0</span>,<span class="keyword">sizeof</span>(C));</span><br><span class="line"></span><br><span class="line">	<span class="built_in">memcpy</span>(A1,A,<span class="keyword">sizeof</span>(A));</span><br><span class="line"></span><br><span class="line">	<span class="built_in">memcpy</span>(B1,B,<span class="keyword">sizeof</span>(B));</span><br><span class="line"></span><br><span class="line">	fft(A1,P1,E1); fft(B1,P1,E1);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; N1;i++)C1[i] = (<span class="keyword">long</span> <span class="keyword">long</span>)A1[i]*B1[i]%P1;</span><br><span class="line"></span><br><span class="line">	fft(C1,P1,F1);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; N1;i++)C1[i] = (<span class="keyword">long</span> <span class="keyword">long</span>)C1[i]*I1%P1;</span><br><span class="line"></span><br><span class="line">	fft(A,P2,E2); fft(B,P2,E2);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; N1;i++)C[i] = (<span class="keyword">long</span> <span class="keyword">long</span>)A[i]*B[i]%P2;</span><br><span class="line"></span><br><span class="line">	fft(C,P2,F2);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; N1;i++)C[i] = (<span class="keyword">long</span> <span class="keyword">long</span>)C[i]*I2%P2;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; N1;i++)C[i] = trf(C1[i],C[i]);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> INV[P];<span class="comment">//逆元</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">100010</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> F[MAXN];<span class="comment">//阶乘</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> a[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> pd[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> pb[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> pc2[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> p[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//预处理逆元</span></span><br><span class="line"></span><br><span class="line">	INV[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt; P;i++)</span><br><span class="line"></span><br><span class="line">		INV[i] = (<span class="keyword">long</span> <span class="keyword">long</span>)P/i*(P-INV[P%i])%P;</span><br><span class="line"></span><br><span class="line">	F[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; MAXN;i++)</span><br><span class="line"></span><br><span class="line">		F[i] = (<span class="keyword">long</span> <span class="keyword">long</span>)F[i<span class="number">-1</span>]*i%P;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> n,b,c,d;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>,&amp;n,&amp;b,&amp;c,&amp;d) == <span class="number">4</span>)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a[i]);</span><br><span class="line"></span><br><span class="line">		pd[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; n;i++)</span><br><span class="line"></span><br><span class="line">			pd[i] = (<span class="keyword">long</span> <span class="keyword">long</span>)pd[i<span class="number">-1</span>]*d%P;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">memset</span>(A,<span class="number">0</span>,<span class="keyword">sizeof</span>(A));</span><br><span class="line"></span><br><span class="line">		<span class="built_in">memset</span>(B,<span class="number">0</span>,<span class="keyword">sizeof</span>(B));</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)</span><br><span class="line"></span><br><span class="line">			A[i] = (<span class="keyword">long</span> <span class="keyword">long</span>)a[n<span class="number">-1</span>-i]*F[n<span class="number">-1</span>-i]%P;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)</span><br><span class="line"></span><br><span class="line">			B[i] = (<span class="keyword">long</span> <span class="keyword">long</span>)pd[i]*INV[F[i]]%P;</span><br><span class="line"></span><br><span class="line">		mul();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)p[i] = C[i];</span><br><span class="line"></span><br><span class="line">		reverse(p,p+n);</span><br><span class="line"></span><br><span class="line">		<span class="built_in">memset</span>(A,<span class="number">0</span>,<span class="keyword">sizeof</span>(A));</span><br><span class="line"></span><br><span class="line">		pb[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; n;i++)</span><br><span class="line"></span><br><span class="line">			pb[i] = (<span class="keyword">long</span> <span class="keyword">long</span>)pb[i<span class="number">-1</span>]*b%P;</span><br><span class="line"></span><br><span class="line">		pc2[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> c2 = (<span class="keyword">long</span> <span class="keyword">long</span>)c*c%P;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, s = c;i &lt; n;i++)&#123;</span><br><span class="line"></span><br><span class="line">			pc2[i] = (<span class="keyword">long</span> <span class="keyword">long</span>)pc2[i<span class="number">-1</span>]*s%P;</span><br><span class="line"></span><br><span class="line">			s = (<span class="keyword">long</span> <span class="keyword">long</span>)s*c2%P;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)</span><br><span class="line"></span><br><span class="line">			A[i] = (<span class="keyword">long</span> <span class="keyword">long</span>)pb[i]*INV[F[i]]%P*p[i]%P*pc2[i]%P;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">memset</span>(B,<span class="number">0</span>,<span class="keyword">sizeof</span>(B));</span><br><span class="line"></span><br><span class="line">		B[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; n;i++)</span><br><span class="line"></span><br><span class="line">			B[i] = B[N1-i] = INV[pc2[i]];</span><br><span class="line"></span><br><span class="line">		mul();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)C[i] = (<span class="keyword">long</span> <span class="keyword">long</span>)C[i]*pc2[i]%P;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)</span><br><span class="line"></span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,C[i]);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/10/07/poj3528/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/10/07/poj3528/" itemprop="url">
                  POJ 3528 Ultimate Weapon （三维凸包，求凸包表面积）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-10-07 13:27:42" itemprop="dateCreated datePublished" datetime="2014-10-07T13:27:42+08:00">2014-10-07</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 13:43:28" itemprop="dateModified" datetime="2018-07-29T13:43:28+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Online-Judge/POJ/" itemprop="url" rel="index"><span itemprop="name">POJ</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Online-Judge/POJ/算法/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Online-Judge/POJ/算法/计算几何/" itemprop="url" rel="index"><span itemprop="name">计算几何</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://poj.org/problem?id=3528" target="_blank" rel="noopener">POJ3528</a>   求三维凸包的表面积。 直接上模板。</p>
<p>Ultimate Weapon</p>
<p><strong>Time Limit:</strong> 2000MS</p>
<p><strong>Memory Limit:</strong> 131072K</p>
<p><strong>Total Submissions:</strong> 2072</p>
<p><strong>Accepted:</strong> 987</p>
<p>Description</p>
<p>In year 2008 of the Cosmic Calendar, the Aliens send a huge armada towards the Earth seeking after conquest. The humans now depend on their ultimate weapon to retain their last hope of survival. The weapon, while capable of creating a continuous, closed and convex lethal region in the space and annihilating everything enclosed within, unfortunately exhausts upon each launch a tremendous amount of energy which is proportional to the surface area of the lethal region. Given the positions of all battleships in the Aliens’ armada, your task is to calculate the minimum amount of energy required to destroy the armada with a single launch of the ultimate weapon. You need to report the surface area of the lethal region only.</p>
<p>Input</p>
<p>The first line contains one number _N_ -- the number of battleships.(1 ≤ _N_ ≤ 500) Following _N_ lines each contains three integers presenting the position of one battleship.</p>
<p>Output</p>
<p>The minimal area rounded to three decimal places.</p>
<p>Sample Input</p>
<p>4<br>0 0 0<br>4 0 0<br>2 3 0<br>1 1 2</p>
<p>Sample Output</p>
<p>19.137</p>
<p>Hint</p>
<p>There are no four coplaner battleships.</p>
<p>Source</p>
<p><a href="http://poj.org/searchproblem?field=source&amp;key=POJ+Founder+Monthly+Contest+%E2%80%93+2008.03.16" target="_blank" rel="noopener">POJ Founder Monthly Contest – 2008.03.16</a>, Jiang Liyang</p>
<p>/* <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>***</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><br>Author        :kuangbin<br>Created Time  :2014/10/7 12:21:36<br>File Name     :E:\2014ACM\专题学习\计算几何\三维几何\POJ3528.cpp<br>************************************************ */</p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;string.h&gt;</p>
<p>#include <iostream></iostream></p>
<p>#include <algorithm></algorithm></p>
<p>#include <vector></vector></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include <map></map></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;</p>
<p>#include &lt;stdlib.h&gt;</p>
<p>#include &lt;time.h&gt;<br>using namespace std;</p>
<p>const double eps = 1e-8;<br>const int MAXN = 550;<br>int sgn(double x){<br>    if(fabs(x) &lt; eps)return 0;<br>    if(x &lt; 0)return -1;<br>    else return 1;<br>}<br>struct Point3{<br>    double x,y,z;<br>    Point3(double _x = 0, double _y = 0, double _z = 0){<br>        x = _x;<br>        y = _y;<br>        z = _z;<br>    }<br>    void input(){<br>        scanf(“%lf%lf%lf”,&amp;x,&amp;y,&amp;z);<br>    }<br>    bool operator ==(const Point3 &amp;b)const{<br>        return sgn(x-b.x) == 0 &amp;&amp; sgn(y-b.y) == 0 &amp;&amp; sgn(z-b.z) == 0;<br>    }<br>    double len(){<br>        return sqrt(x*x+y*y+z<em>z);<br>    }<br>    double len2(){<br>        return x\</em>x+y*y+z<em>z;<br>    }<br>    double distance(const Point3 &amp;b)const{<br>        return sqrt((x-b.x)</em>(x-b.x)+(y-b.y)<em>(y-b.y)+(z-b.z)</em>(z-b.z));<br>    }<br>    Point3 operator -(const Point3 &amp;b)const{<br>        return Point3(x-b.x,y-b.y,z-b.z);<br>    }<br>    Point3 operator +(const Point3 &amp;b)const{<br>        return Point3(x+b.x,y+b.y,z+b.z);<br>    }<br>    Point3 operator <em>(const double &amp;k)const{<br>        return Point3(x\</em>k,y*k,z<em>k);<br>    }<br>    Point3 operator /(const double &amp;k)const{<br>        return Point3(x/k,y/k,z/k);<br>    }<br>    //点乘<br>    double operator </em>(const Point3 &amp;b)const{<br>        return x*b.x + y*b.y + z<em>b.z;<br>    }<br>    //叉乘<br>    Point3 operator ^(const Point3 &amp;b)const{<br>        return Point3(y\</em>b.z-z*b.y,z*b.x-x*b.z,x*b.y-y*b.x);<br>    }<br>};<br>struct CH3D{<br>    struct face{<br>        //表示凸包一个面上的三个点的编号<br>        int a,b,c;<br>        //表示该面是否属于最终的凸包上的面<br>        bool ok;<br>    };<br>    //初始顶点数<br>    int n;<br>    Point3 P[MAXN];<br>    //凸包表面的三角形数<br>    int num;<br>    //凸包表面的三角形<br>    face F[8<em>MAXN];<br>    int g[MAXN][MAXN];<br>    //叉乘<br>    Point3 cross(const Point3 &amp;a,const Point3 &amp;b,const Point3 &amp;c){<br>        return (b-a)^(c-a);<br>    }<br>    //三角形面积</em>2<br>    double area(Point3 a,Point3 b,Point3 c){<br>        return ((b-a)^(c-a)).len();<br>    }<br>    //四面体有向面积<em>6<br>    double volume(Point3 a,Point3 b,Point3 c,Point3 d){<br>        return ((b-a)^(c-a))</em>(d-a);<br>    }<br>    //正：点在面同向<br>    double dblcmp(Point3 &amp;p,face &amp;f){<br>        Point3 p1 = P[f.b] - P[f.a];<br>        Point3 p2 = P[f.c] - P[f.a];<br>        Point3 p3 = p - P[f.a];<br>        return (p1^p2)*p3;<br>    }<br>    void deal(int p,int a,int b){<br>        int f = g[a][b];<br>        face add;<br>        if(F[f].ok){<br>            if(dblcmp(P[p],F[f]) &gt; eps)<br>                dfs(p,f);<br>            else {<br>                add.a = b;<br>                add.b = a;<br>                add.c = p;<br>                add.ok = true;<br>                g[p][b] = g[a][p] = g[b][a] = num;<br>                F[num++] = add;<br>            }<br>        }<br>    }<br>    //递归搜索所有应该从凸包内删除的面<br>    void dfs(int p,int now){<br>        F[now].ok = false;<br>        deal(p,F[now].b,F[now].a);<br>        deal(p,F[now].c,F[now].b);<br>        deal(p,F[now].a,F[now].c);<br>    }<br>    bool same(int s,int t){<br>        Point3 &amp;a = P[F[s].a];<br>        Point3 &amp;b = P[F[s].b];<br>        Point3 &amp;c = P[F[s].c];<br>        return fabs(volume(a,b,c,P[F[t].a])) &lt; eps &amp;&amp;<br>            fabs(volume(a,b,c,P[F[t].b])) &lt; eps &amp;&amp;<br>            fabs(volume(a,b,c,P[F[t].c])) &lt; eps;<br>    }<br>    //构建三维凸包<br>    void create(){<br>        num = 0;<br>        face add;</p>
<pre><code>    //***********************************
    //此段是为了保证前四个点不共面
    bool flag = true;
    for(int i = 1;i &lt; n;i++){
        if(!(P\[0\] == P\[i\])){
            swap(P\[1\],P\[i\]);
            flag = false;
            break;
        }
    }
    if(flag)return;
    flag = true;
    for(int i = 2;i &lt; n;i++){
        if( ((P\[1\]-P\[0\])^(P\[i\]-P\[0\])).len() &gt; eps ){
            swap(P\[2\],P\[i\]);
            flag = false;
            break;
        }
    }
    if(flag)return;
    flag = true;
    for(int i = 3;i &lt; n;i++){
        if(fabs( ((P\[1\]-P\[0\])^(P\[2\]-P\[0\]))*(P\[i\]-P\[0\]) ) &gt; eps){
            swap(P\[3\],P\[i\]);
            flag = false;
            break;
        }
    }
    if(flag)return;
    //**********************************

    for(int i = 0;i &lt; 4;i++){
        add.a = (i+1)%4;
        add.b = (i+2)%4;
        add.c = (i+3)%4;
        add.ok = true;
        if(dblcmp(P\[i\],add) &gt; 0)swap(add.b,add.c);
        g\[add.a\]\[add.b\] = g\[add.b\]\[add.c\] = g\[add.c\]\[add.a\] = num;
        F\[num++\] = add;
    }
    for(int i = 4;i &lt; n;i++)
        for(int j = 0;j &lt; num;j++)
            if(F\[j\].ok &amp;&amp; dblcmp(P\[i\],F\[j\]) &gt; eps){
                dfs(i,j);
                break;
            }
    int tmp = num;
    num = 0;
    for(int i = 0;i &lt; tmp;i++)
        if(F\[i\].ok)
            F\[num++\] = F\[i\];
}
//表面积
double area(){
    double res = 0;
    if(n == 3){
        Point3 p = cross(P\[0\],P\[1\],P\[2\]);
        return p.len()/2;
    }
    for(int i = 0;i &lt; num;i++)
        res += area(P\[F\[i\].a\],P\[F\[i\].b\],P\[F\[i\].c\]);
    return res/2.0;
}
double volume(){
    double res = 0;
    Point3 tmp = Point3(0,0,0);
    for(int i = 0;i &lt; num;i++)
        res += volume(tmp,P\[F\[i\].a\],P\[F\[i\].b\],P\[F\[i\].c\]);
    return fabs(res/6);
}
//表面三角形个数
int triangle(){
    return num;
}
//表面多边形个数
//测试：HDU3662
int polygon(){
    int res = 0;
    for(int i = 0;i &lt; num;i++){
        bool flag = true;
        for(int j = 0;j &lt; i;j++)
            if(same(i,j)){
                flag = 0;
                break;
            }
        res += flag;
    }
    return res;
}
//重心
//测试：HDU4273
Point3 barycenter(){
    Point3 ans = Point3(0,0,0);
    Point3 o = Point3(0,0,0);
    double all = 0;
    for(int i = 0;i &lt; num;i++){
        double vol = volume(o,P\[F\[i\].a\],P\[F\[i\].b\],P\[F\[i\].c\]);
        ans = ans + (((o+P\[F\[i\].a\]+P\[F\[i\].b\]+P\[F\[i\].c\])/4.0)*vol);
        all += vol;
    }
    ans = ans/all;
    return ans;
}
//点到面的距离
//测试：HDU4273
double ptoface(Point3 p,int i){
    double tmp1 = fabs(volume(P\[F\[i\].a\],P\[F\[i\].b\],P\[F\[i\].c\],p));
    double tmp2 = ((P\[F\[i\].b\]-P\[F\[i\].a\])^(P\[F\[i\].c\]-P\[F\[i\].a\])).len();
    return tmp1/tmp2;
}
</code></pre><p>};<br>CH3D hull;<br>int main()<br>{<br>    //freopen(“in.txt”,”r”,stdin);<br>    //freopen(“out.txt”,”w”,stdout);<br>    while(scanf(“%d”,&amp;hull.n) == 1){<br>        for(int i = 0;i &lt; hull.n;i++)hull.P[i].input();<br>        hull.create();<br>        printf(“%.3f\n”,hull.area());<br>    }<br>    return 0;<br>}</p>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/10/07/hdu4273/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/10/07/hdu4273/" itemprop="url">
                  HDU 4273 Rescue （三维凸包，求重心到表面的最小距离）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-10-07 13:25:29" itemprop="dateCreated datePublished" datetime="2014-10-07T13:25:29+08:00">2014-10-07</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 20:55:06" itemprop="dateModified" datetime="2018-07-29T20:55:06+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/算法/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/" itemprop="url" rel="index"><span itemprop="name">HDU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/计算几何/" itemprop="url" rel="index"><span itemprop="name">计算几何</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=4273" target="_blank" rel="noopener">HDU4273</a>   测试模板！ 求三维凸包，然后找重点，然后求重点到每个表面的距离。  </p>
<h1 id="Rescue"><a href="#Rescue" class="headerlink" title="Rescue"></a>Rescue</h1><p><strong>Time Limit: 2000/1000 MS (Java/Others)    Memory Limit: 32768/32768 K (Java/Others) Total Submission(s): 326    Accepted Submission(s): 234</strong></p>
<p>Problem Description</p>
<p>I work at NASA outer space rescue team which needs much courage and patient. In daily life, I always receive a lot of mission, and I must complete it right now. Today, team leader announced me that there is a huge spaceship dropping anchor in the out space, and we should reach there for rescue. As a working principle, at first, we should check whether there are persons living in the spaceship. So we carry a kind of machine called life sensor which can sense the life phenomenon when the distance between the machine and the living is not farther than the sense radius. I have read the designing paper of the spaceship in advance. It has a form of a convex polyhedron, and we can assume it is isodense. For best control, control center of the whole ship is located at the center of the mass. It is sure that if someone is still alive, he will stay at the control center. It’s unfortunately that I find the door is stocked when I try to enter into the spaceship, so I can only sense the living out of the space ship. Now I have opened the machine and it’s time to set the sense radius of it. I wonder the minimal radius of the machine which can allowe me to check whether there are persons living in the spaceship.</p>
<p>Input</p>
<p>There are multiple test cases. The first line contains an integer n indicating the number of vertices of the polyhedron. (4 &lt;= n &lt;= 100) Each of the next n lines contains three integers xi, yi, zi, the coordinates of the polyhedron vertices (-10,000 &lt;= xi, yi, zi &lt;= 10,000). It guaranteed that the given points are vertices of the convex polyhedron, and the polyhedron is non-degenerate.</p>
<p>Output</p>
<p>For each test case, output a float number indicating the minimal radius of the machine. Your answer should accurate up to 0.001.</p>
<p>Sample Input</p>
<p>4 0 0 0 1 0 0 0 1 0 0 0 1 8 0 0 0 0 0 2 0 2 0 0 2 2 2 0 0 2 0 2 2 2 0 2 2 2</p>
<p>Sample Output</p>
<p>0.144 1.000</p>
<p>Source</p>
<p><a href="http://acm.hdu.edu.cn/search.php?field=problem&amp;key=2012+ACM%2FICPC+Asia+Regional+Changchun+Online&amp;source=1&amp;searchmode=source" target="_blank" rel="noopener">2012 ACM/ICPC Asia Regional Changchun Online</a></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ***************</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Author        :kuangbin</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Created Time  :2014/10/7 8:36:38</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">File Name     :E:\2014ACM\专题学习\计算几何\三维几何\HDU4273.cpp</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">************************************************ */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-8</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">550</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sgn</span><span class="params">(<span class="keyword">double</span> x)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">fabs</span>(x) &lt; eps)<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(x &lt; <span class="number">0</span>)<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point3</span>&#123;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">double</span> x,y,z;</span><br><span class="line"></span><br><span class="line">	Point3(<span class="keyword">double</span> _x = <span class="number">0</span>, <span class="keyword">double</span> _y = <span class="number">0</span>, <span class="keyword">double</span> _z = <span class="number">0</span>)&#123;</span><br><span class="line"></span><br><span class="line">		x = _x;</span><br><span class="line"></span><br><span class="line">		y = _y;</span><br><span class="line"></span><br><span class="line">		z = _z;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">input</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%lf%lf%lf"</span>,&amp;x,&amp;y,&amp;z);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span> ==(<span class="keyword">const</span> Point3 &amp;b)<span class="keyword">const</span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> sgn(x-b.x) == <span class="number">0</span> &amp;&amp; sgn(y-b.y) == <span class="number">0</span> &amp;&amp; sgn(z-b.z) == <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">double</span> <span class="title">len</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">sqrt</span>(x*x+y*y+z*z);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">double</span> <span class="title">len2</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> x*x+y*y+z*z;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">double</span> <span class="title">distance</span><span class="params">(<span class="keyword">const</span> Point3 &amp;b)</span><span class="keyword">const</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">sqrt</span>((x-b.x)(x-b.x)+(y-b.y)(y-b.y)+(z-b.z)*(z-b.z));</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Point3 <span class="keyword">operator</span> -(<span class="keyword">const</span> Point3 &amp;b)<span class="keyword">const</span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> Point3(x-b.x,y-b.y,z-b.z);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Point3 <span class="keyword">operator</span> +(<span class="keyword">const</span> Point3 &amp;b)<span class="keyword">const</span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> Point3(x+b.x,y+b.y,z+b.z);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Point3 <span class="keyword">operator</span> *(<span class="keyword">const</span> <span class="keyword">double</span> &amp;k)<span class="keyword">const</span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> Point3(x*k,y*k,z*k);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Point3 <span class="keyword">operator</span> /(<span class="keyword">const</span> <span class="keyword">double</span> &amp;k)<span class="keyword">const</span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> Point3(x/k,y/k,z/k);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//点乘</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">double</span> <span class="keyword">operator</span> *(<span class="keyword">const</span> Point3 &amp;b)<span class="keyword">const</span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> x*b.x + y*b.y + z*b.z;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//叉乘</span></span><br><span class="line"></span><br><span class="line">	Point3 <span class="keyword">operator</span> ^(<span class="keyword">const</span> Point3 &amp;b)<span class="keyword">const</span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> Point3(y*b.z-z*b.y,z*b.x-x*b.z,x*b.y-y*b.x);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">CH3D</span>&#123;</span></span><br><span class="line"></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">face</span>&#123;</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">//表示凸包一个面上的三个点的编号</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> a,b,c;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//表示该面是否属于最终的凸包上的面</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">bool</span> ok;</span><br><span class="line"></span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//初始顶点数</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line"></span><br><span class="line">	Point3 P[MAXN];</span><br><span class="line"></span><br><span class="line">	<span class="comment">//凸包表面的三角形数</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> num;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//凸包表面的三角形</span></span><br><span class="line"></span><br><span class="line">	face F[<span class="number">8</span>*MAXN];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> g[MAXN][MAXN];</span><br><span class="line"></span><br><span class="line">	<span class="comment">//叉乘</span></span><br><span class="line"></span><br><span class="line">	<span class="function">Point3 <span class="title">cross</span><span class="params">(<span class="keyword">const</span> Point3 &amp;a,<span class="keyword">const</span> Point3 &amp;b,<span class="keyword">const</span> Point3 &amp;c)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> (b-a)^(c-a);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//三角形面积*2</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">double</span> <span class="title">area</span><span class="params">(Point3 a,Point3 b,Point3 c)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> ((b-a)^(c-a)).len();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//四面体有向面积*6</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">double</span> <span class="title">volume</span><span class="params">(Point3 a,Point3 b,Point3 c,Point3 d)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> ((b-a)^(c-a))*(d-a);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//正：点在面同向</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">double</span> <span class="title">dblcmp</span><span class="params">(Point3 &amp;p,face &amp;f)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		Point3 p1 = P[f.b] - P[f.a];</span><br><span class="line"></span><br><span class="line">		Point3 p2 = P[f.c] - P[f.a];</span><br><span class="line"></span><br><span class="line">		Point3 p3 = p - P[f.a];</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> (p1^p2)*p3;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">deal</span><span class="params">(<span class="keyword">int</span> p,<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> f = g[a][b];</span><br><span class="line"></span><br><span class="line">		face add;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(F[f].ok)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(dblcmp(P[p],F[f]) &gt; eps)</span><br><span class="line"></span><br><span class="line">				dfs(p,f);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">				add.a = b;</span><br><span class="line"></span><br><span class="line">				add.b = a;</span><br><span class="line"></span><br><span class="line">				add.c = p;</span><br><span class="line"></span><br><span class="line">				add.ok = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">				g[p][b] = g[a][p] = g[b][a] = num;</span><br><span class="line"></span><br><span class="line">				F[num++] = add;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//递归搜索所有应该从凸包内删除的面</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> p,<span class="keyword">int</span> now)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		F[now].ok = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">		deal(p,F[now].b,F[now].a);</span><br><span class="line"></span><br><span class="line">		deal(p,F[now].c,F[now].b);</span><br><span class="line"></span><br><span class="line">		deal(p,F[now].a,F[now].c);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">same</span><span class="params">(<span class="keyword">int</span> s,<span class="keyword">int</span> t)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		Point3 &amp;a = P[F[s].a];</span><br><span class="line"></span><br><span class="line">		Point3 &amp;b = P[F[s].b];</span><br><span class="line"></span><br><span class="line">		Point3 &amp;c = P[F[s].c];</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">fabs</span>(volume(a,b,c,P[F[t].a])) &lt; eps &amp;&amp;</span><br><span class="line"></span><br><span class="line">			<span class="built_in">fabs</span>(volume(a,b,c,P[F[t].b])) &lt; eps &amp;&amp;</span><br><span class="line"></span><br><span class="line">			<span class="built_in">fabs</span>(volume(a,b,c,P[F[t].c])) &lt; eps;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//构建三维凸包</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">create</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		num = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		face add;</span><br><span class="line"></span><br><span class="line">    	<span class="comment">//***********************************</span></span><br><span class="line">    	<span class="comment">//此段是为了保证前四个点不共面</span></span><br><span class="line">    	<span class="keyword">bool</span> flag = <span class="literal">true</span>;</span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; n;i++)&#123;</span><br><span class="line">    		<span class="keyword">if</span>(!(P\[<span class="number">0</span>\] == P\[i\]))&#123;</span><br><span class="line">    			swap(P\[<span class="number">1</span>\],P\[i\]);</span><br><span class="line">    			flag = <span class="literal">false</span>;</span><br><span class="line">    			<span class="keyword">break</span>;</span><br><span class="line">    		&#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">if</span>(flag)<span class="keyword">return</span>;</span><br><span class="line">    	flag = <span class="literal">true</span>;</span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt; n;i++)&#123;</span><br><span class="line">    		<span class="keyword">if</span>( ((P\[<span class="number">1</span>\]-P\[<span class="number">0</span>\])^(P\[i\]-P\[<span class="number">0</span>\])).len() &gt; eps )&#123;</span><br><span class="line">    			swap(P\[<span class="number">2</span>\],P\[i\]);</span><br><span class="line">    			flag = <span class="literal">false</span>;</span><br><span class="line">    			<span class="keyword">break</span>;</span><br><span class="line">    		&#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">if</span>(flag)<span class="keyword">return</span>;</span><br><span class="line">    	flag = <span class="literal">true</span>;</span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">3</span>;i &lt; n;i++)&#123;</span><br><span class="line">    		<span class="keyword">if</span>(<span class="built_in">fabs</span>( ((P\[<span class="number">1</span>\]-P\[<span class="number">0</span>\])^(P\[<span class="number">2</span>\]-P\[<span class="number">0</span>\]))*(P\[i\]-P\[<span class="number">0</span>\]) ) &gt; eps)&#123;</span><br><span class="line">    			swap(P\[<span class="number">3</span>\],P\[i\]);</span><br><span class="line">    			flag = <span class="literal">false</span>;</span><br><span class="line">    			<span class="keyword">break</span>;</span><br><span class="line">    		&#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">if</span>(flag)<span class="keyword">return</span>;</span><br><span class="line">    	<span class="comment">//**********************************</span></span><br><span class="line">    </span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">4</span>;i++)&#123;</span><br><span class="line">    		add.a = (i+<span class="number">1</span>)%<span class="number">4</span>;</span><br><span class="line">    		add.b = (i+<span class="number">2</span>)%<span class="number">4</span>;</span><br><span class="line">    		add.c = (i+<span class="number">3</span>)%<span class="number">4</span>;</span><br><span class="line">    		add.ok = <span class="literal">true</span>;</span><br><span class="line">    		<span class="keyword">if</span>(dblcmp(P\[i\],add) &gt; <span class="number">0</span>)swap(add.b,add.c);</span><br><span class="line">    		g\[add.a\]\[add.b\] = g\[add.b\]\[add.c\] = g\[add.c\]\[add.a\] = num;</span><br><span class="line">    		F\[num++\] = add;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">4</span>;i &lt; n;i++)</span><br><span class="line">    		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; num;j++)</span><br><span class="line">    			<span class="keyword">if</span>(F\[j\].ok &amp;&amp; dblcmp(P\[i\],F\[j\]) &gt; eps)&#123;</span><br><span class="line">    				dfs(i,j);</span><br><span class="line">    				<span class="keyword">break</span>;</span><br><span class="line">    			&#125;</span><br><span class="line">    	<span class="keyword">int</span> tmp = num;</span><br><span class="line">    	num = <span class="number">0</span>;</span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; tmp;i++)</span><br><span class="line">    		<span class="keyword">if</span>(F\[i\].ok)</span><br><span class="line">    			F\[num++\] = F\[i\];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//表面积</span></span><br><span class="line">    <span class="comment">//测试：HDU3528</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">area</span><span class="params">()</span></span>&#123;</span><br><span class="line">    	<span class="keyword">double</span> res = <span class="number">0</span>;</span><br><span class="line">    	<span class="keyword">if</span>(n == <span class="number">3</span>)&#123;</span><br><span class="line">    		Point3 p = cross(P\[<span class="number">0</span>\],P\[<span class="number">1</span>\],P\[<span class="number">2</span>\]);</span><br><span class="line">    		<span class="keyword">return</span> p.len()/<span class="number">2</span>;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; num;i++)</span><br><span class="line">    		res += area(P\[F\[i\].a\],P\[F\[i\].b\],P\[F\[i\].c\]);</span><br><span class="line">    	<span class="keyword">return</span> res/<span class="number">2.0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">volume</span><span class="params">()</span></span>&#123;</span><br><span class="line">    	<span class="keyword">double</span> res = <span class="number">0</span>;</span><br><span class="line">    	Point3 tmp = Point3(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; num;i++)</span><br><span class="line">    		res += volume(tmp,P\[F\[i\].a\],P\[F\[i\].b\],P\[F\[i\].c\]);</span><br><span class="line">    	<span class="keyword">return</span> <span class="built_in">fabs</span>(res/<span class="number">6</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//表面三角形个数</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">triangle</span><span class="params">()</span></span>&#123;</span><br><span class="line">    	<span class="keyword">return</span> num;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//表面多边形个数</span></span><br><span class="line">    <span class="comment">//测试：HDU3662</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">polygon</span><span class="params">()</span></span>&#123;</span><br><span class="line">    	<span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; num;i++)&#123;</span><br><span class="line">    		<span class="keyword">bool</span> flag = <span class="literal">true</span>;</span><br><span class="line">    		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; i;j++)</span><br><span class="line">    			<span class="keyword">if</span>(same(i,j))&#123;</span><br><span class="line">    				flag = <span class="number">0</span>;</span><br><span class="line">    				<span class="keyword">break</span>;</span><br><span class="line">    			&#125;</span><br><span class="line">    		res += flag;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//重心</span></span><br><span class="line">    <span class="comment">//测试：HDU4273</span></span><br><span class="line">    <span class="function">Point3 <span class="title">barycenter</span><span class="params">()</span></span>&#123;</span><br><span class="line">    	Point3 ans = Point3(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">    	Point3 o = Point3(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">    	<span class="keyword">double</span> all = <span class="number">0</span>;</span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; num;i++)&#123;</span><br><span class="line">    		<span class="keyword">double</span> vol = volume(o,P\[F\[i\].a\],P\[F\[i\].b\],P\[F\[i\].c\]);</span><br><span class="line">    		ans = ans + (((o+P\[F\[i\].a\]+P\[F\[i\].b\]+P\[F\[i\].c\])/<span class="number">4.0</span>)*vol);</span><br><span class="line">    		all += vol;</span><br><span class="line">    	&#125;</span><br><span class="line">    	ans = ans/all;</span><br><span class="line">    	<span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//点到面的距离</span></span><br><span class="line">    <span class="comment">//测试：HDU4273</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">ptoface</span><span class="params">(Point3 p,<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">    	<span class="keyword">double</span> tmp1 = <span class="built_in">fabs</span>(volume(P\[F\[i\].a\],P\[F\[i\].b\],P\[F\[i\].c\],p));</span><br><span class="line">    	<span class="keyword">double</span> tmp2 = ((P\[F\[i\].b\]-P\[F\[i\].a\])^(P\[F\[i\].c\]-P\[F\[i\].a\])).len();</span><br><span class="line">    	<span class="keyword">return</span> tmp1/tmp2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">CH3D hull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("in.txt","r",stdin);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("out.txt","w",stdout);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;hull.n) == <span class="number">1</span>)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; hull.n;i++)hull.P[i].input();</span><br><span class="line"></span><br><span class="line">		hull.create();</span><br><span class="line"></span><br><span class="line">		Point3 p = hull.barycenter();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">double</span> ans = <span class="number">1e20</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; hull.num;i++)</span><br><span class="line"></span><br><span class="line">			ans = min(ans,hull.ptoface(p,i));</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%.3lf\n"</span>,ans);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/10/07/hdu3662/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/10/07/hdu3662/" itemprop="url">
                  HDU 3662 3D Convex Hull （三维凸包，求凸包多边形个数）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-10-07 13:22:30" itemprop="dateCreated datePublished" datetime="2014-10-07T13:22:30+08:00">2014-10-07</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 20:53:17" itemprop="dateModified" datetime="2018-07-29T20:53:17+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/算法/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/" itemprop="url" rel="index"><span itemprop="name">HDU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/计算几何/" itemprop="url" rel="index"><span itemprop="name">计算几何</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=3662" target="_blank" rel="noopener">HDU3662</a>   用来测试模板的，直接三维凸包，求凸包上的多边形个数。</p>
<h1 id="3D-Convex-Hull"><a href="#3D-Convex-Hull" class="headerlink" title="3D Convex Hull"></a>3D Convex Hull</h1><p><strong>Time Limit: 2000/1000 MS (Java/Others)    Memory Limit: 32768/32768 K (Java/Others) Total Submission(s): 1259    Accepted Submission(s): 652</strong></p>
<p>Problem Description</p>
<p>There are N points in 3D-space which make up a 3D-Convex hull*. How many faces does the 3D-convexhull have? It is guaranteed that all the points are not in the same plane.</p>
<p><img src="http://acm.hdu.edu.cn/data/images/C311-1003-1.jpg" alt=""></p>
<p>In case you don’t know the definition of convex hull, here we give you a clarification from Wikipedia: *Convex hull: In mathematics, the convex hull, for a set of points X in a real vector space V, is the minimal convex set containing X.</p>
<p>Input</p>
<p>There are several test cases. In each case the first line contains an integer N indicates the number of 3D-points (3&lt; N &lt;= 300), and then N lines follow, each line contains three numbers x, y, z (between -10000 and 10000) indicate the 3d-position of a point.</p>
<p>Output</p>
<p>Output the number of faces of the 3D-Convex hull.</p>
<p>Sample Input</p>
<p>7 1 1 0 1 -1 0 -1 1 0 -1 -1 0 0 0 1 0 0 0 0 0 -0.1 7 1 1 0 1 -1 0 -1 1 0 -1 -1 0 0 0 1 0 0 0 0 0 0.1</p>
<p>Sample Output</p>
<p>8 5</p>
<p>Source</p>
<p><a href="http://acm.hdu.edu.cn/search.php?field=problem&amp;key=2010+Asia+Regional+Harbin&amp;source=1&amp;searchmode=source" target="_blank" rel="noopener">2010 Asia Regional Harbin</a></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ***************</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Author        :kuangbin</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Created Time  :2014/10/7 12:16:51</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">File Name     :E:\2014ACM\专题学习\计算几何\三维几何\HDU3662.cpp</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">************************************************ */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-8</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">550</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sgn</span><span class="params">(<span class="keyword">double</span> x)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">fabs</span>(x) &lt; eps)<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(x &lt; <span class="number">0</span>)<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point3</span>&#123;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">double</span> x,y,z;</span><br><span class="line"></span><br><span class="line">	Point3(<span class="keyword">double</span> _x = <span class="number">0</span>, <span class="keyword">double</span> _y = <span class="number">0</span>, <span class="keyword">double</span> _z = <span class="number">0</span>)&#123;</span><br><span class="line"></span><br><span class="line">		x = _x;</span><br><span class="line"></span><br><span class="line">		y = _y;</span><br><span class="line"></span><br><span class="line">		z = _z;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">input</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%lf%lf%lf"</span>,&amp;x,&amp;y,&amp;z);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span> ==(<span class="keyword">const</span> Point3 &amp;b)<span class="keyword">const</span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> sgn(x-b.x) == <span class="number">0</span> &amp;&amp; sgn(y-b.y) == <span class="number">0</span> &amp;&amp; sgn(z-b.z) == <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">double</span> <span class="title">len</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">sqrt</span>(x*x+y*y+z*z);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">double</span> <span class="title">len2</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> x*x+y*y+z*z;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">double</span> <span class="title">distance</span><span class="params">(<span class="keyword">const</span> Point3 &amp;b)</span><span class="keyword">const</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">sqrt</span>((x-b.x)(x-b.x)+(y-b.y)(y-b.y)+(z-b.z)*(z-b.z));</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Point3 <span class="keyword">operator</span> -(<span class="keyword">const</span> Point3 &amp;b)<span class="keyword">const</span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> Point3(x-b.x,y-b.y,z-b.z);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Point3 <span class="keyword">operator</span> +(<span class="keyword">const</span> Point3 &amp;b)<span class="keyword">const</span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> Point3(x+b.x,y+b.y,z+b.z);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Point3 <span class="keyword">operator</span> *(<span class="keyword">const</span> <span class="keyword">double</span> &amp;k)<span class="keyword">const</span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> Point3(x*k,y*k,z*k);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Point3 <span class="keyword">operator</span> /(<span class="keyword">const</span> <span class="keyword">double</span> &amp;k)<span class="keyword">const</span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> Point3(x/k,y/k,z/k);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//点乘</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">double</span> <span class="keyword">operator</span> *(<span class="keyword">const</span> Point3 &amp;b)<span class="keyword">const</span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> x*b.x + y*b.y + z*b.z;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//叉乘</span></span><br><span class="line"></span><br><span class="line">	Point3 <span class="keyword">operator</span> ^(<span class="keyword">const</span> Point3 &amp;b)<span class="keyword">const</span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> Point3(y*b.z-z*b.y,z*b.x-x*b.z,x*b.y-y*b.x);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">CH3D</span>&#123;</span></span><br><span class="line"></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">face</span>&#123;</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">//表示凸包一个面上的三个点的编号</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> a,b,c;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//表示该面是否属于最终的凸包上的面</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">bool</span> ok;</span><br><span class="line"></span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//初始顶点数</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line"></span><br><span class="line">	Point3 P[MAXN];</span><br><span class="line"></span><br><span class="line">	<span class="comment">//凸包表面的三角形数</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> num;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//凸包表面的三角形</span></span><br><span class="line"></span><br><span class="line">	face F[<span class="number">8</span>*MAXN];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> g[MAXN][MAXN];</span><br><span class="line"></span><br><span class="line">	<span class="comment">//叉乘</span></span><br><span class="line"></span><br><span class="line">	<span class="function">Point3 <span class="title">cross</span><span class="params">(<span class="keyword">const</span> Point3 &amp;a,<span class="keyword">const</span> Point3 &amp;b,<span class="keyword">const</span> Point3 &amp;c)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> (b-a)^(c-a);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//三角形面积*2</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">double</span> <span class="title">area</span><span class="params">(Point3 a,Point3 b,Point3 c)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> ((b-a)^(c-a)).len();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//四面体有向面积*6</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">double</span> <span class="title">volume</span><span class="params">(Point3 a,Point3 b,Point3 c,Point3 d)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> ((b-a)^(c-a))*(d-a);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//正：点在面同向</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">double</span> <span class="title">dblcmp</span><span class="params">(Point3 &amp;p,face &amp;f)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		Point3 p1 = P[f.b] - P[f.a];</span><br><span class="line"></span><br><span class="line">		Point3 p2 = P[f.c] - P[f.a];</span><br><span class="line"></span><br><span class="line">		Point3 p3 = p - P[f.a];</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> (p1^p2)*p3;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">deal</span><span class="params">(<span class="keyword">int</span> p,<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> f = g[a][b];</span><br><span class="line"></span><br><span class="line">		face add;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(F[f].ok)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(dblcmp(P[p],F[f]) &gt; eps)</span><br><span class="line"></span><br><span class="line">				dfs(p,f);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">				add.a = b;</span><br><span class="line"></span><br><span class="line">				add.b = a;</span><br><span class="line"></span><br><span class="line">				add.c = p;</span><br><span class="line"></span><br><span class="line">				add.ok = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">				g[p][b] = g[a][p] = g[b][a] = num;</span><br><span class="line"></span><br><span class="line">				F[num++] = add;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//递归搜索所有应该从凸包内删除的面</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> p,<span class="keyword">int</span> now)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		F[now].ok = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">		deal(p,F[now].b,F[now].a);</span><br><span class="line"></span><br><span class="line">		deal(p,F[now].c,F[now].b);</span><br><span class="line"></span><br><span class="line">		deal(p,F[now].a,F[now].c);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">same</span><span class="params">(<span class="keyword">int</span> s,<span class="keyword">int</span> t)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		Point3 &amp;a = P[F[s].a];</span><br><span class="line"></span><br><span class="line">		Point3 &amp;b = P[F[s].b];</span><br><span class="line"></span><br><span class="line">		Point3 &amp;c = P[F[s].c];</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">fabs</span>(volume(a,b,c,P[F[t].a])) &lt; eps &amp;&amp;</span><br><span class="line"></span><br><span class="line">			<span class="built_in">fabs</span>(volume(a,b,c,P[F[t].b])) &lt; eps &amp;&amp;</span><br><span class="line"></span><br><span class="line">			<span class="built_in">fabs</span>(volume(a,b,c,P[F[t].c])) &lt; eps;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//构建三维凸包</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">create</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		num = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		face add;</span><br><span class="line"></span><br><span class="line">    	<span class="comment">//***********************************</span></span><br><span class="line">    	<span class="comment">//此段是为了保证前四个点不共面</span></span><br><span class="line">    	<span class="keyword">bool</span> flag = <span class="literal">true</span>;</span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; n;i++)&#123;</span><br><span class="line">    		<span class="keyword">if</span>(!(P\[<span class="number">0</span>\] == P\[i\]))&#123;</span><br><span class="line">    			swap(P\[<span class="number">1</span>\],P\[i\]);</span><br><span class="line">    			flag = <span class="literal">false</span>;</span><br><span class="line">    			<span class="keyword">break</span>;</span><br><span class="line">    		&#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">if</span>(flag)<span class="keyword">return</span>;</span><br><span class="line">    	flag = <span class="literal">true</span>;</span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt; n;i++)&#123;</span><br><span class="line">    		<span class="keyword">if</span>( ((P\[<span class="number">1</span>\]-P\[<span class="number">0</span>\])^(P\[i\]-P\[<span class="number">0</span>\])).len() &gt; eps )&#123;</span><br><span class="line">    			swap(P\[<span class="number">2</span>\],P\[i\]);</span><br><span class="line">    			flag = <span class="literal">false</span>;</span><br><span class="line">    			<span class="keyword">break</span>;</span><br><span class="line">    		&#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">if</span>(flag)<span class="keyword">return</span>;</span><br><span class="line">    	flag = <span class="literal">true</span>;</span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">3</span>;i &lt; n;i++)&#123;</span><br><span class="line">    		<span class="keyword">if</span>(<span class="built_in">fabs</span>( ((P\[<span class="number">1</span>\]-P\[<span class="number">0</span>\])^(P\[<span class="number">2</span>\]-P\[<span class="number">0</span>\]))*(P\[i\]-P\[<span class="number">0</span>\]) ) &gt; eps)&#123;</span><br><span class="line">    			swap(P\[<span class="number">3</span>\],P\[i\]);</span><br><span class="line">    			flag = <span class="literal">false</span>;</span><br><span class="line">    			<span class="keyword">break</span>;</span><br><span class="line">    		&#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">if</span>(flag)<span class="keyword">return</span>;</span><br><span class="line">    	<span class="comment">//**********************************</span></span><br><span class="line">    </span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">4</span>;i++)&#123;</span><br><span class="line">    		add.a = (i+<span class="number">1</span>)%<span class="number">4</span>;</span><br><span class="line">    		add.b = (i+<span class="number">2</span>)%<span class="number">4</span>;</span><br><span class="line">    		add.c = (i+<span class="number">3</span>)%<span class="number">4</span>;</span><br><span class="line">    		add.ok = <span class="literal">true</span>;</span><br><span class="line">    		<span class="keyword">if</span>(dblcmp(P\[i\],add) &gt; <span class="number">0</span>)swap(add.b,add.c);</span><br><span class="line">    		g\[add.a\]\[add.b\] = g\[add.b\]\[add.c\] = g\[add.c\]\[add.a\] = num;</span><br><span class="line">    		F\[num++\] = add;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">4</span>;i &lt; n;i++)</span><br><span class="line">    		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; num;j++)</span><br><span class="line">    			<span class="keyword">if</span>(F\[j\].ok &amp;&amp; dblcmp(P\[i\],F\[j\]) &gt; eps)&#123;</span><br><span class="line">    				dfs(i,j);</span><br><span class="line">    				<span class="keyword">break</span>;</span><br><span class="line">    			&#125;</span><br><span class="line">    	<span class="keyword">int</span> tmp = num;</span><br><span class="line">    	num = <span class="number">0</span>;</span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; tmp;i++)</span><br><span class="line">    		<span class="keyword">if</span>(F\[i\].ok)</span><br><span class="line">    			F\[num++\] = F\[i\];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//表面积</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">area</span><span class="params">()</span></span>&#123;</span><br><span class="line">    	<span class="keyword">double</span> res = <span class="number">0</span>;</span><br><span class="line">    	<span class="keyword">if</span>(n == <span class="number">3</span>)&#123;</span><br><span class="line">    		Point3 p = cross(P\[<span class="number">0</span>\],P\[<span class="number">1</span>\],P\[<span class="number">2</span>\]);</span><br><span class="line">    		<span class="keyword">return</span> p.len()/<span class="number">2</span>;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; num;i++)</span><br><span class="line">    		res += area(P\[F\[i\].a\],P\[F\[i\].b\],P\[F\[i\].c\]);</span><br><span class="line">    	<span class="keyword">return</span> res/<span class="number">2.0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">volume</span><span class="params">()</span></span>&#123;</span><br><span class="line">    	<span class="keyword">double</span> res = <span class="number">0</span>;</span><br><span class="line">    	Point3 tmp = Point3(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; num;i++)</span><br><span class="line">    		res += volume(tmp,P\[F\[i\].a\],P\[F\[i\].b\],P\[F\[i\].c\]);</span><br><span class="line">    	<span class="keyword">return</span> <span class="built_in">fabs</span>(res/<span class="number">6</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//表面三角形个数</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">triangle</span><span class="params">()</span></span>&#123;</span><br><span class="line">    	<span class="keyword">return</span> num;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//表面多边形个数</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">polygon</span><span class="params">()</span></span>&#123;</span><br><span class="line">    	<span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; num;i++)&#123;</span><br><span class="line">    		<span class="keyword">bool</span> flag = <span class="literal">true</span>;</span><br><span class="line">    		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; i;j++)</span><br><span class="line">    			<span class="keyword">if</span>(same(i,j))&#123;</span><br><span class="line">    				flag = <span class="number">0</span>;</span><br><span class="line">    				<span class="keyword">break</span>;</span><br><span class="line">    			&#125;</span><br><span class="line">    		res += flag;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//重心</span></span><br><span class="line">    <span class="function">Point3 <span class="title">barycenter</span><span class="params">()</span></span>&#123;</span><br><span class="line">    	Point3 ans = Point3(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">    	Point3 o = Point3(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">    	<span class="keyword">double</span> all = <span class="number">0</span>;</span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; num;i++)&#123;</span><br><span class="line">    		<span class="keyword">double</span> vol = volume(o,P\[F\[i\].a\],P\[F\[i\].b\],P\[F\[i\].c\]);</span><br><span class="line">    		ans = ans + (((o+P\[F\[i\].a\]+P\[F\[i\].b\]+P\[F\[i\].c\])/<span class="number">4.0</span>)*vol);</span><br><span class="line">    		all += vol;</span><br><span class="line">    	&#125;</span><br><span class="line">    	ans = ans/all;</span><br><span class="line">    	<span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//点到面的距离</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">ptoface</span><span class="params">(Point3 p,<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">    	<span class="keyword">double</span> tmp1 = <span class="built_in">fabs</span>(volume(P\[F\[i\].a\],P\[F\[i\].b\],P\[F\[i\].c\],p));</span><br><span class="line">    	<span class="keyword">double</span> tmp2 = ((P\[F\[i\].b\]-P\[F\[i\].a\])^(P\[F\[i\].c\]-P\[F\[i\].a\])).len();</span><br><span class="line">    	<span class="keyword">return</span> tmp1/tmp2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">CH3D hull;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("in.txt","r",stdin);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("out.txt","w",stdout);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;hull.n) == <span class="number">1</span>)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; hull.n;i++)hull.P[i].input();</span><br><span class="line"></span><br><span class="line">		hull.create();</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,hull.polygon());</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/10/07/zoj2865/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/10/07/zoj2865/" itemprop="url">
                  ZOJ 2865 A very easy task （自然数幂和）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-10-07 09:45:29" itemprop="dateCreated datePublished" datetime="2014-10-07T09:45:29+08:00">2014-10-07</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 13:43:28" itemprop="dateModified" datetime="2018-07-29T13:43:28+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Online-Judge/ZJU/" itemprop="url" rel="index"><span itemprop="name">ZJU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Online-Judge/ZJU/数学题/" itemprop="url" rel="index"><span itemprop="name">数学题</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Online-Judge/ZJU/数学题/算法/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>使用递推公式求解。 详见ACdreamer神牛博客：<a href="http://blog.csdn.net/acdreamers/article/details/38929067" target="_blank" rel="noopener">ACdreamer</a>   直接公式法去递推，用大数写了发JAVA</p>
<p>A very easy task</p>
<hr>
<p>Time Limit: 10 Seconds      Memory Limit: 32768 KB</p>
<hr>
<p>This task is very simple. You are to calculate ��ik (1 &lt;= i &lt;= n). <strong>Input:</strong> There are multiple cases in the input. Each case begins with two integer n and k (0 &lt;= n &lt;= 1050, 1 &lt;= k &lt;= 100). <strong>Output:</strong> For each test, print the answer in a single line. <strong>Sample Input:</strong></p>
<p>2 3<br>3 2</p>
<p><strong>Sample Output:</strong></p>
<p>9<br>14</p>
<hr>
<p>Author: <strong>SHANG, Zechao</strong> Source: <strong>ZOJ Monthly, June 2007</strong>      </p>
<p>import java.io.<em>;<br>import java.util.</em>;<br>import java.math.*;</p>
<p>public class Main<br>{<br>    static BigInteger C[][] = new BigInteger[110][110];</p>
<pre><code>public static void main(String\[\] args) throws IOException
{
    C\[0\]\[0\] = BigInteger.ONE;
    for(int i = 1;i &lt; 110;i++){
        C\[i\]\[0\] = C\[i\]\[i\] = BigInteger.ONE;
        for(int j = 1;j &lt; i;j++)
            C\[i\]\[j\] = C\[i-1\]\[j-1\].add(C\[i-1\]\[j\]);
    }
    Scanner cin = new Scanner(System.in);
    BigInteger n;
    int k;
    BigInteger A\[\] = new BigInteger\[110\];
    while(cin.hasNext()){
        n = cin.nextBigInteger();
        k = cin.nextInt();
        A\[0\] = n;
        for(int i = 1;i &lt;= k;i++){
            A\[i\] = n.add(BigInteger.ONE).pow(i+1);
            A\[i\] = A\[i\].subtract(BigInteger.ONE);
            for(int j = 2;j &lt;= i+1;j++){
                A\[i\] = A\[i\].subtract(C\[i+1\]\[j\].multiply(A\[i+1-j\]));
            }    
            A\[i\] = A\[i\].divide(BigInteger.valueOf(i+1));
        }
        System.out.println(A\[k\]);
    }
}
</code></pre><p>}</p>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/10/06/final-battle/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/10/06/final-battle/" itemprop="url">
                  Final Battle
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-10-06 21:26:49" itemprop="dateCreated datePublished" datetime="2014-10-06T21:26:49+08:00">2014-10-06</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 20:49:46" itemprop="dateModified" datetime="2018-07-29T20:49:46+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/小结/" itemprop="url" rel="index"><span itemprop="name">小结</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>今年将去1,2赛区。  最后的两场比赛将在牡丹江和鞍山结束。 选择前两个赛区主要是从时间上考虑， 这两个赛区都比较靠前， 我真的已经没有时间了，不能再往后拖了，积压了一大堆的事情要去做！ 而且前两年都是去的东北赛区，那今年也照样不例外吧！ 本来想留点时间去好好准备的，因为毕竟还准备的不充分，但是后来实际情况发现远远没有必要……. 无论如何，ICPC生涯的最后两场比赛我会认真做好自己该做的，争取一切顺利吧！   国庆放假的7天，和以前一样，放假的话比不放假会更忙。 前面5天，早上起来看书写代码，然后下午组队训练，晚上回来看看文献，总结。 训练了5天感觉好累了，加上魔都天气变化太快，有点感冒的感觉，然后休息了一整天。   之后把模板整理了一下，弄成了一份将近300页的模板，感觉我会的也就这么些了。 其实模板都是浮云，几乎也用不上，只是偶尔可能用上，心理上踏实点。     慢慢地把很多群都退掉了，自己也不再去水群了，很快我将淡出这个圈子，这个圈子已经不属于我。 这期间认识的很多人，将会是最有价值的财富。 感觉很多的人给我的鼓励和帮助！         最后一战！ 必将全力以赴。 正如岐哥说的要不留遗憾。但愿一个队可以全心协力，努力做到最好！</p>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/10/05/zoj3816/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/10/05/zoj3816/" itemprop="url">
                  ZOJ 3816 Generalized Palindromic Number （数位DP+二分）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-10-05 10:01:07" itemprop="dateCreated datePublished" datetime="2014-10-05T10:01:07+08:00">2014-10-05</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 13:43:28" itemprop="dateModified" datetime="2018-07-29T13:43:28+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Online-Judge/ZJU/" itemprop="url" rel="index"><span itemprop="name">ZJU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Online-Judge/ZJU/数位DP/" itemprop="url" rel="index"><span itemprop="name">数位DP</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Online-Judge/ZJU/数位DP/算法/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://acm.zju.edu.cn/onlinejudge/showProblem.do?problemId=5348" target="_blank" rel="noopener">ZOJ3816</a>   这题方法很多，暴力的做法我还没看懂， 只会用数位DP搞。 二分区间，然后数位DP求个数就可以了。</p>
<p>Generalized Palindromic Number</p>
<hr>
<p>Time Limit: 2 Seconds      Memory Limit: 65536 KB</p>
<hr>
<p>A number that will be the same when it is written forwards or backwards is known as a palindromic number. For example, 1234321 is a palindromic number. We call a number <strong>generalized palindromic number</strong>, if after merging all the consecutive same digits, the resulting number is a palindromic number. For example, 122111 is a generalized palindromic number. Because after merging, 122111 turns into 121 which is a palindromic number. Now you are given a positive integer N, please find the largest generalized palindromic number less than N.</p>
<h4 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h4><p>There are multiple test cases. The first line of input contains an integer T (about 5000) indicating the number of test cases. For each test case: There is only one integer N (1 &lt;= N &lt;= 1018).</p>
<h4 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h4><p>For each test case, output the largest generalized palindromic number less than N.</p>
<h4 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h4><p>4<br>12<br>123<br>1224<br>1122</p>
<h4 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h4><p>11<br>121<br>1221<br>1121</p>
<hr>
<p>Author: <strong>LIN, Xi</strong> Source: <strong>The 2014 ACM-ICPC Asia Mudanjiang Regional First Round</strong>    </p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include <algorithm></algorithm></p>
<p>#include <iostream></iostream></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include &lt;string.h&gt;</p>
<p>#include <map></map></p>
<p>#include <vector></vector></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;<br>using namespace std;<br>long long dp[20][20][20];<br>int bit[30];<br>int num[30];<br>long long dfs(int pos,int now,int aim,bool limit){<br>    if(pos &lt; 0)return now == aim;<br>    if(!limit &amp;&amp; dp[pos][now][aim] != -1)<br>        return dp[pos][now][aim];<br>    int end = limit ? bit[pos] : 9;<br>    long long ans = 0;<br>    for(int i = 0;i &lt;= end;i++){<br>        if(now == 0){<br>            if(i == 0){<br>                ans += dfs(pos-1,now,aim,limit &amp;&amp; (i == end));<br>            }<br>            else {<br>                num[now] = i;<br>                if(now &lt; aim)ans += dfs(pos-1,now+1,aim,limit &amp;&amp; (i == end));<br>            }<br>        }<br>        else {<br>            if(i == num[now-1])ans += dfs(pos-1,now,aim,limit &amp;&amp; (i == end));<br>            else {<br>                num[now] = i;<br>                if(now &lt; (aim+1)/2){<br>                    if(now &lt; aim)ans += dfs(pos-1,now+1,aim,limit &amp;&amp; (i == end));<br>                }<br>                else {<br>                    if(i != num[aim-1-now])continue;<br>                    if(now &lt; aim)ans += dfs(pos-1,now+1,aim,limit &amp;&amp; (i == end));<br>                }<br>            }<br>        }<br>    }<br>    if(!limit)dp[pos][now][aim] = ans;<br>    return ans;<br>}<br>long long calc(long long n){<br>    int pos = 0;<br>    do{<br>        bit[pos++] = n%10;<br>        n /= 10;<br>    }while(n);<br>    long long ans = 0;<br>    for(int i = 1;i &lt;= pos;i++)<br>        ans += dfs(pos-1,0,i,1);<br>    return ans;<br>}</p>
<p>int main()<br>{<br>    //freopen(“in.txt”,”r”,stdin);<br>    //freopen(“out.txt”,”w”,stdout);<br>    int T;<br>    scanf(“%d”,&amp;T);<br>    long long n;<br>    memset(dp,-1,sizeof(dp));<br>    while(T–){<br>        scanf(“%lld”,&amp;n);<br>        n–;<br>        long long tmp = calc(n);<br>        long long l = 0, r = n;<br>        long long ans = 0;<br>        while(l &lt;= r){<br>            long long mid = (l+r)/2;<br>            if(calc(mid) &gt;= tmp){<br>                ans = mid;<br>                r = mid-1;<br>            }<br>            else l = mid+1;<br>        }<br>        printf(“%lld\n”,ans);<br>    }<br>    return 0;<br>}</p>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/4/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><a class="extend next" rel="next" href="/page/6/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/blogLogo.jpg"
                alt="kuangbin" />
            
              <p class="site-author-name" itemprop="name">kuangbin</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">127</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">150</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">53</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  <a href="https://github.com/kuangbin" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:kuangbin2009@126.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://www.zhihu.com/people/kuang-bin-95" target="_blank" title="zhihu"><i class="fa fa-fw fa-globe"></i>zhihu</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="http://www.cnblogs.com/kuangbin/" target="_blank" title="cnblogs"><i class="fa fa-fw fa-globe"></i>cnblogs</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="http://wpa.qq.com/msgrd?v=3&uin=1691626124&site=qq&menu=yes" target="_blank" title="QQ"><i class="fa fa-fw fa-globe"></i>QQ</a>
                  
                </span>
              
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-友情链接"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.cnblogs.com/kuangbin/" title="我的博客园" target="_blank">我的博客园</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://zhiyi.live/" title="MoonChasing" target="_blank">MoonChasing</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://taowusheng.cn/" title="YIFEI" target="_blank">YIFEI</a>
                  </li>
                
              </ul>
            </div>
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">kuangbin</span>

  

  
</div>




  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动 v3.7.1</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://theme-next.org">NexT.Pisces</a> v6.3.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>












  















  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.3.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.3.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.3.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.3.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.3.0"></script>



  



  










  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  
  

  

  

  

  

  

</body>
</html>
