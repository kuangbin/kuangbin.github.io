<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">






  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-flash.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.3.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.3.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.3.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '6.3.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="kuangbin的博客">
<meta property="og:url" content="http://kuangbin.github.io/page/9/index.html">
<meta property="og:site_name" content="kuangbin的博客">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="kuangbin的博客">



  <link rel="alternate" href="/atom.xml" title="kuangbin的博客" type="application/atom+xml" />




  <link rel="canonical" href="http://kuangbin.github.io/page/9/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>kuangbin的博客</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>
	
	<a href="https://github.com/kuangbin"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png" alt="Fork me on GitHub"></a>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">kuangbin的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首页</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-about">
    <a href="/about/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-user"></i> <br />关于</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />标签</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />分类</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />归档</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-catalogue">
    <a href="/catalogue/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />目录</a>
  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/09/04/hdu4742-cdq/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/09/04/hdu4742-cdq/" itemprop="url">
                  HDU 4742 Pinball Game 3D （cdq分治）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-09-04 23:10:38" itemprop="dateCreated datePublished" datetime="2014-09-04T23:10:38+08:00">2014-09-04</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 20:59:24" itemprop="dateModified" datetime="2018-07-29T20:59:24+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/算法/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/" itemprop="url" rel="index"><span itemprop="name">HDU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/cdq分治/" itemprop="url" rel="index"><span itemprop="name">cdq分治</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="HDU4742"><a href="#HDU4742" class="headerlink" title="HDU4742"></a><a href="http://acm.hdu.edu.cn/showproblem.php?pid=4742" target="_blank" rel="noopener">HDU4742</a></h2><p>  经典题，可以用树套树，也可以用cdq分治，还是cdq分治写起来比较方便！  </p>
<h1 id="Pinball-Game-3D"><a href="#Pinball-Game-3D" class="headerlink" title="Pinball Game 3D"></a>Pinball Game 3D</h1><p><strong>Time Limit: 10000/5000 MS (Java/Others)    Memory Limit: 32768/32768 K (Java/Others) Total Submission(s): 630    Accepted Submission(s): 254</strong>  </p>
<p>Problem Description</p>
<p>RD is a smart boy and excel in pinball game. However, playing common 2D pinball game for a great number of times results in accumulating tedium.Recently, RD has found a new type of pinball game, a 3D pinball game. The 3D pinball game space can be regarded as a three dimensional coordinate system containing N balls. A ball can be considered as a point. At the beginning, RD made a shot and hit a ball. The ball hit by RD will move and may hit another ball and the “another ball” may move and hit another another ball, etc. But once a ball hit another ball, it will disappear. RD is skilled in this kind of game, so he is able to control every ball’s moving direction. But there is a limitation: if ball A’s coordinate is (x1,y1,z1) and ball B’s coordinate is (x2,y2,z2), then A can hit B only if x1 &lt;= x2 and y1 &lt;= y2 and z1 &lt;= z2. Now, you should help RD to calculate the maximum number of balls that can be hit and the number of different shooting schemes that can achieve that number. Two schemes are different if the sets of hit balls are not the same. The order doesn’t matter.</p>
<p>Input</p>
<p>The first line contains one integer T indicating the number of cases. In each case, the first line contains one integer N indicating the number of balls. The next N lines each contains three non-negative integer (x, y, z), indicating the coordinate of a ball. The data satisfies T &lt;= 3, N &lt;= 105, 0 &lt;= x, y, z &lt;= 230, no two balls have the same coordinate in one case.</p>
<p>Output</p>
<p>Print two integers for each case in a line, indicating the maximum number of balls that can be hit and the number of different shooting schemes. As the number of schemes can be quite large, you should output this number mod 230.</p>
<p>Sample Input</p>
<p>2 3 2 0 0 0 1 0 0 1 1 5 3 0 0 0 1 0 0 0 1 0 2 2 3 3 3</p>
<p>Sample Output</p>
<p>2 1 3 2</p>
<p><em>Hint</em></p>
<p>In the first case, RD can shoot the second ball at first and hit the third ball indirectly. In the second case, RD can shoot the second or the third ball initially and hit the fourth ball as well as the fifth ball. Two schemes are both the best.</p>
<p>Source</p>
<p><a href="http://acm.hdu.edu.cn/search.php?field=problem&amp;key=2013%20ACM/ICPC%20Asia%20Regional%20Hangzhou%20Online&amp;source=1&amp;searchmode=source" target="_blank" rel="noopener">2013 ACM/ICPC Asia Regional Hangzhou Online</a></p>
<pre><code>就是三维的LIS。 按照x排序可以减少一维，然后使用cdq分治的方法，用左边的去更新右边的，按照y的顺序加入。   要对z进行离散化。  
</code></pre><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ***************</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Author        :kuangbin</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Created Time  :2014/9/4 21:53:53</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">File Name     :E:\2014ACM\专题学习\CDQ分治\HDU4742.cpp</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">************************************************ */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">100010</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MOD = (<span class="number">1</span>&lt;&lt;<span class="number">30</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;&amp;p1,pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;p2)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(p1.first &lt; p2.first)p1 = p2;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(p1.first == p2.first)&#123;</span><br><span class="line"></span><br><span class="line">		p1.second += p2.second;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(p1.second &gt;= MOD)p1.second -= MOD;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;dp[MAXN];</span><br><span class="line"></span><br><span class="line">pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;c[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lowbit</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> x&amp;(-x);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> i,pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;val)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(i &lt;= n)&#123;</span><br><span class="line"></span><br><span class="line">		update(c[i],val);</span><br><span class="line"></span><br><span class="line">		i += lowbit(i);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; sum(<span class="keyword">int</span> i)&#123;</span><br><span class="line"></span><br><span class="line">	pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;res = make_pair(<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(i &gt; <span class="number">0</span>)&#123;</span><br><span class="line"></span><br><span class="line">		update(res,c[i]);</span><br><span class="line"></span><br><span class="line">		i -= lowbit(i);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> res;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CLR</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(i &lt;= n)&#123;</span><br><span class="line"></span><br><span class="line">		c[i] = make_pair(<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">		i += lowbit(i);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span>&#123;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> x,y,z;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> id;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">input</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;x,&amp;y,&amp;z);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;p[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmpx</span><span class="params">(Point a,Point b)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(a.x != b.x)<span class="keyword">return</span> a.x &lt; b.x;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(a.y != b.y)<span class="keyword">return</span> a.y &lt; b.y;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">return</span> a.z &lt; b.z;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmpy</span><span class="params">(Point a,Point b)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(a.y != b.y)<span class="keyword">return</span> a.y &lt; b.y;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">return</span> a.z &lt; b.z;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> zz[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(l == r)<span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> mid = (l+r)/<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">	solve(l,mid);</span><br><span class="line"></span><br><span class="line">	sort(p+l,p+mid+<span class="number">1</span>,cmpy);</span><br><span class="line"></span><br><span class="line">	sort(p+mid+<span class="number">1</span>,p+r+<span class="number">1</span>,cmpy);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> j = l;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = mid+<span class="number">1</span>;i &lt;= r;i++)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span>(j &lt;= mid &amp;&amp; p[j].y &lt;= p[i].y)</span><br><span class="line"></span><br><span class="line">		&#123;</span><br><span class="line"></span><br><span class="line">			add(p[j].z,dp[p[j].id]);</span><br><span class="line"></span><br><span class="line">			j++;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; res = sum(p[i].z);</span><br><span class="line"></span><br><span class="line">		res.first++;</span><br><span class="line"></span><br><span class="line">		update(dp[p[i].id],res);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = l;i &lt;= mid;i++)CLR(p[i].z);</span><br><span class="line"></span><br><span class="line">	sort(p+mid+<span class="number">1</span>,p+r+<span class="number">1</span>,cmpx);</span><br><span class="line"></span><br><span class="line">	solve(mid+<span class="number">1</span>,r);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("in.txt","r",stdin);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("out.txt","w",stdout);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(T--)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line"></span><br><span class="line">			p[i].input();</span><br><span class="line"></span><br><span class="line">			zz[++cnt] = p[i].z;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		sort(zz+<span class="number">1</span>,zz+cnt+<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">		cnt = unique(zz+<span class="number">1</span>,zz+cnt+<span class="number">1</span>)-zz<span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)</span><br><span class="line"></span><br><span class="line">			p[i].z = lower_bound(zz+<span class="number">1</span>,zz+cnt+<span class="number">1</span>,p[i].z)-zz;</span><br><span class="line"></span><br><span class="line">		sort(p+<span class="number">1</span>,p+n+<span class="number">1</span>,cmpx);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)</span><br><span class="line"></span><br><span class="line">			p[i].id = i;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line"></span><br><span class="line">			c[i] = make_pair(<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">			dp[i] = make_pair(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		solve(<span class="number">1</span>,n);</span><br><span class="line"></span><br><span class="line">		pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;ans = make_pair(<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)</span><br><span class="line"></span><br><span class="line">			update(ans,dp[i]);</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>,ans.first,ans.second);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    
	
	<div>
		
	</div>
 
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/08/29/qtree-lct/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/08/29/qtree-lct/" itemprop="url">
                  QTREE系列1~7 的 LCT解法
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-08-29 10:26:35" itemprop="dateCreated datePublished" datetime="2014-08-29T10:26:35+08:00">2014-08-29</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 13:43:28" itemprop="dateModified" datetime="2018-07-29T13:43:28+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/LCT/" itemprop="url" rel="index"><span itemprop="name">LCT</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/LCT/数据结构/" itemprop="url" rel="index"><span itemprop="name">数据结构</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/LCT/数据结构/算法/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="早就想把QTREE序列搞完的，一直拖到现在才搞。-使用LCT把QTREE序列都搞了一遍。"><a href="#早就想把QTREE序列搞完的，一直拖到现在才搞。-使用LCT把QTREE序列都搞了一遍。" class="headerlink" title="早就想把QTREE序列搞完的，一直拖到现在才搞。 使用LCT把QTREE序列都搞了一遍。"></a>早就想把QTREE序列搞完的，一直拖到现在才搞。 使用LCT把QTREE序列都搞了一遍。</h2><h3 id="先贴个题目链接："><a href="#先贴个题目链接：" class="headerlink" title="先贴个题目链接："></a>先贴个题目链接：</h3><p><a href="http://www.spoj.com/problems/QTREE/" target="_blank" rel="noopener">QTREE1</a> <a href="http://www.spoj.com/problems/QTREE2/" target="_blank" rel="noopener">QTREE2</a> <a href="http://www.spoj.com/problems/QTREE3/" target="_blank" rel="noopener">QTREE3</a> <a href="http://www.spoj.com/problems/QTREE4/" target="_blank" rel="noopener">QTREE4</a> <a href="http://www.spoj.com/problems/QTREE5/" target="_blank" rel="noopener">QTREE5</a> <a href="http://www.spoj.com/problems/QTREE6/" target="_blank" rel="noopener">QTREE6</a> <a href="http://www.spoj.com/problems/QTREE7/" target="_blank" rel="noopener">QTREE7</a>   QTREE6和QTREE7是岛娘的经典之作，简直不能更经典。 QTREE1，QTRE2，QTREE3都是比较水的了，搞路径的都比较简单，QTREE4和QTREE5是子树的比较赞。    </p>
<h2 id="QTREE1"><a href="#QTREE1" class="headerlink" title="QTREE1"></a><a href="http://www.spoj.com/problems/QTREE/" target="_blank" rel="noopener">QTREE1</a></h2><p>题意： 给定一棵n个结点的树，树的边上有权。有两种操作： 1.修改一条边上的权值。 2.查询两个结点x和y之间的最短路径中经过的最大的边的权值。 其中\(n&lt;=10^4\)   很水了，LCT直接搞就是了，维护最大值。 有点卡常数，SPOJ太慢了！SPOJ太慢了！SPOJ太慢了！SPOJ太慢了！ 反正代码没怎么优化，有的时候还加了输入挂，各种优化加上去就难看了。</p>
<p>/* <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>***</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><br>Author        :kuangbin<br>Created Time  :2014/8/26 17:58:27<br>File Name     :E:\2014ACM\专题学习\数据结构\LCT\QTREE\SPOJQTREE.cpp<br>************************************************ */</p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;string.h&gt;</p>
<p>#include <iostream></iostream></p>
<p>#include <algorithm></algorithm></p>
<p>#include <vector></vector></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include <map></map></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;</p>
<p>#include &lt;stdlib.h&gt;</p>
<p>#include &lt;time.h&gt;<br>using namespace std;<br>// <a href="http://www.spoj.com/problems/QTREE/" target="_blank" rel="noopener">http://www.spoj.com/problems/QTREE/</a><br>const int MAXN = 10010;<br>struct Node <em>null;<br>struct Node{<br>    Node \</em>fa,*ch[2];<br>    int Max,key;<br>    inline void push_up(){<br>        if(this == null)return;<br>        Max = max(key,max(ch[0]-&gt;Max,ch[1]-&gt;Max));<br>    }<br>    inline void setc(Node <em>p,int d){<br>        ch[d] = p;<br>        p-&gt;fa = this;<br>    }<br>    inline bool d(){<br>        return  fa-&gt;ch[1] == this;<br>    }<br>    inline bool isroot() {<br>        return fa == null || fa-&gt;ch[0] != this &amp;&amp; fa-&gt;ch[1] != this;<br>    }<br>    inline void rot(){<br>        Node \</em>f = fa,*ff = fa-&gt;fa;<br>        int c = d(), cc = fa-&gt;d();<br>        f-&gt;setc(ch[!c],c);<br>        this-&gt;setc(f,!c);<br>        if(ff-&gt;ch[cc] == f)ff-&gt;setc(this,cc);<br>        else this-&gt;fa = ff;<br>        f-&gt;push_up();<br>    }<br>    inline Node<em> splay(){<br>        while(!isroot()){<br>            if(!fa-&gt;isroot())<br>                d()==fa-&gt;d() ? fa-&gt;rot() : rot();<br>            rot();<br>        }<br>        push_up();<br>        return this;<br>    }<br>    inline Node</em> access(){<br>        for(Node *p = this,*q = null; p != null; q = p, p = p-&gt;fa){<br>            p-&gt;splay()-&gt;setc(q,1);<br>            p-&gt;push_up();<br>        }<br>        return splay();<br>    }<br>};<br>Node pool[MAXN],<em>tail;<br>Node </em>node[MAXN];<br>void init(int n){<br>    tail = pool;<br>    null = tail++;<br>    null-&gt;fa = null-&gt;ch[0] = null-&gt;ch[1] = null;<br>    null-&gt;Max = null-&gt;key = 0;<br>    for(int i = 1;i &lt;= n;i++){<br>        node[i] = tail++;<br>        node[i]-&gt;fa = node[i]-&gt;ch[0] = node[i]-&gt;ch[1] = null;<br>        node[i]-&gt;Max = node[i]-&gt;key = 0;<br>    }<br>}<br>struct Edge{<br>    int to,next;<br>    int w,id;<br>}edge[MAXN<em>2];<br>int head[MAXN],tot;<br>inline int addedge(int u,int v,int w,int id){<br>    edge[tot].to = v;<br>    edge[tot].w = w;<br>    edge[tot].id = id;<br>    edge[tot].next = head[u];<br>    head[u] = tot++;<br>}<br>Node </em>ee[MAXN];<br>bool vis[MAXN];<br>void bfs(int n){<br>    for(int i = 1;i &lt;= n;i++)vis[i] = false;<br>    queue<int>q;<br>    q.push(1);<br>    vis[1] = true;<br>    while(!q.empty()){<br>        int u = q.front();<br>        q.pop();<br>        for(int i = head[u];i != -1;i = edge[i].next){<br>            int v = edge[i].to;<br>            if(vis[v])continue;<br>            vis[v] = true;<br>            q.push(v);<br>            ee[edge[i].id] = node[v];<br>            node[v]-&gt;key = edge[i].w;<br>            node[v]-&gt;push_up();<br>            node[v]-&gt;fa = node[u];<br>        }<br>    }<br>}<br>inline int ask(Node *x,Node *y){<br>    x-&gt;access();<br>    for(x = null; y != null; x = y, y = y-&gt;fa){<br>        y-&gt;splay();<br>        if(y-&gt;fa == null)return max(y-&gt;ch[1]-&gt;Max,x-&gt;Max);<br>        y-&gt;setc(x,1);<br>        y-&gt;push_up();<br>    }<br>}<br>int main()<br>{<br>    int T;<br>    scanf(“%d”,&amp;T);<br>    int n;<br>    while(T–){<br>        scanf(“%d”,&amp;n);<br>        for(int i = 1;i &lt;= n;i++)head[i] = -1;<br>        tot = 0;<br>        init(n);<br>        int u,v,w;<br>        for(int i = 1;i &lt; n;i++){<br>            scanf(“%d%d%d”,&amp;u,&amp;v,&amp;w);<br>            addedge(u,v,w,i);<br>            addedge(v,u,w,i);<br>        }<br>        bfs(n);<br>        char op[20];<br>        int x,y;<br>        while(scanf(“%s”,op) == 1){<br>            if(strcmp(op,”DONE”) == 0)break;<br>            scanf(“%d%d”,&amp;x,&amp;y);<br>            if(op[0] == ‘Q’){<br>                printf(“%d\n”,ask(node[x],node[y]));<br>            }<br>            else {<br>                ee[x]-&gt;splay()-&gt;key = y;<br>                ee[x]-&gt;push_up();<br>            }<br>        }<br>    }<br>    return 0;<br>}</int></p>
<h2 id="QTREE2"><a href="#QTREE2" class="headerlink" title="QTREE2"></a><a href="http://www.spoj.com/problems/QTREE2/" target="_blank" rel="noopener">QTREE2</a></h2><p>题意： 给定一棵n个结点的树，树的边上有权。有两种操作： 1.查询两个结点x和y之间的最短路径长度。 2.查询从x到y的最短路径的第K条边的长度。 其中 \(n&lt;=10^4\)   连修改操作都没有，简直随便搞！</p>
<p>/* <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>***</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><br>Author        :kuangbin<br>Created Time  :2014/8/26 21:42:19<br>File Name     :E:\2014ACM\专题学习\数据结构\LCT\QTREE\SPOJQTREE2.cpp<br>************************************************ */</p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;string.h&gt;</p>
<p>#include <iostream></iostream></p>
<p>#include <algorithm></algorithm></p>
<p>#include <vector></vector></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include <map></map></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;</p>
<p>#include &lt;stdlib.h&gt;</p>
<p>#include &lt;time.h&gt;<br>using namespace std;<br>// <a href="http://www.spoj.com/problems/QTREE2/" target="_blank" rel="noopener">http://www.spoj.com/problems/QTREE2/</a><br>const int MAXN = 10010;<br>struct Node <em>null;<br>struct Node{<br>    Node \</em>fa,*ch[2];<br>    int sum,val;<br>    int size;<br>    int id;<br>    void clear(){<br>        fa = ch[0] = ch[1] = null;<br>        sum = val = 0;<br>        size = 1;<br>    }<br>    inline void push_up(){<br>        if(this == null)return;<br>        sum = val + ch[0]-&gt;sum + ch[1]-&gt;sum;<br>        size = ch[0]-&gt;size + ch[1]-&gt;size + 1;<br>    }<br>    inline void setc(Node <em>p,int d){<br>        ch[d] = p;<br>        p-&gt;fa = this;<br>    }<br>    inline bool d(){<br>        return fa-&gt;ch[1] == this;<br>    }<br>    inline bool isroot(){<br>        return fa == null || fa-&gt;ch[0] != this &amp;&amp; fa-&gt;ch[1] != this;<br>    }<br>    inline void rot(){<br>        Node \</em>f = fa, *ff = fa-&gt;fa;<br>        int c = d(), cc = fa-&gt;d();<br>        f-&gt;setc(ch[!c],c);<br>        this-&gt;setc(f,!c);<br>        if(ff-&gt;ch[cc] == f)ff-&gt;setc(this,cc);<br>        else this-&gt;fa = ff;<br>        f-&gt;push_up();<br>    }<br>    inline Node<em> splay(){<br>        while(!isroot()){<br>            if(!fa-&gt;isroot())<br>                d()==fa-&gt;d() ? fa-&gt;rot() : rot();<br>            rot();<br>        }<br>        push_up();<br>        return this;<br>    }<br>    inline Node</em> access(){<br>        for(Node *p = this,*q = null; p != null; q = p, p = p-&gt;fa){<br>            p-&gt;splay()-&gt;setc(q,1);<br>            p-&gt;push_up();<br>        }<br>        return splay();<br>    }<br>};<br>Node pool[MAXN],<em>tail;<br>Node </em>node[MAXN];<br>void init(int n){<br>    tail = pool;<br>    null = tail++;<br>    null-&gt;fa = null-&gt;ch[0] = null-&gt;ch[1] = null;<br>    null-&gt;size = null-&gt;sum = null-&gt;val = 0;<br>    for(int i = 1;i &lt;= n;i++){<br>        node[i] = tail++;<br>        node[i]-&gt;id = i;<br>        node[i]-&gt;clear();<br>    }<br>}<br>struct Edge{<br>    int to,next;<br>    int w;<br>}edge[MAXN<em>2];<br>int head[MAXN],tot;<br>inline void addedge(int u,int v,int w){<br>    edge[tot].to = v;<br>    edge[tot].w = w;<br>    edge[tot].next = head[u];<br>    head[u] = tot++;<br>}<br>void dfs(int u,int pre){<br>    for(int i = head[u];i != -1;i = edge[i].next){<br>        int v = edge[i].to;<br>        if(v == pre)continue;<br>        dfs(v,u);<br>        node[v]-&gt;val = edge[i].w;<br>        node[v]-&gt;push_up();<br>        node[v]-&gt;fa = node[u];<br>    }<br>}<br>//查询x-&gt;y的距离<br>inline int query_sum(Node \</em>x,Node *y){<br>    x-&gt;access();<br>    for(x = null; y != null; x = y, y = y-&gt;fa){<br>        y-&gt;splay();<br>        if(y-&gt;fa == null)<br>            return y-&gt;ch[1]-&gt;sum + x-&gt;sum;<br>        y-&gt;setc(x,1);<br>        y-&gt;push_up();<br>    }<br>}<br>//在splay中得到第k个点<br>Node<em> get_kth(Node</em> r,int k){<br>    Node <em>x = r;<br>    while(x-&gt;ch[0]-&gt;size+1 != k){<br>        if(k &lt; x-&gt;ch[0]-&gt;size+1)x = x-&gt;ch[0];<br>        else {<br>            k -= x-&gt;ch[0]-&gt;size+1;<br>            x = x-&gt;ch[1];<br>        }<br>    }<br>    return x;<br>}<br>//查询x-&gt;y路径上的第k个点<br>inline int query_kth(Node \</em>x,Node *y,int k){<br>    x-&gt;access();<br>    for(x = null; y != null; x = y, y = y-&gt;fa){<br>        y-&gt;splay();<br>        if(y-&gt;fa == null){<br>            if(y-&gt;ch[1]-&gt;size+1 == k)return y-&gt;id;<br>            else if(y-&gt;ch[1]-&gt;size+1 &gt; k)<br>                return get_kth(y-&gt;ch[1],y-&gt;ch[1]-&gt;size+1-k)-&gt;id;<br>            else return get_kth(x,k-(y-&gt;ch[1]-&gt;size+1))-&gt;id;<br>        }<br>        y-&gt;setc(x,1);<br>        y-&gt;push_up();<br>    }<br>}<br>int main()<br>{<br>    int T,n;<br>    scanf(“%d”,&amp;T);<br>    while(T–){<br>        scanf(“%d”,&amp;n);<br>        for(int i = 1;i &lt;= n;i++)head[i] = -1;<br>        tot = 0;<br>        init(n);<br>        int u,v,w;<br>        for(int i = 1;i &lt; n;i++){<br>            scanf(“%d%d%d”,&amp;u,&amp;v,&amp;w);<br>            addedge(u,v,w);<br>            addedge(v,u,w);<br>        }<br>        dfs(1,1);<br>        char op[20];<br>        while(scanf(“%s”,op) == 1){<br>            if(strcmp(op,”DONE”) == 0)break;<br>            if(op[0] == ‘D’){<br>                scanf(“%d%d”,&amp;u,&amp;v);<br>                printf(“%d\n”,query_sum(node[u],node[v]));<br>            }<br>            else {<br>                int k; scanf(“%d%d%d”,&amp;u,&amp;v,&amp;k);<br>                printf(“%d\n”,query_kth(node[u],node[v],k));<br>            }<br>        }<br>    }<br>    return 0;<br>}</p>
<h2 id="QTREE3"><a href="#QTREE3" class="headerlink" title="QTREE3"></a><a href="http://www.spoj.com/problems/QTREE3/" target="_blank" rel="noopener">QTREE3</a></h2><p>题意： 给定一棵n个结点的树，树的每个结点有黑白两色，初始时都是白的。两种操作： 1.对一个结点执行反色操作（白变黑，黑变白） 2.查询从1号结点到i号结点的路径上的第一个黑色结点编号。 其中\(n&lt;=10^5\). 查询数目不超过\(10^5\).   LCT维护路径上的白点和黑点数目，然后就可以解决了。 水题！</p>
<p>/* <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>***</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><br>Author        :kuangbin<br>Created Time  :2014/8/27 17:34:19<br>File Name     :E:\2014ACM\专题学习\数据结构\LCT\QTREE\SPOJQTREE3.cpp<br>************************************************ */</p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;string.h&gt;</p>
<p>#include <iostream></iostream></p>
<p>#include <algorithm></algorithm></p>
<p>#include <vector></vector></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include <map></map></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;</p>
<p>#include &lt;stdlib.h&gt;</p>
<p>#include &lt;time.h&gt;<br>using namespace std;<br>//<a href="http://www.spoj.com/problems/QTREE3/" target="_blank" rel="noopener">http://www.spoj.com/problems/QTREE3/</a><br>const int MAXN = 100010;<br>struct Node <em>null;<br>struct Node{<br>    Node \</em>fa,*ch[2];<br>    int val,sum;<br>    int id;<br>    void clear(){<br>        fa = ch[0] = ch[1] = null;<br>        val = sum = 0;<br>    }<br>    inline void push_up(){<br>        if(this == null)return;<br>        sum = val + ch[0]-&gt;sum + ch[1]-&gt;sum;<br>    }<br>    inline void setc(Node <em>p,int d){<br>        ch[d] = p;<br>        p-&gt;fa = this;<br>    }<br>    inline bool d(){<br>        return fa-&gt;ch[1] == this;<br>    }<br>    inline bool isroot(){<br>        return fa == null || fa-&gt;ch[0] != this &amp;&amp; fa-&gt;ch[1] != this;<br>    }<br>    inline void rot(){<br>        Node \</em>f = fa, *ff = fa-&gt;fa;<br>        int c = d(), cc = fa-&gt;d();<br>        f-&gt;setc(ch[!c],c);<br>        this-&gt;setc(f,!c);<br>        if(ff-&gt;ch[cc] == f)ff-&gt;setc(this,cc);<br>        else this-&gt;fa = ff;<br>        f-&gt;push_up();<br>    }<br>    inline Node<em> splay(){<br>        while(!isroot()){<br>            if(!fa-&gt;isroot())<br>                d()==fa-&gt;d() ? fa-&gt;rot() : rot();<br>            rot();<br>        }<br>        push_up();<br>        return this;<br>    }<br>    inline Node</em> access(){<br>        for(Node *p = this ,*q = null; p != null; q = p, p = p-&gt;fa){<br>            p-&gt;splay()-&gt;setc(q,1);<br>            p-&gt;push_up();<br>        }<br>        return splay();<br>    }<br>};<br>Node pool[MAXN],<em>tail;<br>Node </em>node[MAXN];<br>void init(int n){<br>    tail = pool;<br>    null = tail++;<br>    null-&gt;fa = null-&gt;ch[0] = null-&gt;ch[1] = null;<br>    null-&gt;val = null-&gt;sum = 0;<br>    for(int i = 1;i &lt;= n;i++){<br>        node[i] = tail++;<br>        node[i]-&gt;clear();<br>        node[i]-&gt;id = i;<br>    }<br>}<br>struct Edge{<br>    int to,next;<br>}edge[MAXN<em>2];<br>int head[MAXN],tot;<br>inline void addedge(int u,int v){<br>    edge[tot].to = v;<br>    edge[tot].next = head[u];<br>    head[u] = tot++;<br>}<br>void dfs(int u,int pre){<br>    for(int i = head[u];i != -1;i = edge[i].next){<br>        int v = edge[i].to;<br>        if(v == pre)continue;<br>        dfs(v,u);<br>        node[v]-&gt;fa = node[u];<br>    }<br>}<br>void change(int u){<br>    node[u]-&gt;splay()-&gt;val ^= 1;<br>    node[u]-&gt;push_up();<br>}<br>int ask(int v){<br>    node[v]-&gt;access();<br>    node[v]-&gt;splay();<br>    if(node[v]-&gt;sum == 0)return -1;<br>    Node </em>x = node[v];<br>    while(x != null){<br>        if(x-&gt;ch[0]-&gt;sum == 0 &amp;&amp; x-&gt;val == 1)return x-&gt;id;<br>        if(x-&gt;ch[0]-&gt;sum)x = x-&gt;ch[0];<br>        else x = x-&gt;ch[1];<br>    }<br>}</p>
<p>int main()<br>{<br>    int n,m;<br>    while(scanf(“%d%d”,&amp;n,&amp;m) == 2){<br>        for(int i = 1;i &lt;= n;i++)head[i] = -1;<br>        tot = 0;<br>        init(n);<br>        int u,v;<br>        for(int i = 1;i &lt; n;i++){<br>            scanf(“%d%d”,&amp;u,&amp;v);<br>            addedge(u,v);<br>            addedge(v,u);<br>        }<br>        dfs(1,1);<br>        while(m–){<br>            scanf(“%d%d”,&amp;u,&amp;v);<br>            if(u == 0)change(v);<br>            else printf(“%d\n”,ask(v));<br>        }<br>    }<br>    return 0;<br>}</p>
<h2 id="QTREE4"><a href="#QTREE4" class="headerlink" title="QTREE4"></a><a href="http://www.spoj.com/problems/QTREE4/" target="_blank" rel="noopener">QTREE4</a></h2><p>题意： 给定一棵n个结点的树，树的边上有权，每个结点有黑白两色，初始时所有的结点都是白的。有两种操作： 1.对一个结点执行反色操作（白变黑，黑变白） 2.查询树中距离最远的两个白点的距离。 其中\(n&lt;=10^5\)，查询数目不超过\(10^5\).   做法比较多，有树链剖分，树分治等。 LCT搞起来代码比较短。 经典的要子树的操作，每个点要加set,维护虚边的信息。 关键是写push_up()操作。   也是会卡常数。要谨慎。</p>
<p>/* <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>***</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><br>Author        :kuangbin<br>Created Time  :2014/8/27 23:29:59<br>File Name     :E:\2014ACM\专题学习\数据结构\LCT\QTREE\SPOJQTREE4.cpp<br>************************************************ */</p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;string.h&gt;</p>
<p>#include <iostream></iostream></p>
<p>#include <algorithm></algorithm></p>
<p>#include <vector></vector></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include <map></map></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;</p>
<p>#include &lt;stdlib.h&gt;</p>
<p>#include &lt;time.h&gt;<br>using namespace std;<br>//<a href="http://www.spoj.com/problems/QTREE4/" target="_blank" rel="noopener">http://www.spoj.com/problems/QTREE4/</a><br>const int MAXN = 100010;<br>const int INF = 0x3f3f3f3f;<br>struct Node <em>null;<br>struct Node{<br>    Node \</em>fa,*ch[2];<br>    multiset<int>st0,st1;//st0是链，st1是路径<br>    int dd,d0;//d0是该点对应边的长度，dd是重链长度<br>    int w0;//白点值为0，黑点值为-INF<br>    int ls,rs,ms;<br>    inline void clear(){<br>        fa = ch[0] = ch[1] = null;<br>        st0.clear(); st1.clear();<br>        st0.insert(-INF);<br>        st0.insert(-INF);<br>        st1.insert(-INF);<br>        w0 = 0; dd = d0 = 0;<br>        ls = rs = ms = -INF;<br>    }<br>    inline void push_up(){<br>        if(this == null)return;<br>        dd = d0 + ch[0]-&gt;dd + ch[1]-&gt;dd;<br>        int m0 = max(w0,<em>st0.rbegin()), ml = max(m0,ch[0]-&gt;rs+d0), mr = max(m0,ch[1]-&gt;ls);<br>        ls = max(ch[0]-&gt;ls,ch[0]-&gt;dd + d0 + mr);<br>        rs = max(ch[1]-&gt;rs,ch[1]-&gt;dd + ml);<br>        multiset<int>::reverse_iterator it = st0.rbegin();<br>        ++it;<br>        int t0 = max((\</int></em>st0.rbegin()) + (*it) , <em>st1.rbegin());<br>        if(w0 == 0)<br>            t0 = max(t0,max(0,</em>st0.rbegin()));<br>        ms = max(max(max(ml+ch[1]-&gt;ls,mr+d0+ch[0]-&gt;rs),max(ch[0]-&gt;ms,ch[1]-&gt;ms)),t0);<br>    }<br>    inline void setc(Node <em>p,int d){<br>        ch[d] = p;<br>        p-&gt;fa = this;<br>    }<br>    inline bool d(){<br>        return fa-&gt;ch[1] == this;<br>    }<br>    inline bool isroot(){<br>        return fa == null || fa-&gt;ch[0] != this &amp;&amp; fa-&gt;ch[1] != this;<br>    }<br>    inline void rot(){<br>        Node \</em>f = fa, *ff = fa-&gt;fa;<br>        int c = d(), cc = fa-&gt;d();<br>        f-&gt;setc(ch[!c],c);<br>        this-&gt;setc(f,!c);<br>        if(ff-&gt;ch[cc] == f)ff-&gt;setc(this,cc);<br>        else this-&gt;fa = ff;<br>        f-&gt;push_up();<br>    }<br>    inline Node<em> splay(){<br>        while(!isroot()){<br>            if(!fa-&gt;isroot())<br>                d()==fa-&gt;d() ? fa-&gt;rot() : rot();<br>            rot();<br>        }<br>        push_up();<br>        return this;<br>    }<br>    inline Node</em> access(){<br>        for(Node *p = this,*q = null; p != null; q = p, p = p-&gt;fa){<br>            p-&gt;splay();<br>            if(p-&gt;ch[1] != null){<br>                p-&gt;st0.insert(p-&gt;ch[1]-&gt;ls);<br>                p-&gt;st1.insert(p-&gt;ch[1]-&gt;ms);<br>            }<br>            if(q != null){<br>                p-&gt;st0.erase(p-&gt;st0.find(q-&gt;ls));<br>                p-&gt;st1.erase(p-&gt;st1.find(q-&gt;ms));<br>            }<br>            p-&gt;setc(q,1);<br>            p-&gt;push_up();<br>        }<br>        return splay();<br>    }<br>};<br>Node pool[MAXN],<em>tail;<br>Node </em>node[MAXN];<br>inline void init(int n){<br>    tail = pool;<br>    null = tail++;<br>    null-&gt;fa = null-&gt;ch[0] = null-&gt;ch[1] = null;<br>    null-&gt;st0.clear(); null-&gt;st1.clear();<br>    null-&gt;ls = null-&gt;rs = null-&gt;ms = -INF;<br>    null-&gt;w0 = -INF;<br>    null-&gt;d0 = null-&gt;dd = 0;<br>    for(int i = 1;i &lt;= n;i++){<br>        node[i] = tail++;<br>        node[i]-&gt;clear();<br>    }<br>}<br>struct Edge{<br>    int to,next,w;<br>}edge[MAXN<em>2];<br>int head[MAXN],tot;<br>inline void addedge(int u,int v,int w){<br>    edge[tot].to = v;<br>    edge[tot].w = w;<br>    edge[tot].next = head[u];<br>    head[u] = tot++;<br>}<br>inline void dfs(int u,int pre){<br>    for(int i = head[u];i != -1;i = edge[i].next){<br>        int v = edge[i].to;<br>        if(v == pre)continue;<br>        node[v]-&gt;fa = node[u];<br>        node[v]-&gt;d0 = edge[i].w;<br>        dfs(v,u);<br>        node[u]-&gt;st0.insert(node[v]-&gt;ls);<br>        node[u]-&gt;st1.insert(node[v]-&gt;ms);<br>    }<br>    node[u]-&gt;push_up();<br>}<br>//适用于正负整数<br>template <class t=""><br>inline bool scan_d(T &amp;ret) {<br>   char c; int sgn;<br>   if(c=getchar(),c==EOF) return 0; //EOF<br>   while(c!=’-‘&amp;&amp;(c&lt;’0’||c&gt;’9’)) c=getchar();<br>   sgn=(c==’-‘)?-1:1;<br>   ret=(c==’-‘)?0:(c-‘0’);<br>   while(c=getchar(),c&gt;=’0’&amp;&amp;c&lt;=’9’) ret=ret</class></em>10+(c-‘0’);<br>   ret*=sgn;<br>   return 1;<br>}<br>int main()<br>{<br>    int n;<br>    while(scanf(“%d”,&amp;n) == 1){<br>        for(int i = 1;i &lt;= n;i++)head[i] = -1;<br>        tot = 0;<br>        init(n);<br>        int u,v,w;<br>        for(int i = 1;i &lt; n;i++){<br>            scan_d(u); scan_d(v);scan_d(w);<br>            addedge(u,v,w);<br>            addedge(v,u,w);<br>        }<br>        dfs(1,1);<br>        int ans = node[1]-&gt;ms;<br>        int Q;<br>        char op[10];<br>        scanf(“%d”,&amp;Q);<br>        while(Q–){<br>            scanf(“%s”,op);<br>            if(op[0] == ‘C’){<br>                scan_d(u);<br>                node[u]-&gt;access();<br>                node[u]-&gt;splay();<br>                if(node[u]-&gt;w0 == 0)node[u]-&gt;w0 = -INF;<br>                else node[u]-&gt;w0 = 0;<br>                node[u]-&gt;push_up();<br>                ans = node[u]-&gt;ms;<br>            }<br>            else{<br>                if(ans &lt; 0)puts(“They have disappeared.”);<br>                else printf(“%d\n”,ans);<br>            }<br>        }<br>    }<br>    return 0;<br>}</int></p>
<h2 id="QTREE5"><a href="#QTREE5" class="headerlink" title="QTREE5"></a><a href="http://www.spoj.com/problems/QTREE5/" target="_blank" rel="noopener">QTREE5</a></h2><p>题意： 给定一棵n个结点的树，边权均为1。每个结点有黑白两色，初始时所有结点都是黑的。两种查询操作： 1.对一个结点执行反色操作（白变黑，黑变白） 2.查询距离某个特定结点i最远的白点的距离。 其中\(&lt;=10^5\)，查询数目不超过\(10^5\).   比QTREE4简单，会QTREE4了这题简直很水。</p>
<p>/* <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>***</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><br>Author        :kuangbin<br>Created Time  :2014/8/28 20:57:35<br>File Name     :E:\2014ACM\专题学习\数据结构\LCT\QTREE\SPOJQTREE5.cpp<br>************************************************ */</p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;string.h&gt;</p>
<p>#include <iostream></iostream></p>
<p>#include <algorithm></algorithm></p>
<p>#include <vector></vector></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include <map></map></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;</p>
<p>#include &lt;stdlib.h&gt;</p>
<p>#include &lt;time.h&gt;<br>using namespace std;<br>//<a href="http://www.spoj.com/problems/QTREE5/" target="_blank" rel="noopener">http://www.spoj.com/problems/QTREE5/</a><br>const int MAXN = 100010;<br>const int INF = 0x3f3f3f3f;<br>struct Node <em>null;<br>struct Node{<br>    Node \</em>fa,*ch[2];<br>    multiset<int>st;<br>    int dd,d0;<br>    int w0;<br>    int ls,rs;<br>    inline void clear(){<br>        fa = ch[0] = ch[1] = null;<br>        st.clear();<br>        st.insert(INF);<br>        w0 = INF; dd = d0 = 0;<br>        ls = rs = INF;<br>    }<br>    inline void push_up(){<br>        if(this == null)return;<br>        dd = d0 + ch[0]-&gt;dd + ch[1]-&gt;dd;<br>        int m0 = min(w0,<em>st.begin()), ml = min(m0,ch[0]-&gt;rs+d0), mr = min(m0,ch[1]-&gt;ls);<br>        ls = min(ch[0]-&gt;ls,ch[0]-&gt;dd + d0 + mr);<br>        rs = min(ch[1]-&gt;rs,ch[1]-&gt;dd + ml);<br>    }<br>    inline void setc(Node </em>p,int d){<br>        ch[d] = p;<br>        p-&gt;fa = this;<br>    }<br>    inline bool d(){<br>        return fa-&gt;ch[1] == this;<br>    }<br>    inline bool isroot(){<br>        return fa == null || fa-&gt;ch[0] != this &amp;&amp; fa-&gt;ch[1] != this;<br>    }<br>    inline void rot(){<br>        Node *f = fa, *ff = fa-&gt;fa;<br>        int c = d(), cc = fa-&gt;d();<br>        f-&gt;setc(ch[!c],c);<br>        this-&gt;setc(f,!c);<br>        if(ff-&gt;ch[cc] == f)ff-&gt;setc(this,cc);<br>        else this-&gt;fa = ff;<br>        f-&gt;push_up();<br>    }<br>    inline Node<em> splay(){<br>        while(!isroot()){<br>            if(!fa-&gt;isroot())<br>                d()==fa-&gt;d() ? fa-&gt;rot() : rot();<br>            rot();<br>        }<br>        push_up();<br>        return this;<br>    }<br>    inline Node</em> access(){<br>        for(Node *p = this,*q = null; p != null; q = p, p = p-&gt;fa){<br>            p-&gt;splay();<br>            if(p-&gt;ch[1] != null){<br>                p-&gt;st.insert(p-&gt;ch[1]-&gt;ls);<br>            }<br>            if(q != null){<br>                p-&gt;st.erase(p-&gt;st.find(q-&gt;ls));<br>            }<br>            p-&gt;setc(q,1);<br>            p-&gt;push_up();<br>        }<br>        return splay();<br>    }<br>};<br>Node pool[MAXN],<em>tail;<br>Node </em>node[MAXN];<br>inline void init(int n){<br>    tail = pool;<br>    null = tail++;<br>    null-&gt;fa = null-&gt;ch[0] = null-&gt;ch[1] = null;<br>    null-&gt;st.clear();<br>    null-&gt;ls = null-&gt;rs = INF;<br>    null-&gt;w0 = INF;<br>    null-&gt;dd = null-&gt;d0 = 0;<br>    for(int i = 1;i &lt;= n;i++){<br>        node[i] = tail++;<br>        node[i]-&gt;clear();<br>    }<br>}<br>struct Edge{<br>    int to,next;<br>}edge[MAXN*2];<br>int head[MAXN],tot;<br>inline void addedge(int u,int v){<br>    edge[tot].to = v;<br>    edge[tot].next = head[u];<br>    head[u] = tot++;<br>}<br>inline void dfs(int u,int pre){<br>    for(int i = head[u];i != -1;i = edge[i].next){<br>        int v = edge[i].to;<br>        if(v == pre)continue;<br>        node[v]-&gt;fa = node[u];<br>        node[v]-&gt;d0 = 1;<br>        dfs(v,u);<br>        node[u]-&gt;st.insert(node[v]-&gt;ls);<br>    }<br>    node[u]-&gt;push_up();<br>}<br>int main()<br>{<br>    int n;<br>    while(scanf(“%d”,&amp;n) == 1){<br>        init(n);<br>        for(int i = 1;i &lt;= n;i++)head[i] = -1;<br>        tot = 0;<br>        int u,v;<br>        for(int i = 1;i &lt; n;i++){<br>            scanf(“%d%d”,&amp;u,&amp;v);<br>            addedge(u,v);<br>            addedge(v,u);<br>        }<br>        dfs(1,1);<br>        int Q;<br>        scanf(“%d”,&amp;Q);<br>        int op;<br>        while(Q–){<br>            scanf(“%d%d”,&amp;op,&amp;v);<br>            if(op == 0){<br>                node[v]-&gt;access();<br>                node[v]-&gt;splay();<br>                if(node[v]-&gt;w0 == 0)node[v]-&gt;w0 = INF;<br>                else node[v]-&gt;w0 = 0;<br>                node[v]-&gt;push_up();<br>            }<br>            else {<br>                node[v]-&gt;access();<br>                node[v]-&gt;splay();<br>                if(node[v]-&gt;rs &lt; INF)printf(“%d\n”,node[v]-&gt;rs);<br>                else printf(“-1\n”);<br>            }<br>        }<br>    }<br>    return 0;<br>}</int></p>
<h2 id="QTREE6"><a href="#QTREE6" class="headerlink" title="QTREE6"></a><a href="http://www.spoj.com/problems/QTREE6/" target="_blank" rel="noopener">QTREE6</a></h2><p>题意： 给定一棵n个结点的树，每个结点有黑白两色，初始时所有结点都是黑的。你被要求支持： 1.对一个结点执行反色操作（白变黑，黑变白） 2.询问有多少个点与u相连。两个结点u,v相连当且仅当u,v路径上所有点的颜色相同。 其中\(n&lt;=10^5\)，查询数目不超过\(10^5\).   维护和左右端点相连的点的个数ls,rs。 还有左右端点的颜色，自己的颜色，子树的两种颜色的总个数。  对于虚边维护两种颜色的总和就可以了。</p>
<p>/* <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>***</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><br>Author        :kuangbin<br>Created Time  :2014/8/28 21:44:01<br>File Name     :E:\2014ACM\专题学习\数据结构\LCT\QTREE\SPOJQTREE6.cpp<br>************************************************ */</p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;string.h&gt;</p>
<p>#include <iostream></iostream></p>
<p>#include <algorithm></algorithm></p>
<p>#include <vector></vector></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include <map></map></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;</p>
<p>#include &lt;stdlib.h&gt;</p>
<p>#include &lt;time.h&gt;<br>using namespace std;<br>//<a href="http://www.spoj.com/problems/QTREE6/" target="_blank" rel="noopener">http://www.spoj.com/problems/QTREE6/</a><br>const int MAXN = 100010;<br>struct Node <em>null;<br>struct Node{<br>    Node \</em>fa,*ch[2];<br>    int co;//0 is black, 1 is white<br>    int lco,rco;<br>    int ls,rs;<br>    int s[2];<br>    int sum[2];//the sum of black and white<br>    inline void clear(){<br>        fa = ch[0] = ch[1] = null;<br>        co = lco = rco = 0;<br>        ls = rs = 1;<br>        s[0] = s[1] = 0;<br>        sum[0] = 1;  sum[1] = 0;<br>    }<br>    inline void push_up(){<br>        if(this == null)return;<br>        if(ch[0] != null)lco = ch[0]-&gt;lco;<br>        else lco = co;<br>        if(ch[1] != null)rco = ch[1]-&gt;rco;<br>        else rco = co;<br>        sum[0] = ch[0]-&gt;sum[0] + ch[1]-&gt;sum[0] + (co == 0);<br>        sum[1] = ch[0]-&gt;sum[1] + ch[1]-&gt;sum[1] + (co == 1);<br>        int ml = 1 + s[co] + (co==ch[0]-&gt;rco?ch[0]-&gt;rs:0);<br>        int mr = 1 + s[co] + (co==ch[1]-&gt;lco?ch[1]-&gt;ls:0);<br>        ls = ch[0]-&gt;ls;<br>        if(lco == co &amp;&amp; ch[0]-&gt;sum[!co] == 0)ls += mr;<br>        rs = ch[1]-&gt;rs;<br>        if(rco == co &amp;&amp; ch[1]-&gt;sum[!co] == 0)rs += ml;<br>    }<br>    inline void setc(Node <em>p,int d){<br>        ch[d] = p;<br>        p-&gt;fa = this;<br>    }<br>    inline bool d(){<br>        return fa-&gt;ch[1] == this;<br>    }<br>    inline bool isroot(){<br>        return fa == null || fa-&gt;ch[0] != this &amp;&amp; fa-&gt;ch[1] != this;<br>    }<br>    inline void rot(){<br>        Node \</em>f = fa, *ff = fa-&gt;fa;<br>        int c = d(), cc = fa-&gt;d();<br>        f-&gt;setc(ch[!c],c);<br>        this-&gt;setc(f,!c);<br>        if(ff-&gt;ch[cc] == f)ff-&gt;setc(this,cc);<br>        else this-&gt;fa = ff;<br>        f-&gt;push_up();<br>    }<br>    inline Node<em> splay(){<br>        while(!isroot()){<br>            if(!fa-&gt;isroot())<br>                d()==fa-&gt;d() ? fa-&gt;rot() : rot();<br>            rot();<br>        }<br>        push_up();<br>        return this;<br>    }<br>    inline Node</em> access(){<br>        for(Node *p = this,*q = null; p != null; q = p, p = p-&gt;fa){<br>            p-&gt;splay();<br>            if(p-&gt;ch[1] != null)<br>                p-&gt;s[p-&gt;ch[1]-&gt;lco] += p-&gt;ch[1]-&gt;ls;<br>            if(q != null)<br>                p-&gt;s[q-&gt;lco] -= q-&gt;ls;<br>            p-&gt;setc(q,1);<br>            p-&gt;push_up();<br>        }<br>        return splay();<br>    }<br>};<br>Node pool[MAXN],<em>tail;<br>Node </em>node[MAXN];<br>void init(int n){<br>    tail = pool;<br>    null = tail++;<br>    null-&gt;fa = null-&gt;ch[0] = null-&gt;ch[1] = null;<br>    null-&gt;s[0] = null-&gt;s[1] = 0;<br>    null-&gt;ls = null-&gt;rs = 0;<br>    null-&gt;sum[0] = null-&gt;sum[1] = 0;<br>    null-&gt;co = null-&gt;lco = null-&gt;rco = 0;<br>    for(int i = 1;i &lt;= n;i++){<br>        node[i] = tail++;<br>        node[i]-&gt;clear();<br>    }<br>}<br>struct Edge{<br>    int to,next;<br>}edge[MAXN*2];<br>int head[MAXN],tot;<br>inline void addedge(int u,int v){<br>    edge[tot].to = v; edge[tot].next = head[u]; head[u] = tot++;<br>}<br>void dfs(int u,int pre){<br>    for(int i = head[u];i != -1;i = edge[i].next){<br>        int v = edge[i].to;<br>        if(v == pre)continue;<br>        node[v]-&gt;fa = node[u];<br>        dfs(v,u);<br>        node[u]-&gt;s[node[v]-&gt;lco] += node[v]-&gt;ls;<br>    }<br>    node[u]-&gt;push_up();<br>}<br>int main()<br>{<br>    int n;<br>    while(scanf(“%d”,&amp;n) == 1){<br>        init(n);<br>        for(int i = 1;i &lt;= n;i++)head[i] = -1;<br>        tot = 0;<br>        int u,v;<br>        for(int i = 1;i &lt; n;i++){<br>            scanf(“%d%d”,&amp;u,&amp;v);<br>            addedge(u,v);<br>            addedge(v,u);<br>        }<br>        dfs(1,1);<br>        int Q;<br>        int op;<br>        scanf(“%d”,&amp;Q);<br>        while(Q–){<br>            scanf(“%d%d”,&amp;op,&amp;u);<br>            if(op == 0){<br>                node[u]-&gt;access();<br>                node[u]-&gt;splay();<br>                printf(“%d\n”,node[u]-&gt;rs);<br>            }<br>            else{<br>                node[u]-&gt;access();<br>                node[u]-&gt;splay();<br>                node[u]-&gt;co ^= 1;<br>                node[u]-&gt;push_up();<br>            }<br>        }<br>        return 0;<br>    }<br>    return 0;<br>}</p>
<h2 id="QTREE7"><a href="#QTREE7" class="headerlink" title="QTREE7"></a><a href="http://www.spoj.com/problems/QTREE7/" target="_blank" rel="noopener">QTREE7</a></h2><p>题意： 给定一棵n个结点的树，每个结点有黑白两色和权值。三种操作： 1.对一个结点执行反色操作（白变黑，黑变白） 2.询问与u相连的点中点权的最大值。两个结点u,v相连当且仅当u,v路径上所有点的颜色相同。 3.改变一个点的点权。 其中\(n&lt;=10^5\)，查询数目不超过\(10^5\).   会了QTREE6，这题就简单了，增加set维护虚边。</p>
<p>/* <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>***</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><br>Author        :kuangbin<br>Created Time  :2014/8/29 9:09:44<br>File Name     :E:\2014ACM\专题学习\数据结构\LCT\QTREE\SPOJQTREE7.cpp<br>************************************************ */</p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;string.h&gt;</p>
<p>#include <iostream></iostream></p>
<p>#include <algorithm></algorithm></p>
<p>#include <vector></vector></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include <map></map></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;</p>
<p>#include &lt;stdlib.h&gt;</p>
<p>#include &lt;time.h&gt;<br>using namespace std;<br>//<a href="http://www.spoj.com/problems/QTREE7/" target="_blank" rel="noopener">http://www.spoj.com/problems/QTREE7/</a><br>const int MAXN = 100010;<br>const int INF = 0x3f3f3f3f;<br>struct Node <em>null;<br>struct Node{<br>    Node \</em>fa,*ch[2];<br>    int co;<br>    int lco,rco;<br>    int ls,rs;<br>    int w0;<br>    multiset<int>st[2];<br>    int sum[2];<br>    inline void clear(int _co = 0, int _w0 = 0){<br>        fa = ch[0] = ch[1] = null;<br>        co = lco = rco = _co;<br>        w0 = _w0;<br>        ls = rs = _w0;<br>        st[0].clear(); st[1].clear();<br>        st[0].insert(-INF); st[1].insert(-INF);<br>        sum[0] = sum[1] = 0; sum[_co]++;<br>    }<br>    inline void push_up(){<br>        if(this == null)return;<br>        if(ch[0] != null)lco = ch[0]-&gt;lco;<br>        else lco = co;<br>        if(ch[1] != null)rco = ch[1]-&gt;rco;<br>        else rco = co;<br>        sum[0] = ch[0]-&gt;sum[0] + ch[1]-&gt;sum[0] + (co == 0);<br>        sum[1] = ch[0]-&gt;sum[1] + ch[1]-&gt;sum[1] + (co == 1);<br>        int ml = max(w0,max(<em>st[co].rbegin(),co==ch[0]-&gt;rco?ch[0]-&gt;rs:-INF));<br>        int mr = max(w0,max(</em>st[co].rbegin(),co==ch[1]-&gt;lco?ch[1]-&gt;ls:-INF));<br>        ls = ch[0]-&gt;ls;<br>        if(lco == co &amp;&amp; ch[0]-&gt;sum[!co] == 0)ls = max(ls,mr);<br>        rs = ch[1]-&gt;rs;<br>        if(rco == co &amp;&amp; ch[1]-&gt;sum[!co] == 0)rs = max(rs,ml);<br>    }<br>    inline void setc(Node <em>p,int d){<br>        ch[d] = p;<br>        p-&gt;fa = this;<br>    }<br>    inline bool d(){<br>        return fa-&gt;ch[1] == this;<br>    }<br>    inline bool isroot(){<br>        return fa == null || fa-&gt;ch[0] != this &amp;&amp; fa-&gt;ch[1] != this;<br>    }<br>    inline void rot(){<br>        Node \</em>f = fa, *ff = fa-&gt;fa;<br>        int c = d(), cc = fa-&gt;d();<br>        f-&gt;setc(ch[!c],c);<br>        this-&gt;setc(f,!c);<br>        if(ff-&gt;ch[cc] == f)ff-&gt;setc(this,cc);<br>        else this-&gt;fa = ff;<br>        f-&gt;push_up();<br>    }<br>    inline Node<em> splay(){<br>        while(!isroot()){<br>            if(!fa-&gt;isroot())<br>                d()==fa-&gt;d() ? fa-&gt;rot() : rot();<br>            rot();<br>        }<br>        push_up();<br>        return this;<br>    }<br>    inline Node</em> access(){<br>        for(Node *p = this,*q = null; p != null; q = p, p = p-&gt;fa){<br>            p-&gt;splay();<br>            if(p-&gt;ch[1] != null)<br>                p-&gt;st[p-&gt;ch[1]-&gt;lco].insert(p-&gt;ch[1]-&gt;ls);<br>            if(q != null)<br>                p-&gt;st[q-&gt;lco].erase(p-&gt;st[q-&gt;lco].find(q-&gt;ls));<br>            p-&gt;setc(q,1);<br>            p-&gt;push_up();<br>        }<br>        return splay();<br>    }<br>};<br>Node pool[MAXN],<em>tail;<br>Node </em>node[MAXN];<br>int color[MAXN],val[MAXN];<br>void init(int n){<br>    tail = pool;<br>    null = tail++;<br>    null-&gt;fa = null-&gt;ch[0] = null-&gt;ch[1] = null;<br>    null-&gt;st[0].clear(); null-&gt;st[1].clear();<br>    null-&gt;ls = null-&gt;rs = -INF;<br>    null-&gt;sum[0] = null-&gt;sum[1] = 0;<br>    null-&gt;co = null-&gt;lco = null-&gt;rco = 0;<br>    for(int i = 1;i &lt;= n;i++){<br>        node[i] = tail++;<br>        node[i]-&gt;clear(color[i],val[i]);<br>    }<br>}<br>struct Edge{<br>    int to,next;<br>}edge[MAXN*2];<br>int head[MAXN],tot;<br>inline void addedge(int u,int v){<br>    edge[tot].to = v; edge[tot].next = head[u]; head[u] = tot++;<br>}<br>void dfs(int u,int pre){<br>    for(int i = head[u];i != -1;i = edge[i].next){<br>        int v = edge[i].to;<br>        if(v == pre)continue;<br>        node[v]-&gt;fa = node[u];<br>        dfs(v,u);<br>        node[u]-&gt;st[node[v]-&gt;lco].insert(node[v]-&gt;ls);<br>    }<br>    node[u]-&gt;push_up();<br>}<br>int main()<br>{<br>    int n;<br>    while(scanf(“%d”,&amp;n) == 1){<br>        for(int i = 1;i &lt;= n;i++)head[i] = -1;<br>        tot = 0;<br>        int u,v;<br>        for(int i = 1;i &lt; n;i++){<br>            scanf(“%d%d”,&amp;u,&amp;v);<br>            addedge(u,v);<br>            addedge(v,u);<br>        }<br>        for(int i = 1;i &lt;= n;i++)scanf(“%d”,&amp;color[i]);<br>        for(int i = 1;i &lt;= n;i++)scanf(“%d”,&amp;val[i]);<br>        init(n);<br>        dfs(1,1);<br>        int Q;<br>        int w,op;<br>        scanf(“%d”,&amp;Q);<br>        while(Q–){<br>            scanf(“%d”,&amp;op);<br>            if(op == 0){<br>                scanf(“%d”,&amp;u);<br>                node[u]-&gt;access(); node[u]-&gt;splay();<br>                printf(“%d\n”,node[u]-&gt;rs);<br>            }<br>            else if(op == 1){<br>                scanf(“%d”,&amp;u);<br>                node[u]-&gt;access(); node[u]-&gt;splay();<br>                node[u]-&gt;co ^= 1;<br>                node[u]-&gt;push_up();<br>            }<br>            else {<br>                scanf(“%d%d”,&amp;u,&amp;w);<br>                node[u]-&gt;access(); node[u]-&gt;splay();<br>                node[u]-&gt;w0 = w;<br>                node[u]-&gt;push_up();<br>            }<br>        }<br>    }<br>    return 0;<br>}</int></p>

          
        
      
    </div>

    

    
    
    
	
	<div>
		
	</div>
 
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/08/25/zoj3803/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/08/25/zoj3803/" itemprop="url">
                  ZOJ 3803 Function （DP）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-08-25 17:43:49" itemprop="dateCreated datePublished" datetime="2014-08-25T17:43:49+08:00">2014-08-25</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 13:43:28" itemprop="dateModified" datetime="2018-07-29T13:43:28+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/DP/" itemprop="url" rel="index"><span itemprop="name">DP</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/DP/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/DP/Online-Judge/ZJU/" itemprop="url" rel="index"><span itemprop="name">ZJU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/DP/Online-Judge/ZJU/算法/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="ZOJ3803"><a href="#ZOJ3803" class="headerlink" title="ZOJ3803"></a><a href="http://acm.zju.edu.cn/onlinejudge/showProblem.do?problemId=5335" target="_blank" rel="noopener">ZOJ3803</a></h3><p>简单DP，写个DP能写成这样，我是多么的弱！！！！</p>
<p>Function</p>
<hr>
<p>Time Limit: 2 Seconds      Memory Limit: 65536 KB</p>
<hr>
<p>Let x is a binary number with n digits (AnAn-1An-2…A2A1). And we can encode it as G(x) = x ⊕ ⌊x / 2⌋ or as C(x) = (2n - x) mod 2n, where “⊕” is bitwise XOR operation and “⌊x⌋” indicates the largest integer which is not greater than x.</p>
<p>For some reasons, Alice encodes her password P into G(P), and additionally, she encodes P into C(P). And she writes G(P) and C(P) in a paper. However, something terrible happened. A bug ate some parts of the paper, so some digits are unreadable now. Alice is so worried that she want you to determine the values of these digits using the readable digits.</p>
<h4 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h4><p>There are multiple test cases. For every test case, it has 2 lines of same number of digits describe G(P) and C(P). In every line, it only contains ‘1’, ‘0’ and ‘?’. Unreadable digits are denoted with symbol ‘?’. The length of every line in the input is up to 105.</p>
<h4 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h4><p>If it is impossible to restore G(P) and C(P), you should output “IMPOSSIBLE” (without quotes).</p>
<p>If G(P) is unique, you should output “UNIQUE” (without quotes) in the first line. Then output restored G(P) and C(P) in the same format.</p>
<p>If there are two or more possible G(P) that can be restored using the readable digits. You should output “AMBIGUOUS” (without quotes) and the number of possible G(P). The number may be very large, so the answer should modulo 109 + 7.</p>
<h4 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h4><p>1110<br>0101<br>11??<br>01??<br>111?<br>100?</p>
<h4 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h4><p>UNIQUE<br>1110<br>0101<br>AMBIGUOUS 3<br>IMPOSSIBLE</p>
<h4 id="Hint"><a href="#Hint" class="headerlink" title="Hint"></a>Hint</h4><p>In the second sample case, the three possible situations are:<br>1.G(1001) = 1101, C(1001) = 0111<br>2.G(1010) = 1111, C(1010) = 0110<br>3.G(1011) = 1110, C(1011) = 0101       很明显的一个DP。   因为只需要知道当前位是什么，以及前面是不是全0 就可以转移了。 因为G(x)就是相邻两位取异或，C(x) 就是最后一个1位是不变的，后面的都是取反。   比赛做的时候各种if  else 乱搞，把转移的所有情况手动列出，太挫了，然后记录路径的时候输出又写错了，调试半天。这个状态简单太差，以现在的状态去比赛，简直就是受虐，sad。 以后把代码实现都想得很明白了再写代码了！！！！！   代码：</p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include <algorithm></algorithm></p>
<p>#include <iostream></iostream></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include &lt;string.h&gt;</p>
<p>#include <map></map></p>
<p>#include <vector></vector></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;<br>using namespace std;<br>const int MAXN = 100010;<br>const int MOD = 1e9+7;<br>int dp1[MAXN][2][2];//dp1[i][j][k]: 前i位，j为0表示前面全0，j为1表示不全为0，k是当前位状态<br>int pre1[MAXN][2][2];//记录路径<br>int pre2[MAXN][2][2];<br>void Add1(int &amp;a,int b){//0是无解，1是唯一解，2是多解<br>    if(a == 0)a = b;<br>    else if(a == 1){<br>        if(b == 1)a = 2;<br>        else if(b == 2)a = 2;<br>    }<br>}<br>char str1[MAXN],str2[MAXN];<br>void Add2(int &amp;a,int b){//取模加法<br>    a += b;<br>    if(a &gt;= MOD)a -= MOD;<br>}<br>int a[MAXN];</p>
<p>int main()<br>{<br>    //freopen(“in.txt”,”r”,stdin);<br>    //freopen(“out.txt”,”w”,stdout);<br>    while(scanf(“%s%s”,str1,str2) == 2){<br>        int n = strlen(str1);<br>        reverse(str1,str1+n);//反转<br>        reverse(str2,str2+n);<br>        memset(dp1,0,sizeof(dp1));<br>        if(str2[0] == ‘0’)dp1[0][0][0] = 1;//最低位<br>        else if(str2[0] == ‘1’)dp1[0][1][1] = 1;<br>        else {<br>            dp1[0][0][0] = 1;<br>            dp1[0][1][1] = 1;<br>        }<br>        for(int i = 0;i &lt; n-1;i++)<br>            for(int j = 0;j &lt; 2;j++)//前面是否全0<br>                for(int k = 0;k &lt; 2;k++){//当前位<br>                    if(dp1[i][j][k] == 0)continue;<br>                    for(int nk = 0;nk &lt; 2;nk++){//下一位<br>                        if(str1[i] == ‘0’ &amp;&amp; nk != k)continue;//k和nk异或为0<br>                        if(str1[i] == ‘1’ &amp;&amp; nk == k)continue;//k和nk异或为1<br>                        if(str2[i+1] != ‘?’){<br>                            if(j == 0 &amp;&amp; nk != str2[i+1]-‘0’)continue;//要相同<br>                            if(j == 1 &amp;&amp; nk == str2[i+1]-‘0’)continue;//要相反<br>                        }<br>                        int nj = j|k|nk;<br>                        Add1(dp1[i+1][nj][nk],dp1[i][j][k]);<br>                        pre1[i+1][nj][nk] = j;<br>                        pre2[i+1][nj][nk] = k;<br>                    }<br>                }<br>        int ans1 = 0;<br>        int tj = -1;<br>        int tk = -1;<br>        for(int j = 0;j &lt; 2;j++)<br>            for(int k = 0;k &lt; 2;k++){<br>                if(str1[n-1] == ‘0’ &amp;&amp; k == 1)continue;<br>                if(str1[n-1] == ‘1’ &amp;&amp; k == 0)continue;<br>                if(dp1[n-1][j][k] == 0)continue;<br>                Add1(ans1,dp1[n-1][j][k]);<br>                if(dp1[n-1][j][k]){<br>                    tj = j;<br>                    tk = k;<br>                }<br>            }<br>        if(ans1 == 0){<br>            printf(“IMPOSSIBLE\n”);<br>            continue;<br>        }<br>        if(ans1 == 1){<br>            printf(“UNIQUE\n”);<br>            for(int i = n-1;i &gt;= 0;i–){<br>                a[i] = tk;<br>                int nj = pre1[i][tj][tk];<br>                int nk = pre2[i][tj][tk];<br>                tj = nj;<br>                tk = nk;<br>            }<br>            for(int i = n-1;i &gt;= 0;i–){<br>                if(i == n-1)printf(“%d”,a[i]);<br>                else printf(“%d”,a[i]^a[i+1]);<br>            }<br>            printf(“\n”);<br>            int tmp1 = 0;<br>            while(tmp1 &lt; n &amp;&amp; a[tmp1] == 0 )tmp1++;<br>            for(int i = n-1;i &gt;= 0;i–){<br>                if(i &gt; tmp1)printf(“%d”,!a[i]);<br>                else printf(“%d”,a[i]);<br>            }<br>            printf(“\n”);<br>            continue;<br>        }</p>
<pre><code>    memset(dp1,0,sizeof(dp1));
    if(str2\[0\] == &apos;0&apos;)dp1\[0\]\[0\]\[0\] = 1;
    else if(str2\[0\] == &apos;1&apos;)dp1\[0\]\[1\]\[1\] = 1;
    else {
        dp1\[0\]\[0\]\[0\] = 1;
        dp1\[0\]\[1\]\[1\] = 1;
    }
    for(int i = 0;i &lt; n-1;i++)
        for(int j = 0;j &lt; 2;j++)
            for(int k = 0;k &lt; 2;k++){
                if(dp1\[i\]\[j\]\[k\] == 0)continue;
                for(int nk = 0;nk &lt; 2;nk++){
                    if(str1\[i\] == &apos;0&apos; &amp;&amp; nk != k)continue;
                    if(str1\[i\] == &apos;1&apos; &amp;&amp; nk == k)continue;
                    if(str2\[i+1\] != &apos;?&apos;){
                        if(j == 0 &amp;&amp; nk != str2\[i+1\]-&apos;0&apos;)continue;
                        if(j == 1 &amp;&amp; nk == str2\[i+1\]-&apos;0&apos;)continue;
                    }
                    int nj = j|k|nk;
                    Add2(dp1\[i+1\]\[nj\]\[nk\],dp1\[i\]\[j\]\[k\]);
                }
            }
    ans1 = 0;
    for(int j = 0;j &lt; 2;j++)
        for(int k = 0;k &lt; 2;k++){
            if(str1\[n-1\] == &apos;0&apos; &amp;&amp; k == 1)continue;
            if(str1\[n-1\] == &apos;1&apos; &amp;&amp; k == 0)continue;
            if(dp1\[n-1\]\[j\]\[k\] == 0)continue;
            Add2(ans1,dp1\[n-1\]\[j\]\[k\]);
        }
    printf(&quot;AMBIGUOUS %d\\n&quot;,ans1);

}
return 0;
</code></pre><p>}</p>
<pre><code>写的if else 乱搞的挫代码。。。。 贴出来纪念我逗比的人生吧！
</code></pre><p>#include &lt;stdio.h&gt;</p>
<p>#include <algorithm></algorithm></p>
<p>#include <iostream></iostream></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include &lt;string.h&gt;</p>
<p>#include <map></map></p>
<p>#include <vector></vector></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;<br>using namespace std;<br>const int MAXN = 100010;<br>const int MOD = 1e9+7;<br>int dp1[MAXN][2][2];<br>int pre1[MAXN][2][2];<br>int pre2[MAXN][2][2];<br>void Add1(int &amp;a,int b){<br>    if(a == 0)a = b;<br>    else if(a == 1){<br>        if(b == 1)a = 2;<br>        else if(b == 2)a = 2;<br>    }<br>}<br>char str1[MAXN],str2[MAXN];<br>char str[MAXN];<br>void Add2(int &amp;a,int b){<br>    a += b;<br>    if(a &gt;= MOD)a -= MOD;<br>}<br>int a[MAXN];</p>
<p>int main()<br>{<br>    //freopen(“in.txt”,”r”,stdin);<br>    //freopen(“out.txt”,”w”,stdout);<br>    while(scanf(“%s%s”,str1,str2) == 2){<br>        int n = strlen(str1);<br>        reverse(str1,str1+n);<br>        reverse(str2,str2+n);<br>        memset(dp1,0,sizeof(dp1));<br>        if(str2[0] == ‘0’)dp1[0][0][0] = 1;<br>        else if(str2[0] == ‘1’)dp1[0][1][1] = 1;<br>        else {<br>            dp1[0][0][0] = 1;<br>            dp1[0][1][1] = 1;<br>        }<br>        for(int i = 0;i &lt; n-1;i++)<br>            for(int j = 0;j &lt; 2;j++)<br>                for(int k = 0;k &lt; 2;k++){<br>                    if(dp1[i][j][k] == 0)continue;<br>                    if(str1[i] == ‘0’){<br>                        if(str2[i+1] == ‘0’){<br>                            if(j == 0){<br>                                if(k == 0){<br>                                    Add1(dp1[i+1][j][k],dp1[i][j][k]);//0-&gt;0<br>                                    if(dp1[i][j][k]){<br>                                        pre1[i+1][j][k] = j;<br>                                        pre2[i+1][j][k] = k;<br>                                    }<br>                                }<br>                            }<br>                            else {<br>                                if(k == 1){<br>                                    Add1(dp1[i+1][1][k],dp1[i][j][k]);//1-&gt;1<br>                                    if(dp1[i][j][k]){<br>                                        pre1[i+1][1][k] = j;<br>                                        pre2[i+1][1][k] = k;<br>                                    }<br>                                }<br>                            }<br>                        }<br>                        else if(str2[i+1] == ‘1’){<br>                            if(j == 0){<br>                                if(k == 1){<br>                                    Add1(dp1[i+1][1][k],dp1[i][j][k]);//1-&gt;1<br>                                    if(dp1[i][j][k]){<br>                                        pre1[i+1][1][k] = j;<br>                                        pre2[i+1][1][k] = k;<br>                                    }<br>                                }<br>                            }<br>                            else {<br>                                if(k == 0){<br>                                    Add1(dp1[i+1][j][k],dp1[i][j][k]);//0-&gt;0<br>                                    if(dp1[i][j][k]){<br>                                        pre1[i+1][j][k] = j;<br>                                        pre2[i+1][j][k] = k;<br>                                    }<br>                                }<br>                            }<br>                        }<br>                        else {<br>                            if(k == 0){<br>                                Add1(dp1[i+1][j][k],dp1[i][j][k]);//0-&gt;0<br>                                    if(dp1[i][j][k]){<br>                                        pre1[i+1][j][k] = j;<br>                                        pre2[i+1][j][k] = k;<br>                                    }<br>                            }<br>                            else{<br>                                   Add1(dp1[i+1][1][k],dp1[i][j][k]);//1-&gt;1<br>                                    if(dp1[i][j][k]){<br>                                        pre1[i+1][1][k] = j;<br>                                        pre2[i+1][1][k] = k;<br>                                    }<br>                            }<br>                        }<br>                    }<br>                    else if(str1[i] == ‘1’){<br>                        if(str2[i+1] == ‘0’){<br>                            if(j == 0){<br>                                if(k == 1){<br>                                    Add1(dp1[i+1][1][0],dp1[i][j][k]);//1-&gt;0<br>                                    if(dp1[i][j][k]){<br>                                        pre1[i+1][1][0] = j;<br>                                        pre2[i+1][1][0] = k;<br>                                    }<br>                                }<br>                            }<br>                            else{<br>                                if(k == 0){<br>                                    Add1(dp1[i+1][1][1],dp1[i][j][k]);//0-&gt;1<br>                                    if(dp1[i][j][k]){<br>                                        pre1[i+1][1][1] = j;<br>                                        pre2[i+1][1][1] = k;<br>                                    }<br>                                }<br>                            }<br>                        }<br>                        else if(str2[i+1] == ‘1’){<br>                            if(j == 0){<br>                                if(k == 0){<br>                                    Add1(dp1[i+1][1][1],dp1[i][j][k]);//0-&gt;1<br>                                    if(dp1[i][j][k]){<br>                                        pre1[i+1][1][1] = j;<br>                                        pre2[i+1][1][1] = k;<br>                                    }<br>                                }<br>                            }<br>                            else{<br>                                if(k == 1){<br>                                    Add1(dp1[i+1][1][0],dp1[i][j][k]);//1-&gt;0<br>                                    if(dp1[i][j][k]){<br>                                        pre1[i+1][1][0] = j;<br>                                        pre2[i+1][1][0] = k;<br>                                    }<br>                                }<br>                            }<br>                        }<br>                        else {<br>                            if(k == 1){<br>                                Add1(dp1[i+1][1][0],dp1[i][j][k]);//1-&gt;0<br>                                    if(dp1[i][j][k]){<br>                                        pre1[i+1][1][0] = j;<br>                                        pre2[i+1][1][0] = k;<br>                                    }<br>                            }<br>                            else{<br>                                   Add1(dp1[i+1][1][1],dp1[i][j][k]);//0-&gt;1<br>                                    if(dp1[i][j][k]){<br>                                        pre1[i+1][1][1] = j;<br>                                        pre2[i+1][1][1] = k;<br>                                    }<br>                            }<br>                        }<br>                    }<br>                    else {<br>                        if(str2[i+1] == ‘0’){<br>                            if(j == 0){<br>                                if(k == 0){<br>                                    Add1(dp1[i+1][j][k],dp1[i][j][k]);//0-&gt;0<br>                                    if(dp1[i][j][k]){<br>                                        pre1[i+1][j][k] = j;<br>                                        pre2[i+1][j][k] = k;<br>                                    }<br>                                }<br>                                if(k == 1){<br>                                    Add1(dp1[i+1][1][0],dp1[i][j][k]);//1-&gt;0<br>                                    if(dp1[i][j][k]){<br>                                        pre1[i+1][1][0] = j;<br>                                        pre2[i+1][1][0] = k;<br>                                    }<br>                                }<br>                            }<br>                            else {<br>                                if(k == 0){<br>                                    Add1(dp1[i+1][1][1],dp1[i][j][k]);//0-&gt;1</p>
<pre><code>                                if(dp1\[i\]\[j\]\[k\]){
                                    pre1\[i+1\]\[1\]\[1\] = j;
                                    pre2\[i+1\]\[1\]\[1\] = k;
                                }
                            }
                            if(k == 1){
                                Add1(dp1\[i+1\]\[1\]\[1\],dp1\[i\]\[j\]\[k\]);//1-&gt;1
                                if(dp1\[i\]\[j\]\[k\]){
                                    pre1\[i+1\]\[1\]\[1\] = j;
                                    pre2\[i+1\]\[1\]\[1\] = k;
                                }
                            }
                        }
                    }
                    else if(str2\[i+1\] == &apos;1&apos;){
                        if(j == 0){
                            if(k == 0){
                                Add1(dp1\[i+1\]\[1\]\[1\],dp1\[i\]\[j\]\[k\]);
                                if(dp1\[i\]\[j\]\[k\]){
                                    pre1\[i+1\]\[1\]\[1\] = j;
                                    pre2\[i+1\]\[1\]\[1\] = k;
                                }
                            }
                            if(k == 1){
                                Add1(dp1\[i+1\]\[1\]\[1\],dp1\[i\]\[j\]\[k\]);
                                if(dp1\[i\]\[j\]\[k\]){
                                    pre1\[i+1\]\[1\]\[1\] = j;
                                    pre2\[i+1\]\[1\]\[1\] = k;
                                }
                            }
                        }
                        else {
                            if(k == 0){
                                Add1(dp1\[i+1\]\[j\]\[k\],dp1\[i\]\[j\]\[k\]);
                                if(dp1\[i\]\[j\]\[k\]){
                                    pre1\[i+1\]\[j\]\[k\] = j;
                                    pre2\[i+1\]\[j\]\[k\] = k;
                                }
                            }
                            if(k == 1){
                                Add1(dp1\[i+1\]\[1\]\[0\],dp1\[i\]\[j\]\[k\]);
                                if(dp1\[i\]\[j\]\[k\]){
                                    pre1\[i+1\]\[1\]\[0\] = j;
                                    pre2\[i+1\]\[1\]\[0\] = k;
                                }
                            }
                        }
                    }
                    else {
                        if(k == 0){
                            Add1(dp1\[i+1\]\[j\]\[0\],dp1\[i\]\[j\]\[k\]);
                                if(dp1\[i\]\[j\]\[k\]){
                                    pre1\[i+1\]\[j\]\[0\] = j;
                                    pre2\[i+1\]\[j\]\[0\] = k;
                                }
                            Add1(dp1\[i+1\]\[1\]\[1\],dp1\[i\]\[j\]\[k\]);
                                if(dp1\[i\]\[j\]\[k\]){
                                    pre1\[i+1\]\[1\]\[1\] = j;
                                    pre2\[i+1\]\[1\]\[1\] = k;
                                }
                        }
                        else {
                            Add1(dp1\[i+1\]\[1\]\[0\],dp1\[i\]\[j\]\[k\]);
                                if(dp1\[i\]\[j\]\[k\]){
                                    pre1\[i+1\]\[1\]\[0\] = j;
                                    pre2\[i+1\]\[1\]\[0\] = k;
                                }
                            Add1(dp1\[i+1\]\[1\]\[1\],dp1\[i\]\[j\]\[k\]);
                                if(dp1\[i\]\[j\]\[k\]){
                                    pre1\[i+1\]\[1\]\[1\] = j;
                                    pre2\[i+1\]\[1\]\[1\] = k;
                                }

                        }
                    }
                }
            }
    int ans1 = 0;
    int tj = -1;
    int tk = -1;
    for(int j = 0;j &lt; 2;j++)
        for(int k = 0;k &lt; 2;k++){
            if(str1\[n-1\] == &apos;0&apos; &amp;&amp; k == 1)continue;
            if(str1\[n-1\] == &apos;1&apos; &amp;&amp; k == 0)continue;
            Add1(ans1,dp1\[n-1\]\[j\]\[k\]);
            if(dp1\[n-1\]\[j\]\[k\]){
                tj = j;
                tk = k;
            }
        }
    if(ans1 == 0){
        printf(&quot;IMPOSSIBLE\\n&quot;);
        continue;
    }
    if(ans1 == 1){
        printf(&quot;UNIQUE\\n&quot;);
        for(int i = n-1;i &gt;= 0;i--){
            a\[i\] = tk;
            int nj = pre1\[i\]\[tj\]\[tk\];
            int nk = pre2\[i\]\[tj\]\[tk\];
            tj = nj;
            tk = nk;
        }
        for(int i = n-1;i &gt;= 0;i--){
            if(i == n-1)printf(&quot;%d&quot;,a\[i\]);
            else printf(&quot;%d&quot;,a\[i\]^a\[i+1\]);
        }
        cout&lt;&lt;endl;
        int tmp1 = 0;
        while(tmp1 &lt; n &amp;&amp; a\[tmp1\] == 0 )tmp1++;
        for(int i = n-1;i &gt;= 0;i--){
            if(i &gt; tmp1)printf(&quot;%d&quot;,!a\[i\]);
            else printf(&quot;%d&quot;,a\[i\]);
        }
        cout&lt;&lt;endl;
        continue;
    }

    memset(dp1,0,sizeof(dp1));
    if(str2\[0\] == &apos;0&apos;)dp1\[0\]\[0\]\[0\] = 1;
    else if(str2\[0\] == &apos;1&apos;)dp1\[0\]\[1\]\[1\] = 1;
    else {
        dp1\[0\]\[0\]\[0\] = 1;
        dp1\[0\]\[1\]\[1\] = 1;
    }
    for(int i = 0;i &lt; n-1;i++)
        for(int j = 0;j &lt; 2;j++)
            for(int k = 0;k &lt; 2;k++){
                if(dp1\[i\]\[j\]\[k\] == 0)continue;
                if(str1\[i\] == &apos;0&apos;){
                    if(str2\[i+1\] == &apos;0&apos;){
                        if(j == 0){
                            if(k == 0)Add2(dp1\[i+1\]\[j\]\[k\],dp1\[i\]\[j\]\[k\]);//0-&gt;0
                        }
                        else {
                            if(k == 1)Add2(dp1\[i+1\]\[1\]\[k\],dp1\[i\]\[j\]\[k\]);//1-&gt;1
                        }
                    }
                    else if(str2\[i+1\] == &apos;1&apos;){
                        if(j == 0){
                            if(k == 1)Add2(dp1\[i+1\]\[1\]\[k\],dp1\[i\]\[j\]\[k\]);//1-&gt;1
                        }
                        else {
                            if(k == 0)Add2(dp1\[i+1\]\[j\]\[k\],dp1\[i\]\[j\]\[k\]);//0-&gt;0
                        }
                    }
                    else {
                        if(k == 0)Add2(dp1\[i+1\]\[j\]\[k\],dp1\[i\]\[j\]\[k\]);//0-&gt;0
                        else Add2(dp1\[i+1\]\[1\]\[k\],dp1\[i\]\[j\]\[k\]);//1-&gt;1
                    }
                }
                else if(str1\[i\] == &apos;1&apos;){
                    if(str2\[i+1\] == &apos;0&apos;){
                        if(j == 0){
                            if(k == 1)Add2(dp1\[i+1\]\[1\]\[0\],dp1\[i\]\[j\]\[k\]);//1-&gt;0
                        }
                        else{
                            if(k == 0)Add2(dp1\[i+1\]\[1\]\[1\],dp1\[i\]\[j\]\[k\]);//0-&gt;1
                        }
                    }
                    else if(str2\[i+1\] == &apos;1&apos;){
                        if(j == 0){
                            if(k == 0)Add2(dp1\[i+1\]\[1\]\[1\],dp1\[i\]\[j\]\[k\]);//0-&gt;1
                        }
                        else{
                            if(k == 1)Add2(dp1\[i+1\]\[1\]\[0\],dp1\[i\]\[j\]\[k\]);//1-&gt;0
                        }
                    }
                    else {
                        if(k == 1)Add2(dp1\[i+1\]\[1\]\[0\],dp1\[i\]\[j\]\[k\]);//1-&gt;0
                        else Add2(dp1\[i+1\]\[1\]\[1\],dp1\[i\]\[j\]\[k\]);//0-&gt;1
                    }
                }
                else {
                    if(str2\[i+1\] == &apos;0&apos;){
                        if(j == 0){
                            if(k == 0)Add2(dp1\[i+1\]\[j\]\[k\],dp1\[i\]\[j\]\[k\]);
                            if(k == 1)Add2(dp1\[i+1\]\[1\]\[0\],dp1\[i\]\[j\]\[k\]);
                        }
                        else {
                            if(k == 0)Add2(dp1\[i+1\]\[1\]\[1\],dp1\[i\]\[j\]\[k\]);
                            if(k == 1)Add2(dp1\[i+1\]\[1\]\[1\],dp1\[i\]\[j\]\[k\]);
                        }
                    }
                    else if(str2\[i+1\] == &apos;1&apos;){
                        if(j == 0){
                            if(k == 0)Add2(dp1\[i+1\]\[1\]\[1\],dp1\[i\]\[j\]\[k\]);
                            if(k == 1)Add2(dp1\[i+1\]\[1\]\[1\],dp1\[i\]\[j\]\[k\]);
                        }
                        else {
                            if(k == 0)Add2(dp1\[i+1\]\[j\]\[k\],dp1\[i\]\[j\]\[k\]);
                            if(k == 1)Add2(dp1\[i+1\]\[1\]\[0\],dp1\[i\]\[j\]\[k\]);
                        }
                    }
                    else {
                        if(k == 0){
                            Add2(dp1\[i+1\]\[j\]\[0\],dp1\[i\]\[j\]\[k\]);
                            Add2(dp1\[i+1\]\[1\]\[1\],dp1\[i\]\[j\]\[k\]);
                        }
                        else {
                            Add2(dp1\[i+1\]\[1\]\[0\],dp1\[i\]\[j\]\[k\]);
                            Add2(dp1\[i+1\]\[1\]\[1\],dp1\[i\]\[j\]\[k\]);

                        }
                    }
                }
            }
    ans1 = 0;
    tj = -1;
    tk = -1;
    for(int j = 0;j &lt; 2;j++)
        for(int k = 0;k &lt; 2;k++){
            if(str1\[n-1\] == &apos;0&apos; &amp;&amp; k == 1)continue;
            if(str1\[n-1\] == &apos;1&apos; &amp;&amp; k == 0)continue;
            Add2(ans1,dp1\[n-1\]\[j\]\[k\]);
        }
    printf(&quot;AMBIGUOUS %d\\n&quot;,ans1);

}
return 0;
</code></pre><p>}</p>

          
        
      
    </div>

    

    
    
    
	
	<div>
		
	</div>
 
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/08/23/hdu4966/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/08/23/hdu4966/" itemprop="url">
                  HDU 4966 GGS-DDU （最小树形图）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-08-23 12:18:43" itemprop="dateCreated datePublished" datetime="2014-08-23T12:18:43+08:00">2014-08-23</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 13:43:28" itemprop="dateModified" datetime="2018-07-29T13:43:28+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/" itemprop="url" rel="index"><span itemprop="name">HDU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/图论/" itemprop="url" rel="index"><span itemprop="name">图论</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/图论/算法/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="HDU4966"><a href="#HDU4966" class="headerlink" title="HDU4966"></a><a href="http://acm.hdu.edu.cn/showproblem.php?pid=4966" target="_blank" rel="noopener">HDU4966</a></h2><p>最小树形图， 模板题。</p>
<h1 id="GGS-DDU"><a href="#GGS-DDU" class="headerlink" title="GGS-DDU"></a>GGS-DDU</h1><p><strong>Time Limit: 2000/1000 MS (Java/Others)    Memory Limit: 131072/131072 K (Java/Others) Total Submission(s): 302    Accepted Submission(s): 156</strong>  </p>
<p>Problem Description</p>
<p>Do you think this is a strange problem name? That is because you don’t know its full name—‘Good Good Study and Day Day Up!”. Very famous sentence! Isn’t it? Now “GGS-DDU” is lzqxh’s target! He has N courses and every course is divided into a plurality of levels. Just like College English have Level 4 and Level 6. To simplify the problem, we suppose that the i-th course has Levels from level 0 to level a[i]. And at the beginning, lzqxh is at Level 0 of every course. Because his target is “GGS-DDU”, lzqxh wants to reach the highest Level of every course. Fortunately, there are M tutorial classes. The i-th tutoial class requires that students must reach at least Level L1[i] of course c[i] before class begins. And after finishing the i-th tutorial class, the students will reach Level L2[i] of course d[i]. The i-th tutoial class costs lzqxh money[i]. For example, there is a tutorial class only students who reach at least Level 5 of “Tiyu” can apply. And after finishing this class, the student’s “MeiShu” will reach Level 10 if his “MeiShu”‘s Level is lower than 10. (Don’t ask me why! Supernatural class!!!”) Now you task is to help lzqxh to compute the minimum cost!</p>
<p>Input</p>
<p>The input contains multiple test cases. The first line of each case consists of two integers, N (N&lt;=50) and M (M&lt;=2000). The following line contains N integers, representing a[1] to a[N]. The sum of a[1] to a[N] will not exceed 500. The next M lines, each have five integers, indicating c[i], L1[i], d[i], L2[i] and money[i] (1&lt;=c[i], d[i]&lt;=N, 0&lt;=L1[i]&lt;=a[c[i]], 0&lt;=L2[i]&lt;=a[d[i]], money[i]&lt;=1000) for the i-th tutorial class. The courses are numbered from 1 to N. The input is terminated by N = M = 0.</p>
<p>Output</p>
<p>Output the minimum cost for achieving lzqxh’s target in a line. If his target can’t be achieved, just output -1.</p>
<p>Sample Input</p>
<p>3 4 3 3 1 1 0 2 3 10 2 1 1 2 10 1 2 3 1 10 3 1 1 3 10 0 0</p>
<p>Sample Output</p>
<p>40</p>
<p>Author</p>
<p>SYSU</p>
<p>Source</p>
<p><a href="http://acm.hdu.edu.cn/search.php?field=problem&amp;key=2014%20Multi-University%20Training%20Contest%209&amp;source=1&amp;searchmode=source" target="_blank" rel="noopener">2014 Multi-University Training Contest 9</a></p>
<pre><code>直接建图。套用最小树形图模板。
</code></pre><p>/* <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>***</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><br>Author        :kuangbin<br>Created Time  :2014/8/19 13:01:24<br>File Name     :20140819\1007.cpp<br>************************************************ */</p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;string.h&gt;</p>
<p>#include <iostream></iostream></p>
<p>#include <algorithm></algorithm></p>
<p>#include <vector></vector></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include <map></map></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;</p>
<p>#include &lt;stdlib.h&gt;</p>
<p>#include &lt;time.h&gt;<br>using namespace std;<br>const int INF = 0x3f3f3f3f;<br>const int MAXN = 1010;<br>const int MAXM = 400100;</p>
<p>struct Edge<br>{<br>    int u,v,cost;<br>};<br>Edge edge[MAXM];<br>int pre[MAXN],id[MAXN],visit[MAXN],in[MAXN];<br>int gao(int root,int n,int m,Edge edge[])<br>{<br>    int res = 0,u,v;<br>    while(1)<br>    {<br>        for(int i = 0;i &lt; n;i++)<br>            in[i] = INF;<br>        for(int i = 0;i &lt; m;i++)<br>            if(edge[i].u != edge[i].v &amp;&amp; edge[i].cost &lt; in[edge[i].v])<br>            {<br>                pre[edge[i].v] = edge[i].u;<br>                in[edge[i].v] = edge[i].cost;<br>            }<br>        for(int i = 0;i &lt; n;i++)<br>            if(i != root &amp;&amp; in[i] == INF)<br>                return -1;<br>        int tn = 0;<br>        memset(id,-1,sizeof(id));<br>        memset(visit,-1,sizeof(visit));<br>        in[root] = 0;<br>        for(int i = 0;i &lt; n;i++)<br>        {<br>            res += in[i];<br>            v = i;<br>            while( visit[v] != i &amp;&amp; id[v] == -1 &amp;&amp; v != root)<br>            {<br>                visit[v] = i;<br>                v = pre[v];<br>            }<br>            if( v != root &amp;&amp; id[v] == -1 )<br>            {<br>                for(int u = pre[v]; u != v ;u = pre[u])<br>                    id[u] = tn;<br>                id[v] = tn++;<br>            }<br>        }<br>        if(tn == 0)break;<br>        for(int i = 0;i &lt; n;i++)<br>            if(id[i] == -1)<br>                id[i] = tn++;<br>        for(int i = 0;i &lt; m;)<br>        {<br>            v = edge[i].v;<br>            edge[i].u = id[edge[i].u];<br>            edge[i].v = id[edge[i].v];<br>            if(edge[i].u != edge[i].v)<br>                edge[i++].cost -= in[v];<br>            else<br>                swap(edge[i],edge[–m]);<br>        }<br>        n = tn;<br>        root = id[root];<br>    }<br>    return res;<br>}<br>int g[MAXN][MAXN];</p>
<p>int a[100];<br>int sum[100];</p>
<p>int main()<br>{<br>    //freopen(“in.txt”,”r”,stdin);<br>    //freopen(“out.txt”,”w”,stdout);<br>    int n,m;<br>    while(scanf(“%d%d”,&amp;n,&amp;m) == 2 ){<br>        if(n == 0 &amp;&amp; m == 0)break;<br>        sum[0] = 0;<br>        for(int i = 1;i &lt;= n;i++){<br>            scanf(“%d”,&amp;a[i]);<br>            sum[i] = sum[i-1] + a[i]+1;<br>        }<br>        int start = sum[n];<br>        int tot = sum[n] + 1;<br>        for(int i = 0;i &lt; tot;i++)<br>            for(int j = 0;j &lt; tot;j++)<br>                g[i][j] = INF;<br>        for(int i = 0;i &lt; n;i++)<br>            g[start][sum[i]] = 0;<br>        int c1,d1,l1,l2,mon;<br>        while(m–){<br>            scanf(“%d%d%d%d%d”,&amp;c1,&amp;l1,&amp;d1,&amp;l2,&amp;mon);<br>            int u = sum[c1-1]+l1;<br>            int v = sum[d1-1]+l2;<br>            g[u][v] = min(g[u][v],mon);<br>        }<br>        for(int i = 1;i &lt;= n;i++){<br>            for(int j = 1;j &lt;= a[i];j++)<br>                g[sum[i-1]+j][sum[i-1]+j-1] = 0;<br>        }<br>        int L = 0;<br>        for(int i = 0;i &lt; tot;i++)<br>            for(int j = 0;j &lt; tot;j++)<br>                if(g[i][j] &lt; INF){<br>                    edge[L].u = i;<br>                    edge[L].v = j;<br>                    edge[L++].cost = g[i][j];<br>                }<br>        int ans = gao(start,tot,L,edge);<br>        printf(“%d\n”,ans);<br>    }<br>    return 0;<br>}</p>

          
        
      
    </div>

    

    
    
    
	
	<div>
		
	</div>
 
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/08/22/hdu4973/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/08/22/hdu4973/" itemprop="url">
                  HDU 4973 A simple simulation problem. （线段树）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-08-22 14:59:28" itemprop="dateCreated datePublished" datetime="2014-08-22T14:59:28+08:00">2014-08-22</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 13:43:28" itemprop="dateModified" datetime="2018-07-29T13:43:28+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/" itemprop="url" rel="index"><span itemprop="name">HDU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/数据结构/" itemprop="url" rel="index"><span itemprop="name">数据结构</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/数据结构/算法/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/数据结构/算法/线段树/" itemprop="url" rel="index"><span itemprop="name">线段树</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="HDU-4973"><a href="#HDU-4973" class="headerlink" title="HDU 4973 "></a><a href="http://acm.hdu.edu.cn/showproblem.php?pid=4973" target="_blank" rel="noopener">HDU 4973 </a></h2><p>只需要使用线段树进行一些基本的区间操作就可以了。 很简单的题。</p>
<h1 id="A-simple-simulation-problem"><a href="#A-simple-simulation-problem" class="headerlink" title="A simple simulation problem."></a>A simple simulation problem.</h1><p><strong>Time Limit: 10000/5000 MS (Java/Others)    Memory Limit: 65536/65536 K (Java/Others) Total Submission(s): 313    Accepted Submission(s): 128</strong>  </p>
<p>Problem Description</p>
<p>There are n types of cells in the lab, numbered from 1 to n. These cells are put in a queue, the i-th cell belongs to type i. Each time I can use mitogen to double the cells in the interval [l, r]. For instance, the original queue is {1 2 3 3 4 5}, after using a mitogen in the interval [2, 5] the queue will be {1 2 2 3 3 3 3 4 4 5}. After some operations this queue could become very long, and I can’t figure out maximum count of cells of same type. Could you help me?</p>
<p>Input</p>
<p>The first line contains a single integer t (1 &lt;= t &lt;= 20), the number of test cases. For each case, the first line contains 2 integers (1 &lt;= n,m&lt;= 50000) indicating the number of cell types and the number of operations. For the following m lines, each line represents an operation. There are only two kinds of operations: Q and D. And the format is: “Q l r”, query the maximum number of cells of same type in the interval [l, r]; “D l r”, double the cells in the interval [l, r]; (0 &lt;= r – l &lt;= 10^8, 1 &lt;= l, r &lt;= the number of all the cells)</p>
<p>Output</p>
<p>For each case, output the case number as shown. Then for each query “Q l r”, print the maximum number of cells of same type in the interval [l, r]. Take the sample output for more details.</p>
<p>Sample Input</p>
<p>1 5 5 D 5 5 Q 5 6 D 2 3 D 1 2 Q 1 7</p>
<p>Sample Output</p>
<p>Case #1: 2 3</p>
<p>Source</p>
<p><a href="http://acm.hdu.edu.cn/search.php?field=problem&amp;key=2014%20Multi-University%20Training%20Contest%2010&amp;source=1&amp;searchmode=source" target="_blank" rel="noopener">2014 Multi-University Training Contest 10</a></p>
<pre><code>代码：
</code></pre><p>/* <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>***</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><br>Author        :kuangbin<br>Created Time  :2014/8/21 13:16:18<br>File Name     :20140821\1003.cpp<br>************************************************ */</p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;string.h&gt;</p>
<p>#include <iostream></iostream></p>
<p>#include <algorithm></algorithm></p>
<p>#include <vector></vector></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include <map></map></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;</p>
<p>#include &lt;stdlib.h&gt;</p>
<p>#include &lt;time.h&gt;<br>using namespace std;<br>const int MAXN = 50010;<br>struct Node{<br>    int l,r;<br>    long long Max;<br>    long long sum;<br>    long long lazy;<br>}segTree[MAXN&lt;&lt;2];<br>void push_up(int i){<br>    if(segTree[i].l == segTree[i].r)return;<br>    segTree[i].sum = segTree[i&lt;&lt;1].sum + segTree[(i&lt;&lt;1)|1].sum;<br>    segTree[i].Max = max(segTree[i&lt;&lt;1].Max,segTree[(i&lt;&lt;1)|1].Max);<br>}<br>void push_down(int i){<br>    if(segTree[i].l == segTree[i].r)return;<br>    if(segTree[i].lazy != 1){<br>        segTree[i&lt;&lt;1].sum = segTree[i&lt;&lt;1].sum<em>segTree[i].lazy;<br>        segTree[i&lt;&lt;1].Max = segTree[i&lt;&lt;1].Max</em>segTree[i].lazy;<br>        segTree[(i&lt;&lt;1)|1].sum = segTree[(i&lt;&lt;1)|1].sum<em>segTree[i].lazy;<br>        segTree[(i&lt;&lt;1)|1].Max = segTree[(i&lt;&lt;1)|1].Max</em>segTree[i].lazy;<br>        segTree[i&lt;&lt;1].lazy <em>= segTree[i].lazy;<br>        segTree[(i&lt;&lt;1)|1].lazy </em>= segTree[i].lazy;<br>        segTree[i].lazy = 1;<br>    }<br>}<br>void build(int i,int l,int r){<br>    segTree[i].l = l;<br>    segTree[i].r = r;<br>    segTree[i].lazy = 1;<br>    if(l == r){<br>        segTree[i].sum = segTree[i].Max = 1;<br>        return;<br>    }<br>    int mid = (l+r)/2;<br>    build(i&lt;&lt;1,l,mid);<br>    build((i&lt;&lt;1)|1,mid+1,r);<br>    push_up(i);<br>}<br>void DOU(int i,int l,int r){<br>    if(l &gt; r)return;<br>    if(segTree[i].l == l &amp;&amp; segTree[i].r == r){<br>        segTree[i].sum <em>= 2;<br>        segTree[i].Max </em>= 2;<br>        segTree[i].lazy *= 2;<br>        return;<br>    }<br>    push_down(i);<br>    int mid = (segTree[i].l + segTree[i].r)/2;<br>    if(r &lt;= mid)DOU(i&lt;&lt;1,l,r);<br>    else if(l &gt; mid)DOU((i&lt;&lt;1)|1,l,r);<br>    else {<br>        DOU(i&lt;&lt;1,l,mid);<br>        DOU((i&lt;&lt;1)|1,mid+1,r);<br>    }<br>    push_up(i);<br>}<br>long long query_Max(int i,int l,int r){<br>    if(l &gt; r)return 0;<br>    if(segTree[i].l == l &amp;&amp; segTree[i].r == r)<br>        return segTree[i].Max;<br>    push_down(i);<br>    int mid = (segTree[i].l + segTree[i].r)/2;<br>    if(r &lt;= mid)return query_Max(i&lt;&lt;1,l,r);<br>    else if(l &gt; mid)return query_Max((i&lt;&lt;1)|1,l,r);<br>    else return max(query_Max(i&lt;&lt;1,l,mid),query_Max((i&lt;&lt;1)|1,mid+1,r));<br>}<br>long long query_Sum(int i,int l,int r){<br>    if(l &gt; r)return 0;<br>    if(segTree[i].l == l &amp;&amp; segTree[i].r == r)<br>        return segTree[i].sum;<br>    push_down(i);<br>    int mid = (segTree[i].l + segTree[i].r)/2;<br>    if(r &lt;= mid)return query_Sum(i&lt;&lt;1,l,r);<br>    else if(l &gt; mid)return query_Sum((i&lt;&lt;1)|1,l,r);<br>    else return query_Sum(i&lt;&lt;1,l,mid)+query_Sum((i&lt;&lt;1)|1,mid+1,r);<br>}<br>int get_id(long long k){<br>    int i = 1;<br>    while(segTree[i].l != segTree[i].r){<br>        push_down(i);<br>        if(segTree[i&lt;&lt;1].sum &gt;= k)i = i&lt;&lt;1;<br>        else {<br>            k -= segTree[i&lt;&lt;1].sum;<br>            i = (i&lt;&lt;1)|1;<br>        }<br>    }<br>    return segTree[i].l;<br>}<br>void ADD(int i,int id,long long val){<br>    if(segTree[i].l == id &amp;&amp; segTree[i].r == id){<br>        segTree[i].sum += val;<br>        segTree[i].Max += val;<br>        return;<br>    }<br>    push_down(i);<br>    int mid = (segTree[i].l + segTree[i].r)/2;<br>    if(id &lt;= mid)ADD(i&lt;&lt;1,id,val);<br>    else ADD((i&lt;&lt;1)|1,id,val);<br>    push_up(i);<br>}<br>int n;<br>void gao1(long long l,long long r){<br>    int id1 = get_id(l);<br>    int id2 = get_id(r);<br>    if(id1 == id2){<br>        ADD(1,id1,r-l+1);<br>        return;<br>    }<br>    ADD(1,id2,r-query_Sum(1,1,id2-1));<br>    DOU(1,id1+1,id2-1);<br>    ADD(1,id1,query_Sum(1,1,id1)-l+1);<br>}<br>long long gao2(long long l,long long r){<br>    int id1 = get_id(l);<br>    int id2 = get_id(r);<br>    if(id1 == id2){<br>        return r-l+1;<br>    }<br>    long long ans = query_Max(1,id1+1,id2-1);<br>    ans = max(ans,query_Sum(1,1,id1)-l+1);<br>    ans = max(ans,r-query_Sum(1,1,id2-1));<br>    return ans;<br>}</p>
<p>int main()<br>{<br>    //freopen(“1003.in”,”r”,stdin);<br>    //freopen(“out.txt”,”w”,stdout);<br>    int T;<br>    int iCase = 0;<br>    int m;<br>    scanf(“%d”,&amp;T);<br>    while(T–){<br>        iCase++;<br>        printf(“Case #%d:\n”,iCase);<br>        scanf(“%d%d”,&amp;n,&amp;m);<br>        build(1,1,n);<br>        char op[10];<br>        long long l,r;<br>        while(m–){<br>            scanf(“%s%I64d%I64d”,op,&amp;l,&amp;r);<br>            if(op[0] == ‘D’)gao1(l,r);<br>            else printf(“%d\n”,(int)gao2(l,r));<br>        }<br>    }<br>    return 0;<br>}</p>

          
        
      
    </div>

    

    
    
    
	
	<div>
		
	</div>
 
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/08/22/hdu4979/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/08/22/hdu4979/" itemprop="url">
                  HDU 4979 A simple math problem. （Dancing Links）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-08-22 14:43:57" itemprop="dateCreated datePublished" datetime="2014-08-22T14:43:57+08:00">2014-08-22</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 13:43:28" itemprop="dateModified" datetime="2018-07-29T13:43:28+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Dancing-Links/" itemprop="url" rel="index"><span itemprop="name">Dancing Links</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Dancing-Links/HDU/" itemprop="url" rel="index"><span itemprop="name">HDU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Dancing-Links/HDU/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Dancing-Links/HDU/Online-Judge/算法/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="HDU-4979"><a href="#HDU-4979" class="headerlink" title="HDU 4979 "></a><a href="http://acm.hdu.edu.cn/showproblem.php?pid=4979" target="_blank" rel="noopener">HDU 4979 </a></h2><h1 id="A-simple-math-problem"><a href="#A-simple-math-problem" class="headerlink" title="A simple math problem."></a>A simple math problem.</h1><p><strong>Time Limit: 2000/1000 MS (Java/Others)    Memory Limit: 65536/65536 K (Java/Others) Total Submission(s): 40    Accepted Submission(s): 9</strong>  </p>
<p>Problem Description</p>
<p>Dragon loves lottery, he will try his luck every week. One day, the lottery company brings out a new form of lottery called accumulated lottery. In a normal lottery, you pick 7 numbers from N numbers. You will get reward according to how many numbers you match. If you match all 7 numbers, you will get the top prize for 1 billion dollars!!! Unlike normal lottery, an M-accumulated lottery allows you to pick M numbers from N numbers. If M is big enough, this may significantly increase your possibility to win. (Of course it cost more…) Some people buy multiple accumulated lotteries to guarantee a higher possibility to get the top prize. Despite of this, it’s still not worthy to guarantee a top prize.Knowing this, Dragon changes his target to second tier prize. <strong>To get a second tier prize, you need to contain all of the R numbers with M numbers picked.</strong>Given N, M and R, Dragon wants to know how many M-accumulated lotteries he needs to buy, so that he can guarantee that he can get at least the second tier prize.</p>
<p>Input</p>
<p>The first line of input contains only one integer T, the number of test cases. For each case, there’s a single line contains N, M and R(1&lt;=R&lt;=M&lt;=N&lt;=8).</p>
<p>Output</p>
<p>Each output should occupy one line. Each line should start with “Case #i: “, with i implying the case number. For each case, just output the result with no other leading or tailing spaces.</p>
<p>Sample Input</p>
<p>3 2 1 1 2 2 1 2 2 2</p>
<p>Sample Output</p>
<p>Case #1: 2 Case #2: 1 Case #3: 1</p>
<p>Source</p>
<p><a href="http://acm.hdu.edu.cn/search.php?field=problem&amp;key=2014%20Multi-University%20Training%20Contest%2010&amp;source=1&amp;searchmode=source" target="_blank" rel="noopener">2014 Multi-University Training Contest 10</a></p>
<h3 id="相等在-N个数的组合C-n-m-中选择最少的个数，覆盖所有-C-n-k-的组合。"><a href="#相等在-N个数的组合C-n-m-中选择最少的个数，覆盖所有-C-n-k-的组合。" class="headerlink" title="相等在 N个数的组合C(n,m) 中选择最少的个数，覆盖所有 C(n,k)的组合。"></a>相等在 N个数的组合C(n,m) 中选择最少的个数，覆盖所有 C(n,k)的组合。</h3><p>可以用Dancing Links的可重复覆盖去搞。   这题比较恶心的就是要打表。 比赛的时候打表一直出不来  8 5  4 这组数据。 于是有了很多狂交80次来猜8 5 4 这个结果的故事。 除了8 5 4其余打表都很快的、。 8 5 4 好像要打好久。  8 5 4 结果其实是 20.   AC程序：</p>
<p>/* <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>***</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><br>Author        :kuangbin<br>Created Time  :2014/8/21 17:10:33<br>File Name     :09_2.cpp<br>************************************************ */</p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;string.h&gt;</p>
<p>#include <iostream></iostream></p>
<p>#include <algorithm></algorithm></p>
<p>#include <vector></vector></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include <map></map></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;</p>
<p>#include &lt;stdlib.h&gt;</p>
<p>#include &lt;time.h&gt;<br>using namespace std;<br>int a[] = {<br>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,2,3,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,2,6,0,0,0,0,0,0,0,2,3,4,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,3,10,0,0,0,0,0,0,0,2,4,10,0,0,0,0,0,0,2,3,4,5,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,0,0,0,0,3,15,0,0,0,0,0,0,0,2,6,20,0,0,0,0,0,0,2,3,6,15,0,0,0,0,0,2,3,4,5,6,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,4,21,0,0,0,0,0,0,0,3,7,35,0,0,0,0,0,0,2,5,12,35,0,0,0,0,0,2,3,5,9,21,0,0,0,0,2,3,4,5,6,7,0,0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,0,0,0,0,0,4,28,0,0,0,0,0,0,0,3,11,56,0,0,0,0,0,0,2,6,14,70,0,0,0,0,0,2,4,8,0,56,0,0,0,0,2,3,4,7,12,28,0,0,0,2,3,4,5,6,7,8,0,0,1,1,1,1,1,1,1,1,</p>
<p>};</p>
<p>int main()<br>{<br>    //freopen(“in.txt”,”r”,stdin);<br>    //freopen(“out.txt”,”w”,stdout);</p>
<pre><code>int T;
int iCase = 0;
scanf(&quot;%d&quot;,&amp;T);
while(T--){
    iCase++;
    int n,m,r;
    scanf(&quot;%d%d%d&quot;,&amp;n,&amp;m,&amp;r);
    if(n == 8 &amp;&amp; m == 5 &amp;&amp; r == 4){
        printf(&quot;Case #%d: 20\\n&quot;,iCase);
        continue;
    }
    printf(&quot;Case #%d: %d\\n&quot;,iCase,a\[n\*9\*9+m*9+r\]);
}
return 0;
</code></pre><p>}</p>
<pre><code>打表程序：
</code></pre><p>/* <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>***</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><br>Author        :kuangbin<br>Created Time  :2014/8/21 16:23:46<br>File Name     :09.cpp<br>************************************************ */</p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;string.h&gt;</p>
<p>#include <iostream></iostream></p>
<p>#include <algorithm></algorithm></p>
<p>#include <vector></vector></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include <map></map></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;</p>
<p>#include &lt;stdlib.h&gt;</p>
<p>#include &lt;time.h&gt;<br>using namespace std;<br>const int MaxM = 15<em>15+10+1000;<br>const int MaxN = 15</em>15+10+1000;<br>const int maxnode = MaxN * MaxM;<br>const int INF = 0x3f3f3f3f;<br>struct DLX<br>{<br>    int n,m,size;<br>    int U[maxnode],D[maxnode],R[maxnode],L[maxnode],Row[maxnode],Col[maxnode];<br>    int H[MaxN],S[MaxM];<br>    int ansd;<br>    void init(int _n,int _m)<br>    {<br>        n = _n;<br>        m = _m;<br>        for(int i = 0;i &lt;= m;i++)<br>        {<br>            S[i] = 0;<br>            U[i] = D[i] = i;<br>            L[i] = i-1;<br>            R[i] = i+1;<br>        }<br>        R[m] = 0; L[0] = m;<br>        size = m;<br>        for(int i = 1;i &lt;= n;i++)H[i] = -1;<br>    }<br>    void Link(int r,int c)<br>    {<br>    //    printf(“%d %d\n”,r,c);<br>        ++S[Col[++size]=c];<br>        Row[size] = r;<br>        D[size] = D[c];<br>        U[D[c]] = size;<br>        U[size] = c;<br>        D[c] = size;<br>        if(H[r] &lt; 0)H[r] = L[size] = R[size] = size;<br>        else<br>        {<br>            R[size] = R[H[r]];<br>            L[R[H[r]]] = size;<br>            L[size] = H[r];<br>            R[H[r]] = size;<br>        }<br>    }<br>    void remove(int c)<br>    {<br>        for(int i = D[c];i != c;i = D[i])<br>            L[R[i]] = L[i], R[L[i]] = R[i];<br>    }<br>    void resume(int c)<br>    {<br>        for(int i = U[c];i != c;i = U[i])<br>            L[R[i]] = R[L[i]] = i;<br>    }<br>    bool v[MaxM];<br>    int f()<br>    {<br>        int ret = 0;<br>        for(int c = R[0]; c != 0;c = R[c])v[c] = true;<br>        for(int c = R[0]; c != 0;c = R[c])<br>            if(v[c])<br>            {<br>                ret++;<br>                v[c] = false;<br>                for(int i = D[c];i != c;i = D[i])<br>                    for(int j = R[i];j != i;j = R[j])<br>                        v[Col[j]] = false;<br>            }<br>        return ret;<br>    }<br>    void Dance(int d)<br>    {<br>        if(d + f() &gt;= ansd)return;<br>        if(R[0] == 0)<br>        {<br>            if(d &lt; ansd)ansd = d;<br>            return;<br>        }<br>        int c = R[0];<br>        for(int i = R[0];i != 0;i = R[i])<br>            if(S[i] &lt; S[c])<br>                c = i;<br>        for(int i = D[c];i != c;i = D[i])<br>        {<br>            remove(i);<br>            for(int j = R[i];j != i;j = R[j])remove(j);<br>            Dance(d+1);<br>            for(int j = L[i];j != i;j = L[j])resume(j);<br>            resume(i);<br>        }<br>    }<br>};<br>DLX g;<br>int a[MaxN];<br>int b[MaxM];<br>long long C[20][20];<br>void init2(){<br>    C[0][0] = 1;<br>    for(int i = 1;i &lt; 20;i++){<br>        C[i][0] = C[i][i] = 1;<br>        for(int j = 1;j &lt; i;j++)<br>            C[i][j] = C[i-1][j] + C[i-1][j-1];<br>    }<br>}<br>int main()<br>{<br>    //freopen(“in.txt”,”r”,stdin);<br>    freopen(“out.txt”,”w”,stdout);<br>    init2();<br>    int T;<br>    int n,m,r;<br>    int iCase = 0;<br>    scanf(“%d”,&amp;T);<br>    //while(T–){</p>
<pre><code>for(n = 0;n &lt; 9;n++)
    for(m = 0;m &lt; 9;m++)
        for(r = 0;r &lt; 9;r++){
            if(n == 0 || m == 0 || r == 0){
                printf(&quot;0,&quot;);
                continue;
            }
            if( !(r &lt;= m &amp;&amp; m &lt;= n) ){
                printf(&quot;0,&quot;);
                continue;
            }
    iCase++;
//    scanf(&quot;%d%d%d&quot;,&amp;n,&amp;m,&amp;r);
    if(n == 8 &amp;&amp; m == 5 &amp;&amp; r == 4){
        printf(&quot;0,&quot;);
        continue;
    }
    int cnt1 = 0;
    int cnt2 = 0;
    for(int i = 0;i &lt; (1&lt;&lt;n);i++){
        int cc = 0;
        for(int j = 0;j &lt; n;j++)
            if(i&amp;(1&lt;&lt;j))
                cc++;
        if(cc == m)a\[++cnt1\] = i;
        if(cc == r)b\[++cnt2\] = i;
    }
    g.init(cnt1,cnt2);
    for(int i = 1;i &lt;= cnt1;i++)
        for(int j = 1;j &lt;= cnt2;j++)
            if((a\[i\]|b\[j\]) == a\[i\])
                g.Link(i,j);
    long long tmp = C\[n\]\[r\];
    long long tmp2 = C\[m\]\[r\];
    g.ansd = tmp;
    g.Dance(0);
    printf(&quot;%d,&quot;,g.ansd);
    //printf(&quot;Case #%d: %d\\n&quot;,iCase,g.ansd);
        }
</code></pre><p>//    }<br>    return 0;<br>}</p>

          
        
      
    </div>

    

    
    
    
	
	<div>
		
	</div>
 
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/08/22/hdu4975/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/08/22/hdu4975/" itemprop="url">
                  HDU 4975 A simple Gaussian elimination problem. （最大流+找环）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-08-22 14:37:12" itemprop="dateCreated datePublished" datetime="2014-08-22T14:37:12+08:00">2014-08-22</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 13:43:28" itemprop="dateModified" datetime="2018-07-29T13:43:28+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/" itemprop="url" rel="index"><span itemprop="name">HDU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/图论/" itemprop="url" rel="index"><span itemprop="name">图论</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/图论/算法/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/图论/算法/网络流/" itemprop="url" rel="index"><span itemprop="name">网络流</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="最大流-找环。"><a href="#最大流-找环。" class="headerlink" title="最大流+找环。"></a>最大流+找环。</h3><p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=4975" target="_blank" rel="noopener">HDU4975</a>   题目很明显，就是求最大流，然后判断最大流是不是多解。 多解的判断，通过找环来确定。</p>
<h1 id="A-simple-Gaussian-elimination-problem"><a href="#A-simple-Gaussian-elimination-problem" class="headerlink" title="A simple Gaussian elimination problem."></a>A simple Gaussian elimination problem.</h1><p><strong>Time Limit: 2000/1000 MS (Java/Others)    Memory Limit: 65536/65536 K (Java/Others) Total Submission(s): 561    Accepted Submission(s): 185</strong>  </p>
<p>Problem Description</p>
<p>Dragon is studying math. One day, he drew a table with several rows and columns, randomly wrote numbers on each elements of the table. Then he counted the sum of each row and column. Since he thought the map will be useless after he got the sums, he destroyed the table after that.However Dragon’s mom came back and found what he had done. She would give dragon a feast if Dragon could reconstruct the table, otherwise keep Dragon hungry. Dragon is so young and so simple so that the original numbers in the table are one-digit number (e.g. 0-9). Could you help Dragon to do that?</p>
<p>Input</p>
<p>The first line of input contains only one integer, T(&lt;=30), the number of test cases. Following T blocks, each block describes one test case.There are three lines for each block. The first line contains two integers N(&lt;=500) and M(&lt;=500), showing the number of rows and columns. The second line contains N integer show the sum of each row. The third line contains M integer show the sum of each column.</p>
<p>Output</p>
<p>Each output should occupy one line. Each line should start with “Case #i: “, with i implying the case number. For each case, if we cannot get the original table, just output: “So naive!”, else if we can reconstruct the table by more than one ways, you should output one line contains only: “So young!”, otherwise (only one way to reconstruct the table) you should output: “So simple!”.</p>
<p>Sample Input</p>
<p>3 1 1 5 5 2 2 0 10 0 10 2 2 2 2 2 2</p>
<p>Sample Output</p>
<p>Case #1: So simple! Case #2: So naive! Case #3: So young!</p>
<p>Source</p>
<p><a href="http://acm.hdu.edu.cn/search.php?field=problem&amp;key=2014%20Multi-University%20Training%20Contest%2010&amp;source=1&amp;searchmode=source" target="_blank" rel="noopener">2014 Multi-University Training Contest 10</a></p>
<pre><code>但是找环。发现标程竟然是错的。
</code></pre><p>1<br>3 2<br>18<br>9<br>3<br>15<br>15</p>
<pre><code>暴力搜找环会TLE。 这题可以和HDU 4888 互为参考下。   一种找环比较正确，而且快速的方法：和Tarjan的思路差不多。 就是从汇点开始去dfs,  记录哪些点是回不到end的。 然后就一遍dfs就可以解决了。
</code></pre><p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;string.h&gt;</p>
<p>#include <iostream></iostream></p>
<p>#include <algorithm></algorithm></p>
<p>#include <vector></vector></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include <map></map></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;</p>
<p>#include &lt;stdlib.h&gt;</p>
<p>#include &lt;time.h&gt;<br>using namespace std;</p>
<p>const int MAXN = 2010;//点数的最大值<br>const int MAXM = 1200010;//边数的最大值<br>const int INF = 0x3f3f3f3f;<br>struct Edge{<br>    int to,next,cap,flow;<br>}edge[MAXM];//注意是MAXM<br>int tol;<br>int head[MAXN];<br>void init(){<br>    tol = 2;<br>    memset(head,-1,sizeof(head));<br>}<br>void addedge(int u,int v,int w,int rw = 0){<br>    edge[tol].to = v; edge[tol].cap = w; edge[tol].flow = 0;<br>    edge[tol].next = head[u]; head[u] = tol++;<br>    edge[tol].to = u; edge[tol].cap = rw; edge[tol].flow = 0;<br>    edge[tol].next = head[v]; head[v] = tol++;<br>}<br>int Q[MAXN];<br>int dep[MAXN],cur[MAXN],sta[MAXN];<br>bool bfs(int s,int t,int n){<br>    int front = 0,tail = 0;<br>    memset(dep,-1,sizeof(dep[0])*(n+1));<br>    dep[s] = 0;<br>    Q[tail++] = s;<br>    while(front &lt; tail){<br>        int u = Q[front++];<br>        for(int i = head[u]; i != -1;i = edge[i].next){<br>            int v = edge[i].to;<br>            if(edge[i].cap &gt; edge[i].flow &amp;&amp; dep[v] == -1){<br>                dep[v] = dep[u] + 1;<br>                if(v == t)return true;<br>                Q[tail++] = v;<br>            }<br>        }<br>    }<br>    return false;<br>}<br>int dinic(int s,int t,int n){<br>    int maxflow = 0;<br>    while(bfs(s,t,n)){<br>        for(int i = 0;i &lt; n;i++)cur[i] = head[i];<br>        int u = s, tail = 0;<br>        while(cur[s] != -1){<br>            if(u == t){<br>                int tp = INF;<br>                for(int i = tail-1;i &gt;= 0;i–)<br>                    tp = min(tp,edge[sta[i]].cap-edge[sta[i]].flow);<br>                maxflow += tp;<br>                for(int i = tail-1;i &gt;= 0;i–){<br>                    edge[sta[i]].flow += tp;<br>                    edge[sta[i]^1].flow -= tp;<br>                    if(edge[sta[i]].cap-edge[sta[i]].flow == 0)<br>                        tail = i;<br>                }<br>                u = edge[sta[tail]^1].to;<br>            }<br>            else if(cur[u] != -1 &amp;&amp; edge[cur[u]].cap &gt; edge[cur[u]].flow &amp;&amp; dep[u] + 1 == dep[edge[cur[u]].to]){<br>                sta[tail++] = cur[u];<br>                u = edge[cur[u]].to;<br>            }<br>            else {<br>                while(u != s &amp;&amp; cur[u] == -1)<br>                    u = edge[sta[–tail]^1].to;<br>                cur[u] = edge[cur[u]].next;<br>            }<br>        }<br>    }<br>    return maxflow;<br>}<br>int a[510];<br>int b[510];<br>int id[510][510];</p>
<p>bool vis[MAXN],no[MAXN];<br>int Stack[MAXN],top;</p>
<p>bool dfs(int u,int pre,bool flag){<br>    vis[u] = 1;<br>    Stack[top++] = u;<br>    for(int i = head[u];i != -1;i = edge[i].next)<br>    {<br>        int v = edge[i].to;<br>        if(edge[i].cap &lt;= edge[i].flow)continue;<br>        if(v == pre)continue;<br>        if(!vis[v]){<br>            if(dfs(v,u,edge[i^1].flow &lt; edge[i^1].cap))return true;<br>        }<br>        else if(!no[v])return true;<br>    }<br>    if(!flag){<br>        while(1){<br>            int v = Stack[–top];<br>            no[v] = true;<br>            if(v == u)break;<br>        }<br>    }<br>    return false;<br>}<br>int main()<br>{<br>    //freopen(“in.txt”,”r”,stdin);<br>    //freopen(“out.txt”,”w”,stdout);<br>    int n,m,K;<br>    int T;<br>    int iCase = 0;<br>    scanf(“%d”,&amp;T);<br>    while(T–)<br>    {<br>        scanf(“%d%d”,&amp;n,&amp;m);<br>        K = 9;<br>        init();<br>        for(int i = 1;i &lt;= n;i++)<br>            for(int j = 1;j &lt;= m;j++)<br>            {<br>                id[i][j] = tol;<br>                addedge(i,j+n,K);<br>            }<br>        int sum1 = 0;<br>        for(int i = 1;i &lt;= n;i++)<br>        {<br>            scanf(“%d”,&amp;a[i]);<br>            sum1 += a[i];<br>            addedge(0,i,a[i]);<br>        }<br>        int sum2 = 0;<br>        for(int i = 1;i &lt;= m;i++)<br>        {<br>            scanf(“%d”,&amp;b[i]);<br>            sum2 += b[i];<br>            addedge(i+n,n+m+1,b[i]);<br>        }<br>        iCase++;<br>        printf(“Case #%d: “,iCase);<br>        if(sum1 != sum2)<br>        {<br>            printf(“So naive!\n”);<br>            continue;<br>        }<br>        int tmp = dinic(0,n+m+1,n+m+2);<br>        //printf(“maxflow : %d\n”,tmp);<br>        if(tmp != sum1)<br>        {<br>            printf(“So naive!\n”);<br>            continue;<br>        }<br>        memset(vis,false,sizeof(vis));<br>        memset(no,false,sizeof(no));<br>        top = 0;<br>        bool flag = dfs(n+m+1,n+m+1,0);<br>        if(flag)<br>        {<br>            printf(“So young!\n”);<br>            continue;<br>        }<br>        printf(“So simple!\n”);<br>    }<br>    return 0;<br>}</p>

          
        
      
    </div>

    

    
    
    
	
	<div>
		
	</div>
 
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/08/21/2014summer/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/08/21/2014summer/" itemprop="url">
                  暑假の小结
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-08-21 22:20:35" itemprop="dateCreated datePublished" datetime="2014-08-21T22:20:35+08:00">2014-08-21</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 20:16:21" itemprop="dateModified" datetime="2018-07-29T20:16:21+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/小结/" itemprop="url" rel="index"><span itemprop="name">小结</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <pre><code>7月、8月转瞬即逝。 缅怀逝去的时光，总结开启新的挑战。
</code></pre><hr>
<h3 id="慢慢地已经没有暑假的概念了。-每年都会回忆起过去的暑假自己在干嘛。"><a href="#慢慢地已经没有暑假的概念了。-每年都会回忆起过去的暑假自己在干嘛。" class="headerlink" title="慢慢地已经没有暑假的概念了。 每年都会回忆起过去的暑假自己在干嘛。"></a>慢慢地已经没有暑假的概念了。 每年都会回忆起过去的暑假自己在干嘛。</h3><h3 id="两个月貌似什么事情都没有做成，每天都感觉匆匆而过。"><a href="#两个月貌似什么事情都没有做成，每天都感觉匆匆而过。" class="headerlink" title="两个月貌似什么事情都没有做成，每天都感觉匆匆而过。"></a>两个月貌似什么事情都没有做成，每天都感觉匆匆而过。</h3><h3 id="7月："><a href="#7月：" class="headerlink" title="7月："></a>7月：</h3><h3 id="前期主要在实验室里面，写了一篇论文，请老师改了几遍，然后改了又改投出去了，现在等结果中。"><a href="#前期主要在实验室里面，写了一篇论文，请老师改了几遍，然后改了又改投出去了，现在等结果中。" class="headerlink" title="前期主要在实验室里面，写了一篇论文，请老师改了几遍，然后改了又改投出去了，现在等结果中。"></a>前期主要在实验室里面，写了一篇论文，请老师改了几遍，然后改了又改投出去了，现在等结果中。</h3><h3 id="然后期间水了一发上海的邀请赛，因为题目太逗，不能多说。"><a href="#然后期间水了一发上海的邀请赛，因为题目太逗，不能多说。" class="headerlink" title="然后期间水了一发上海的邀请赛，因为题目太逗，不能多说。"></a>然后期间水了一发上海的邀请赛，因为题目太逗，不能多说。</h3><h3 id="之后中间的一段时间主要在刷题学算法，搞了几套区域赛的题目，感觉收获不小，把一些算法自己深入理解了一下。"><a href="#之后中间的一段时间主要在刷题学算法，搞了几套区域赛的题目，感觉收获不小，把一些算法自己深入理解了一下。" class="headerlink" title="之后中间的一段时间主要在刷题学算法，搞了几套区域赛的题目，感觉收获不小，把一些算法自己深入理解了一下。"></a>之后中间的一段时间主要在刷题学算法，搞了几套区域赛的题目，感觉收获不小，把一些算法自己深入理解了一下。</h3><h3 id="然后7月底去北京参加百度之星，仰慕群神，纯粹旅游了一发。"><a href="#然后7月底去北京参加百度之星，仰慕群神，纯粹旅游了一发。" class="headerlink" title="然后7月底去北京参加百度之星，仰慕群神，纯粹旅游了一发。"></a>然后7月底去北京参加百度之星，仰慕群神，纯粹旅游了一发。</h3><h3 id="8月："><a href="#8月：" class="headerlink" title="8月："></a>8月：</h3><h3 id="主要都是在刷题，做多校，总结多校题。"><a href="#主要都是在刷题，做多校，总结多校题。" class="headerlink" title="主要都是在刷题，做多校，总结多校题。"></a>主要都是在刷题，做多校，总结多校题。</h3><h3 id="说起多校，总会想起为何自己这么弱，屡屡被虐！-通过多校暴露出了很多问题，很多题做不出来完全自己习惯不好！以后写题前一定先想清楚，把样例先模拟一遍再搞，否则会感觉自己阵脚大乱。"><a href="#说起多校，总会想起为何自己这么弱，屡屡被虐！-通过多校暴露出了很多问题，很多题做不出来完全自己习惯不好！以后写题前一定先想清楚，把样例先模拟一遍再搞，否则会感觉自己阵脚大乱。" class="headerlink" title="说起多校，总会想起为何自己这么弱，屡屡被虐！  通过多校暴露出了很多问题，很多题做不出来完全自己习惯不好！以后写题前一定先想清楚，把样例先模拟一遍再搞，否则会感觉自己阵脚大乱。"></a>说起多校，总会想起为何自己这么弱，屡屡被虐！  通过多校暴露出了很多问题，很多题做不出来完全自己习惯不好！以后写题前一定先想清楚，把样例先模拟一遍再搞，否则会感觉自己阵脚大乱。</h3><h3 id="有一次WA多次一直搞不出来，最后竟然发现题目编号从0开始，我写的从1开始，都是因为没有认真去模拟一遍样例。-此外提前算好复杂度，以前计算复杂度总忽略数据组数，后来很多时候发现很危险。"><a href="#有一次WA多次一直搞不出来，最后竟然发现题目编号从0开始，我写的从1开始，都是因为没有认真去模拟一遍样例。-此外提前算好复杂度，以前计算复杂度总忽略数据组数，后来很多时候发现很危险。" class="headerlink" title="有一次WA多次一直搞不出来，最后竟然发现题目编号从0开始，我写的从1开始，都是因为没有认真去模拟一遍样例。 此外提前算好复杂度，以前计算复杂度总忽略数据组数，后来很多时候发现很危险。"></a>有一次WA多次一直搞不出来，最后竟然发现题目编号从0开始，我写的从1开始，都是因为没有认真去模拟一遍样例。 此外提前算好复杂度，以前计算复杂度总忽略数据组数，后来很多时候发现很危险。</h3><h3 id="很大的一个问题就是心态了，开局不顺的话，后面整场都废了，会导致后面全局都乱了。-WA和TLE以后首先要保证不乱，好好找原因。-卡题切记要换题AC。"><a href="#很大的一个问题就是心态了，开局不顺的话，后面整场都废了，会导致后面全局都乱了。-WA和TLE以后首先要保证不乱，好好找原因。-卡题切记要换题AC。" class="headerlink" title="很大的一个问题就是心态了，开局不顺的话，后面整场都废了，会导致后面全局都乱了。 WA和TLE以后首先要保证不乱，好好找原因。 卡题切记要换题AC。"></a>很大的一个问题就是心态了，开局不顺的话，后面整场都废了，会导致后面全局都乱了。 WA和TLE以后首先要保证不乱，好好找原因。 卡题切记要换题AC。</h3><h3 id="自己的状态起伏很大，感觉越来越不在状态了。很多时候自己无法静下心来好好想题，对外界干扰太大。-归根结底，还是自己太弱，早就应该退役去了！"><a href="#自己的状态起伏很大，感觉越来越不在状态了。很多时候自己无法静下心来好好想题，对外界干扰太大。-归根结底，还是自己太弱，早就应该退役去了！" class="headerlink" title="自己的状态起伏很大，感觉越来越不在状态了。很多时候自己无法静下心来好好想题，对外界干扰太大。 归根结底，还是自己太弱，早就应该退役去了！"></a>自己的状态起伏很大，感觉越来越不在状态了。很多时候自己无法静下心来好好想题，对外界干扰太大。 归根结底，还是自己太弱，早就应该退役去了！</h3><h3 id="8月时候开始考驾照了，把科目一考完了，后面时间都要开始学车了，时间越来越紧张。"><a href="#8月时候开始考驾照了，把科目一考完了，后面时间都要开始学车了，时间越来越紧张。" class="headerlink" title="8月时候开始考驾照了，把科目一考完了，后面时间都要开始学车了，时间越来越紧张。"></a>8月时候开始考驾照了，把科目一考完了，后面时间都要开始学车了，时间越来越紧张。</h3><h3 id="期间，百度打电话来提供机会让我去实习，后面自己思考再三，还是拒绝了。-主要考虑到后面的半年时间太紧张，还有太多的时间要做。"><a href="#期间，百度打电话来提供机会让我去实习，后面自己思考再三，还是拒绝了。-主要考虑到后面的半年时间太紧张，还有太多的时间要做。" class="headerlink" title="期间，百度打电话来提供机会让我去实习，后面自己思考再三，还是拒绝了。  主要考虑到后面的半年时间太紧张，还有太多的时间要做。"></a>期间，百度打电话来提供机会让我去实习，后面自己思考再三，还是拒绝了。  主要考虑到后面的半年时间太紧张，还有太多的时间要做。</h3><h3 id="九月将有网络赛，十月要有区域赛，虽然感觉这些都和自己关系不大了，但是自己还是要认真做好该做的事情。-这是第四个暑假在准备ACM了，今年做的题明显没有以前多。-接触ACM已经三年半了，但是感觉什么都不会的状态。-今年两场区域赛结束也算彻底退役了，虽然自己是个早就应该退役的人了。-本来自己很注重团队的训练，-花了很多时间去练习限时组队训练，-后来岐哥教训的非常有道理，只有个人强了，团队才能强。-自己都还这么弱的时候，只能先管好自己。-ACM竞赛涉及内容确实太多，一个人想面面俱到确实花费时间太多了，三个人如果像一块拼图，可以完美覆盖当然是比较理想的。-后来想想自己还是不能去奢望队友可以去弥补你不会的，毕竟你自己都不会，怎么能要求别人弥补你的空缺呢。-慢慢也就淡定了，-很多东西不会就不会吧，学到一点会一点就足够了。"><a href="#九月将有网络赛，十月要有区域赛，虽然感觉这些都和自己关系不大了，但是自己还是要认真做好该做的事情。-这是第四个暑假在准备ACM了，今年做的题明显没有以前多。-接触ACM已经三年半了，但是感觉什么都不会的状态。-今年两场区域赛结束也算彻底退役了，虽然自己是个早就应该退役的人了。-本来自己很注重团队的训练，-花了很多时间去练习限时组队训练，-后来岐哥教训的非常有道理，只有个人强了，团队才能强。-自己都还这么弱的时候，只能先管好自己。-ACM竞赛涉及内容确实太多，一个人想面面俱到确实花费时间太多了，三个人如果像一块拼图，可以完美覆盖当然是比较理想的。-后来想想自己还是不能去奢望队友可以去弥补你不会的，毕竟你自己都不会，怎么能要求别人弥补你的空缺呢。-慢慢也就淡定了，-很多东西不会就不会吧，学到一点会一点就足够了。" class="headerlink" title="九月将有网络赛，十月要有区域赛，虽然感觉这些都和自己关系不大了，但是自己还是要认真做好该做的事情。 这是第四个暑假在准备ACM了，今年做的题明显没有以前多。  接触ACM已经三年半了，但是感觉什么都不会的状态。 今年两场区域赛结束也算彻底退役了，虽然自己是个早就应该退役的人了。    本来自己很注重团队的训练， 花了很多时间去练习限时组队训练， 后来岐哥教训的非常有道理，只有个人强了，团队才能强。 自己都还这么弱的时候，只能先管好自己。 ACM竞赛涉及内容确实太多，一个人想面面俱到确实花费时间太多了，三个人如果像一块拼图，可以完美覆盖当然是比较理想的。 后来想想自己还是不能去奢望队友可以去弥补你不会的，毕竟你自己都不会，怎么能要求别人弥补你的空缺呢。 慢慢也就淡定了， 很多东西不会就不会吧，学到一点会一点就足够了。"></a>九月将有网络赛，十月要有区域赛，虽然感觉这些都和自己关系不大了，但是自己还是要认真做好该做的事情。 这是第四个暑假在准备ACM了，今年做的题明显没有以前多。  接触ACM已经三年半了，但是感觉什么都不会的状态。 今年两场区域赛结束也算彻底退役了，虽然自己是个早就应该退役的人了。    本来自己很注重团队的训练， 花了很多时间去练习限时组队训练， 后来岐哥教训的非常有道理，只有个人强了，团队才能强。 自己都还这么弱的时候，只能先管好自己。 ACM竞赛涉及内容确实太多，一个人想面面俱到确实花费时间太多了，三个人如果像一块拼图，可以完美覆盖当然是比较理想的。 后来想想自己还是不能去奢望队友可以去弥补你不会的，毕竟你自己都不会，怎么能要求别人弥补你的空缺呢。 慢慢也就淡定了， 很多东西不会就不会吧，学到一点会一点就足够了。</h3><h3 id="接下来，先花点时间把自己的模板好好重构好，作为区域赛的参考吧！-也将会是更新的最后一份模板了。"><a href="#接下来，先花点时间把自己的模板好好重构好，作为区域赛的参考吧！-也将会是更新的最后一份模板了。" class="headerlink" title="接下来，先花点时间把自己的模板好好重构好，作为区域赛的参考吧！ 也将会是更新的最后一份模板了。"></a>接下来，先花点时间把自己的模板好好重构好，作为区域赛的参考吧！ 也将会是更新的最后一份模板了。</h3><h3 id="然后要把一些事情好好理一理了，前面弄得太混乱。"><a href="#然后要把一些事情好好理一理了，前面弄得太混乱。" class="headerlink" title="然后要把一些事情好好理一理了，前面弄得太混乱。"></a>然后要把一些事情好好理一理了，前面弄得太混乱。</h3>
          
        
      
    </div>

    

    
    
    
	
	<div>
		
	</div>
 
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/08/19/bzoj3572/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/08/19/bzoj3572/" itemprop="url">
                  BZOJ 3572: [Hnoi2014]世界树 （虚树，DP）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-08-19 22:21:24" itemprop="dateCreated datePublished" datetime="2014-08-19T22:21:24+08:00">2014-08-19</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 20:49:09" itemprop="dateModified" datetime="2018-07-29T20:49:09+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/图论/" itemprop="url" rel="index"><span itemprop="name">图论</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="BZOJ-3572"><a href="#BZOJ-3572" class="headerlink" title="BZOJ 3572 "></a><a href="http://www.lydsy.com/JudgeOnline/problem.php?id=3572" target="_blank" rel="noopener">BZOJ 3572 </a></h1><p>题意：一颗树，给了一些指定的点，树上的点离那个给点的点近就属于哪个点，距离相等属于编号小的。 问每个给定的点可以管辖多少个点。     参考链接：<a href="http://user.qzone.qq.com/251815992/blog/1407315782" target="_blank" rel="noopener">http://user.qzone.qq.com/251815992/blog/1407315782</a> <a href="http://lazycal.logdown.com/posts/202331-bzoj3572" target="_blank" rel="noopener">http://lazycal.logdown.com/posts/202331-bzoj3572</a>   虚树：包含了给定点，并收缩了不分叉边的连通子图。</p>
<h2 id="3572-Hnoi2014-世界树"><a href="#3572-Hnoi2014-世界树" class="headerlink" title="3572: [Hnoi2014]世界树"></a>3572: [Hnoi2014]世界树</h2><p>Time Limit: 20 Sec  Memory Limit: 512 MB Submit: 226  Solved: 145 [<a href="http://www.lydsy.com/JudgeOnline/submitpage.php?id=3572" target="_blank" rel="noopener">Submit</a>][<a href="http://www.lydsy.com/JudgeOnline/problemstatus.php?id=3572" target="_blank" rel="noopener">Status</a>]</p>
<h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p> 世界树是一棵无比巨大的树，它伸出的枝干构成了整个世界。在这里，生存着各种各样的种族和生灵，他们共同信奉着绝对公正公平的女神艾莉森，在他们的信条里，公平是使世界树能够生生不息、持续运转的根本基石。 世界树的形态可以用一个数学模型来描述：世界树中有n个种族，种族的编号分别从1到n，分别生活在编号为1到n的聚居地上，种族的编号与其聚居地的编号相同。有的聚居地之间有双向的道路相连，道路的长度为1。保证连接的方式会形成一棵树结构，即所有的聚居地之间可以互相到达，并且不会出现环。定义两个聚居地之间的距离为连接他们的道路的长度；例如，若聚居地a和b之间有道路，b和c之间有道路，因为每条道路长度为1而且又不可能出现环，所卧a与c之间的距离为2。 出于对公平的考虑，第i年，世界树的国王需要授权m[i]个种族的聚居地为临时议事处。对于某个种族x（x为种族的编号），如果距离该种族最近的临时议事处为y（y为议事处所在聚居地的编号），则种族x将接受y议事处的管辖（如果有多个临时议事处到该聚居地的距离一样，则y为其中编号最小的临时议事处）。 现在国王想知道，在q年的时间里，每一年完成授权后，当年每个临时议事处将会管理多少个种族（议事处所在的聚居地也将接受该议事处管理）。 现在这个任务交给了以智慧著称的灵长类的你：程序猿。请帮国王完成这个任务吧。</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>第一行为一个正整数n，表示世界树中种族的个数。 接下来n-l行，每行两个正整数x，y，表示x聚居地与y聚居地之间有一条长度为1的双 向道路。接下来一行为一个正整数q，表示国王询问的年数。 接下来q块，每块两行： 第i块的第一行为1个正整数m[i]，表示第i年授权的临时议事处的个数。 第i块的第二行为m[i]个正整数h[l]、h[2]、…、h[m[i]]，表示被授权为临时议事处的聚居地编号（保证互不相同）。</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><pre><code>输出包含q行，第i行为m\[i\]个整数，该行的第j(j=1，2…，，m\[i\])个数表示第i年被授权的聚居地h\[j\]的临时议事处管理的种族个数。
</code></pre><h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>10 21 32 43 54 61 73 83 94 10 1 5 2 61 5 27369 1 8 4 87103 5 29358</p>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>19 31411 10 1135 41311</p>
<h2 id="HINT"><a href="#HINT" class="headerlink" title="HINT"></a>HINT</h2><p>  N&lt;=300000, q&lt;=300000,m[1]+m[2]+…+m[q]&lt;=300000  </p>
<h2 id="Source"><a href="#Source" class="headerlink" title="Source"></a>Source</h2><pre><code>这题可谓当年2013changchun区域赛的J题的加强版。   虚树上进行DP的方法非常经典。
</code></pre><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ***************</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Author        :kuangbin</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Created Time  :2014/8/18 19:55:13</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">File Name     :E:\2014ACM\BZOJ\bzoj3572.cpp</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">************************************************ */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">300010</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> DEG = <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> to,next;</span><br><span class="line"></span><br><span class="line">&#125;edge[MAXN*<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> head[MAXN],tot;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	tot = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="keyword">sizeof</span>(head));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	edge[tot].to = v; edge[tot].next = head[u]; head[u] = tot++;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> fa[MAXN][DEG];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> deg[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BFS</span><span class="params">(<span class="keyword">int</span> root)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt;q;</span><br><span class="line"></span><br><span class="line">	deg[root] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	fa[root][<span class="number">0</span>] = root;</span><br><span class="line"></span><br><span class="line">	q.push(root);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> u = q.front();</span><br><span class="line"></span><br><span class="line">		q.pop();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; DEG;i++)</span><br><span class="line"></span><br><span class="line">			fa[u][i] = fa[fa[u][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = head[u];i != <span class="number">-1</span>;i = edge[i].next)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">int</span> v = edge[i].to;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(v == fa[u][<span class="number">0</span>])<span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">			deg[v] = deg[u] + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">			fa[v][<span class="number">0</span>] = u;</span><br><span class="line"></span><br><span class="line">			q.push(v);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">LCA</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(deg[u] &gt; deg[v])swap(u,v);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> hu = deg[u], hv = deg[v];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> tu = u, tv = v;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> det = hv-hu, i = <span class="number">0</span>; det;det&gt;&gt;=<span class="number">1</span>,i++)</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(det&amp;<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">			tv = fa[tv][i];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(tu == tv)<span class="keyword">return</span> tu;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = DEG<span class="number">-1</span>;i &gt;= <span class="number">0</span>;i--)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(fa[tu][i] == fa[tv][i])</span><br><span class="line"></span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">		tu = fa[tu][i];</span><br><span class="line"></span><br><span class="line">		tv = fa[tv][i];</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> fa[tu][<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> DFN[MAXN],Index;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> size[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	DFN[u] = ++Index;</span><br><span class="line"></span><br><span class="line">	size[u] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = head[u];i != <span class="number">-1</span>;i = edge[i].next)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> v = edge[i].to;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(v == fa[u][<span class="number">0</span>])<span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">		dfs(v);</span><br><span class="line"></span><br><span class="line">		size[u] += size[v];</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> d)</span></span>&#123;<span class="comment">//找到u往上的祖先中深度为d的点</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = DEG<span class="number">-1</span>;i &gt;= <span class="number">0</span>;i--)</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(deg[fa[u][i]] &gt;= d)</span><br><span class="line"></span><br><span class="line">			u = fa[u][i];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> u;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> h[MAXN],th[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> st[MAXN],father[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> t[MAXN],val[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ans[MAXN],w[MAXN];</span><br><span class="line"></span><br><span class="line">pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;g[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> DFN[i] &lt; DFN[j];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> m;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> tot = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;m);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;h[i]);</span><br><span class="line"></span><br><span class="line">		th[i] = h[i];<span class="comment">//备份</span></span><br><span class="line"></span><br><span class="line">		t[++tot] = h[i];</span><br><span class="line"></span><br><span class="line">		g[h[i]] = make_pair(<span class="number">0</span>,h[i]);</span><br><span class="line"></span><br><span class="line">		ans[h[i]] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	sort(h+<span class="number">1</span>,h+m+<span class="number">1</span>,cmp);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> top = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(!top)father[st[++top] = h[i]] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">int</span> p = h[i], lca = LCA(h[i],st[top]);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">for</span>(;deg[st[top]] &gt; deg[lca];--top)</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span>(deg[st[top<span class="number">-1</span>]] &lt;= deg[lca])</span><br><span class="line"></span><br><span class="line">					father[st[top]] = lca;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(st[top] != lca)&#123;</span><br><span class="line"></span><br><span class="line">				t[++tot] = lca;</span><br><span class="line"></span><br><span class="line">				g[lca] = make_pair(<span class="number">0x3f3f3f3f</span>,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">				father[lca] = st[top];</span><br><span class="line"></span><br><span class="line">				st[++top] = lca;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			father[p] = lca;</span><br><span class="line"></span><br><span class="line">			st[++top] = p;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	sort(t+<span class="number">1</span>,t+tot+<span class="number">1</span>,cmp);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= tot;i++)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> p = t[i];</span><br><span class="line"></span><br><span class="line">		val[p] = size[p];</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(i &gt; <span class="number">1</span>)w[p] = deg[p] - deg[father[p]];</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = tot;i &gt; <span class="number">1</span>;i--)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> p = t[i];</span><br><span class="line"></span><br><span class="line">		g[father[p]] = min(g[father[p]],make_pair(g[p].first+w[p],g[p].second));</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= tot;i++)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> p = t[i];</span><br><span class="line"></span><br><span class="line">		g[p] = min(g[p],make_pair(g[father[p]].first+w[p],g[father[p]].second));</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= tot;i++)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> p = t[i], f = father[p];</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(i == <span class="number">1</span>)ans[g[p].second] += n-size[p];</span><br><span class="line"></span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">int</span> x = find(p,deg[f]+<span class="number">1</span>), sum = size[x]-size[p];</span><br><span class="line"></span><br><span class="line">			val[f] -= size[x];</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(g[f].second == g[p].second)ans[g[p].second] += sum;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">int</span> mid = deg[p] - ((g[f].first + g[p].first + w[p])/<span class="number">2</span> - g[p].first);</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span>((g[f].first + g[p].first + w[p])%<span class="number">2</span> == <span class="number">0</span> &amp;&amp; g[p].second &gt; g[f].second)++mid;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">int</span> y = size[find(p,mid)] - size[p];</span><br><span class="line"></span><br><span class="line">				ans[g[p].second] += y;</span><br><span class="line"></span><br><span class="line">				ans[g[f].second] += sum-y;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= tot;i++)</span><br><span class="line"></span><br><span class="line">		ans[g[t[i]].second] += val[t[i]];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d "</span>,ans[th[i]]);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("in.txt","r",stdin);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("out.txt","w",stdout);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n) == <span class="number">1</span>)&#123;</span><br><span class="line"></span><br><span class="line">		init();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> u,v;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; n;i++)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;u,&amp;v);</span><br><span class="line"></span><br><span class="line">			addedge(u,v);</span><br><span class="line"></span><br><span class="line">			addedge(v,u);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		BFS(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">		Index = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		dfs(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> Q;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;Q);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span>(Q--)solve(n);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    
	
	<div>
		
	</div>
 
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/08/07/hdu4927/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/08/07/hdu4927/" itemprop="url">
                  HDU 4927 Series 1 （大数）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-08-07 20:59:28" itemprop="dateCreated datePublished" datetime="2014-08-07T20:59:28+08:00">2014-08-07</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 13:43:28" itemprop="dateModified" datetime="2018-07-29T13:43:28+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/" itemprop="url" rel="index"><span itemprop="name">HDU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/算法/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="HDU-4927"><a href="#HDU-4927" class="headerlink" title="HDU 4927"></a>HDU 4927</h1><h1 id="Series-1"><a href="#Series-1" class="headerlink" title="Series 1"></a><a href="http://acm.hdu.edu.cn/showproblem.php?pid=4927" target="_blank" rel="noopener">Series 1</a></h1><pre><code>很简单，首先要推一下公式。   最终答案就是 a\[n\] * C(n-1,n-1)  -  a\[n-1\] * C\[n-1,n-2\]  + a\[n-2\]\*C\[n-1,n-3\] - ..................  a\[1\]\*C\[n-1,0\] 这个搞。 主要是奉献一发高精度模板。
</code></pre><p>/* <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>***</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><br>Author        :kuangbin<br>Created Time  :2014/8/7 20:16:53<br>File Name     :E:\2014ACM\比赛\2014多校训练\2014多校6\HDU4927.cpp<br>************************************************ */</p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;string.h&gt;</p>
<p>#include <iostream></iostream></p>
<p>#include <algorithm></algorithm></p>
<p>#include <vector></vector></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include <map></map></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;</p>
<p>#include &lt;stdlib.h&gt;</p>
<p>#include &lt;time.h&gt;<br>using namespace std;</p>
<p>/*<br> * 完全大数模板<br> * 输出cin&gt;&gt;a<br> * 输出a.print();<br> * 注意这个输入不能自动去掉前导0的，可以先读入到char数组，去掉前导0，再用构造函数。<br> */</p>
<p>#define MAXN 9999</p>
<p>#define MAXSIZE 1010</p>
<p>#define DLEN 4</p>
<p>class BigNum<br>{<br>private:<br>    int a[1000];  //可以控制大数的位数<br>    int len;<br>public:<br>    BigNum(){len=1;memset(a,0,sizeof(a));}  //构造函数<br>    BigNum(const int);     //将一个int类型的变量转化成大数<br>    BigNum(const char*);   //将一个字符串类型的变量转化为大数<br>    BigNum(const BigNum &amp;); //拷贝构造函数<br>    BigNum &amp;operator=(const BigNum &amp;); //重载赋值运算符，大数之间进行赋值运算<br>    friend istream&amp; operator&gt;&gt;(istream&amp;,BigNum&amp;); //重载输入运算符<br>    friend ostream&amp; operator&lt;&lt;(ostream&amp;,BigNum&amp;); //重载输出运算符</p>
<pre><code>BigNum operator+(const BigNum &amp;)const;  //重载加法运算符，两个大数之间的相加运算
BigNum operator-(const BigNum &amp;)const;  //重载减法运算符，两个大数之间的相减运算
BigNum operator*(const BigNum &amp;)const;  //重载乘法运算符，两个大数之间的相乘运算
BigNum operator/(const int &amp;)const;     //重载除法运算符，大数对一个整数进行相除运算

BigNum operator^(const int &amp;)const;     //大数的n次方运算
int operator%(const int &amp;)const;        //大数对一个int类型的变量进行取模运算
bool operator&gt;(const BigNum &amp;T)const;   //大数和另一个大数的大小比较
bool operator&gt;(const int &amp;t)const;      //大数和一个int类型的变量的大小比较

void print();        //输出大数
</code></pre><p>};<br>BigNum::BigNum(const int b)   //将一个int类型的变量转化为大数<br>{<br>    int c,d=b;<br>    len=0;<br>    memset(a,0,sizeof(a));<br>    while(d&gt;MAXN)<br>    {<br>        c=d-(d/(MAXN+1))<em>(MAXN+1);<br>        d=d/(MAXN+1);<br>        a[len++]=c;<br>    }<br>    a[len++]=d;<br>}<br>BigNum::BigNum(const char </em>s)  //将一个字符串类型的变量转化为大数<br>{<br>    int t,k,index,L,i;<br>    memset(a,0,sizeof(a));<br>    L=strlen(s);<br>    len=L/DLEN;<br>    if(L%DLEN)len++;<br>    index=0;<br>    for(i=L-1;i&gt;=0;i-=DLEN)<br>    {<br>        t=0;<br>        k=i-DLEN+1;<br>        if(k&lt;0)k=0;<br>        for(int j=k;j&lt;=i;j++)<br>            t=t<em>10+s[j]-‘0’;<br>        a[index++]=t;<br>    }<br>}<br>BigNum::BigNum(const BigNum &amp;T):len(T.len)  //拷贝构造函数<br>{<br>    int i;<br>    memset(a,0,sizeof(a));<br>    for(i=0;i&lt;len;i++)<br>        a[i]=T.a[i];<br>}<br>BigNum &amp; BigNum::operator=(const BigNum &amp;n)  //重载赋值运算符，大数之间赋值运算<br>{<br>    int i;<br>    len=n.len;<br>    memset(a,0,sizeof(a));<br>    for(i=0;i&lt;len;i++)<br>        a[i]=n.a[i];<br>    return </em>this;<br>}<br>istream&amp; operator&gt;&gt;(istream &amp;in,BigNum &amp;b)<br>{<br>    char ch[MAXSIZE<em>4];<br>    int i=-1;<br>    in&gt;&gt;ch;<br>    int L=strlen(ch);<br>    int count=0,sum=0;<br>    for(i=L-1;i&gt;=0;)<br>    {<br>        sum=0;<br>        int t=1;<br>        for(int j=0;j&lt;4&amp;&amp;i&gt;=0;j++,i–,t</em>=10)<br>        {<br>            sum+=(ch[i]-‘0’)<em>t;<br>        }<br>        b.a[count]=sum;<br>        count++;<br>    }<br>    b.len=count++;<br>    return in;<br>}<br>ostream&amp; operator&lt;&lt;(ostream&amp; out,BigNum&amp; b)  //重载输出运算符<br>{<br>    int i;<br>    cout&lt;&lt;b.a[b.len-1];<br>    for(i=b.len-2;i&gt;=0;i–)<br>    {<br>        printf(“%04d”,b.a[i]);<br>    }<br>    return out;<br>}<br>BigNum BigNum::operator+(const BigNum &amp;T)const   //两个大数之间的相加运算<br>{<br>    BigNum t(</em>this);<br>    int i,big;<br>    big=T.len&gt;len?T.len:len;<br>    for(i=0;i&lt;big;i++)<br>    {<br>        t.a[i]+=T.a[i];<br>        if(t.a[i]&gt;MAXN)<br>        {<br>            t.a[i+1]++;<br>            t.a[i]-=MAXN+1;<br>        }<br>    }<br>    if(t.a[big]!=0)<br>       t.len=big+1;<br>    else t.len=big;<br>    return t;<br>}<br>BigNum BigNum::operator-(const BigNum &amp;T)const  //两个大数之间的相减运算<br>{<br>    int i,j,big;<br>    bool flag;<br>    BigNum t1,t2;<br>    if(<em>this&gt;T)<br>    {<br>        t1=</em>this;<br>        t2=T;<br>        flag=0;<br>    }<br>    else<br>    {<br>        t1=T;<br>        t2=<em>this;<br>        flag=1;<br>    }<br>    big=t1.len;<br>    for(i=0;i&lt;big;i++)<br>    {<br>        if(t1.a[i]&lt;t2.a[i])<br>        {<br>            j=i+1;<br>            while(t1.a[j]==0)<br>                j++;<br>            t1.a[j–]–;<br>            while(j&gt;i)<br>                t1.a[j–]+=MAXN;<br>            t1.a[i]+=MAXN+1-t2.a[i];<br>        }<br>        else t1.a[i]-=t2.a[i];<br>    }<br>    t1.len=big;<br>    while(t1.a[t1.len-1]==0 &amp;&amp; t1.len&gt;1)<br>    {<br>        t1.len–;<br>        big–;<br>    }<br>    if(flag)<br>        t1.a[big-1]=0-t1.a[big-1];<br>    return t1;<br>}<br>BigNum BigNum::operator</em>(const BigNum &amp;T)const  //两个大数之间的相乘<br>{<br>    BigNum ret;<br>    int i,j,up;<br>    int temp,temp1;<br>    for(i=0;i&lt;len;i++)<br>    {<br>        up=0;<br>        for(j=0;j&lt;T.len;j++)<br>        {<br>            temp=a[i]<em>T.a[j]+ret.a[i+j]+up;<br>            if(temp&gt;MAXN)<br>            {<br>                temp1=temp-temp/(MAXN+1)</em>(MAXN+1);<br>                up=temp/(MAXN+1);<br>                ret.a[i+j]=temp1;<br>            }<br>            else<br>            {<br>                up=0;<br>                ret.a[i+j]=temp;<br>            }<br>        }<br>        if(up!=0)<br>           ret.a[i+j]=up;<br>    }<br>    ret.len=i+j;<br>    while(ret.a[ret.len-1]==0 &amp;&amp; ret.len&gt;1)ret.len–;<br>    return ret;<br>}<br>BigNum BigNum::operator/(const int &amp;b)const  //大数对一个整数进行相除运算<br>{<br>    BigNum ret;<br>    int i,down=0;<br>    for(i=len-1;i&gt;=0;i–)<br>    {<br>        ret.a[i]=(a[i]+down<em>(MAXN+1))/b;<br>        down=a[i]+down</em>(MAXN+1)-ret.a[i]<em>b;<br>    }<br>    ret.len=len;<br>    while(ret.a[ret.len-1]==0 &amp;&amp; ret.len&gt;1)<br>        ret.len–;<br>    return ret;<br>}<br>int BigNum::operator%(const int &amp;b)const   //大数对一个 int类型的变量进行取模<br>{<br>    int i,d=0;<br>    for(i=len-1;i&gt;=0;i–)<br>        d=((d</em>(MAXN+1))%b+a[i])%b;<br>    return d;<br>}<br>BigNum BigNum::operator^(const int &amp;n)const  //大数的n次方运算<br>{<br>    BigNum t,ret(1);<br>    int i;<br>    if(n&lt;0)exit(-1);<br>    if(n==0)return 1;<br>    if(n==1)return <em>this;<br>    int m=n;<br>    while(m&gt;1)<br>    {<br>        t=</em>this;<br>        for(i=1;(i&lt;&lt;1)&lt;=m;i&lt;&lt;=1)<br>           t=t<em>t;<br>        m-=i;<br>        ret=ret</em>t;<br>        if(m==1)ret=ret<em>(</em>this);<br>    }<br>    return ret;<br>}<br>bool BigNum::operator&gt;(const BigNum &amp;T)const    //大数和另一个大数的大小比较<br>{<br>    int ln;<br>    if(len&gt;T.len)return true;<br>    else if(len==T.len)<br>    {<br>        ln=len-1;<br>        while(a[ln]==T.a[ln]&amp;&amp;ln&gt;=0)<br>          ln–;<br>        if(ln&gt;=0 &amp;&amp; a[ln]&gt;T.a[ln])<br>           return true;<br>        else<br>           return false;<br>    }<br>    else<br>       return false;<br>}<br>bool BigNum::operator&gt;(const int &amp;t)const  //大数和一个int类型的变量的大小比较<br>{<br>    BigNum b(t);<br>    return *this&gt;b;<br>}<br>void BigNum::print()   //输出大数<br>{<br>    int i;<br>    printf(“%d”,a[len-1]);<br>    for(i=len-2;i&gt;=0;i–)<br>      printf(“%04d”,a[i]);<br>    printf(“\n”);<br>}</p>
<p>int a[3010];<br>BigNum C[3010];</p>
<p>int main()<br>{<br>    //freopen(“1007.in”,”r”,stdin);<br>    //freopen(“out.txt”,”w”,stdout);<br>    int T;<br>    scanf(“%d”,&amp;T);<br>    int n;<br>    while(T–)<br>    {<br>        scanf(“%d”,&amp;n);<br>        for(int i = 0;i &lt; n;i++)<br>            scanf(“%d”,&amp;a[i]);<br>        C[0] = 1;<br>        for(int i = 1;i &lt; n;i++)<br>            C[i] = C[i-1]<em>(n-1-i+1)/i;<br>        BigNum ans1 = 0;<br>        BigNum ans2 = 0;<br>        for(int i = 0;i &lt; n;i++)<br>        {<br>            if((n-i)&amp;1)ans1 = ans1 + (C[i]</em>a[i]);<br>            else ans2 = ans2 + (C[i]*a[i]);<br>        }<br>        (ans1-ans2).print();<br>    }<br>    return 0;<br>}</p>

          
        
      
    </div>

    

    
    
    
	
	<div>
		
	</div>
 
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/8/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><span class="page-number current">9</span><a class="page-number" href="/page/10/">10</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><a class="extend next" rel="next" href="/page/10/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/blogLogo.jpg"
                alt="kuangbin" />
            
              <p class="site-author-name" itemprop="name">kuangbin</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">128</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">150</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">53</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  <a href="https://github.com/kuangbin" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://www.linkedin.com/in/kuangbin/" target="_blank" title="Linkedin"><i class="fa fa-fw fa-globe"></i>Linkedin</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:kuangbin2009@126.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://www.zhihu.com/people/kuang-bin-95" target="_blank" title="zhihu"><i class="fa fa-fw fa-globe"></i>zhihu</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="http://www.cnblogs.com/kuangbin/" target="_blank" title="cnblogs"><i class="fa fa-fw fa-globe"></i>cnblogs</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="http://wpa.qq.com/msgrd?v=3&uin=1691626124&site=qq&menu=yes" target="_blank" title="QQ"><i class="fa fa-fw fa-globe"></i>QQ</a>
                  
                </span>
              
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-友情链接"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.cnblogs.com/kuangbin/" title="我的博客园" target="_blank">我的博客园</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://zhiyi.live/" title="MoonChasing" target="_blank">MoonChasing</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://taowusheng.cn/" title="YIFEI" target="_blank">YIFEI</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://fancypei.github.io/" title="Fancy" target="_blank">Fancy</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://vincentxwd.github.io/" title="Wendong Xu" target="_blank">Wendong Xu</a>
                  </li>
                
              </ul>
            </div>
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">kuangbin</span>

  

  
</div>




  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动 v3.7.1</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://theme-next.org">NexT.Pisces</a> v6.3.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>












  















  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.3.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.3.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.3.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.3.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.3.0"></script>



  



  










  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  
  

  

  

  

  

  

</body>
</html>
