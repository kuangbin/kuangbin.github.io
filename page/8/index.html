<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">






  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-flash.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.3.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.3.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.3.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '6.3.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="kuangbin的博客">
<meta property="og:url" content="http://kuangbin.github.io/page/8/index.html">
<meta property="og:site_name" content="kuangbin的博客">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="kuangbin的博客">



  <link rel="alternate" href="/atom.xml" title="kuangbin的博客" type="application/atom+xml" />




  <link rel="canonical" href="http://kuangbin.github.io/page/8/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>kuangbin的博客</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>
	
	<a href="https://github.com/kuangbin"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png" alt="Fork me on GitHub"></a>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">kuangbin的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首页</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-about">
    <a href="/about/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-user"></i> <br />关于</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />标签</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />分类</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />归档</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-catalogue">
    <a href="/catalogue/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />目录</a>
  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/09/15/hdu5012/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/09/15/hdu5012/" itemprop="url">
                  HDU 5012 Dice （搜索）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-09-15 21:44:21" itemprop="dateCreated datePublished" datetime="2014-09-15T21:44:21+08:00">2014-09-15</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 13:43:28" itemprop="dateModified" datetime="2018-07-29T13:43:28+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/" itemprop="url" rel="index"><span itemprop="name">HDU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/搜索/" itemprop="url" rel="index"><span itemprop="name">搜索</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/搜索/算法/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5012" target="_blank" rel="noopener">HDU5012</a>   求最小步数，暴力bfs就可以了。 范围小，直接map进行映射。 随便搞啊</p>
<h1 id="Dice"><a href="#Dice" class="headerlink" title="Dice"></a>Dice</h1><p><strong>Time Limit: 2000/1000 MS (Java/Others)    Memory Limit: 65536/65536 K (Java/Others) Total Submission(s): 444    Accepted Submission(s): 263</strong></p>
<p>Problem Description</p>
<p>There are 2 special dices on the table. On each face of the dice, a distinct number was written. Consider a1.a2,a3,a4,a5,a6 to be numbers written on top face, bottom face, left face, right face, front face and back face of dice A. Similarly, consider b1.b2,b3,b4,b5,b6 to be numbers on specific faces of dice B. It’s guaranteed that all numbers written on dices are integers no smaller than 1 and no more than 6 while ai ≠ aj and bi ≠ bj for all i ≠ j. Specially, sum of numbers on opposite faces may not be 7. At the beginning, the two dices may face different(which means there exist some i, ai ≠ bi). Ddy wants to make the two dices look the same from all directions(which means for all i, ai = bi) only by the following four rotation operations.(Please read the picture for more information)</p>
<p><img src="http://acm.hdu.edu.cn/data/images/C534-1006-1.jpg" alt=""></p>
<p>Now Ddy wants to calculate the minimal steps that he has to take to achieve his goal.</p>
<p>Input</p>
<p>There are multiple test cases. Please process till EOF. For each case, the first line consists of six integers a1,a2,a3,a4,a5,a6, representing the numbers on dice A. The second line consists of six integers b1,b2,b3,b4,b5,b6, representing the numbers on dice B.</p>
<p>Output</p>
<p>For each test case, print a line with a number representing the answer. If there’s no way to make two dices exactly the same, output -1.</p>
<p>Sample Input</p>
<p>1 2 3 4 5 6 1 2 3 4 5 6 1 2 3 4 5 6 1 2 5 6 4 3 1 2 3 4 5 6 1 4 2 5 3 6</p>
<p>Sample Output</p>
<p>0 3 -1</p>
<p>Source</p>
<p><a href="http://acm.hdu.edu.cn/search.php?field=problem&amp;key=2014+ACM%2FICPC+Asia+Regional+Xi%27an+Online&amp;source=1&amp;searchmode=source" target="_blank" rel="noopener">2014 ACM/ICPC Asia Regional Xi’an Online</a></p>
<p>/* <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>***</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><br>Author        :kuangbin<br>Created Time  :2014/9/15 21:27:02<br>File Name     :E:\2014ACM\2014网络赛\2014西安\HDU5012.cpp<br>************************************************ */</p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;string.h&gt;</p>
<p>#include <iostream></iostream></p>
<p>#include <algorithm></algorithm></p>
<p>#include <vector></vector></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include <map></map></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;</p>
<p>#include &lt;stdlib.h&gt;</p>
<p>#include &lt;time.h&gt;<br>using namespace std;</p>
<p>string left(string ss){<br>    string ret;<br>    ret.resize(6);<br>    int a[] = {3,2,0,1,4,5};<br>    for(int i = 0;i &lt; 6;i++)<br>        ret[i] = ss[a[i]];<br>    return ret;<br>}<br>string right(string ss){<br>    string ret;<br>    ret.resize(6);<br>    int a[] = {2,3,1,0,4,5};<br>    for(int i = 0;i &lt; 6;i++)<br>        ret[i] = ss[a[i]];<br>    return ret;<br>}<br>string front(string ss){<br>    string ret;<br>    ret.resize(6);<br>    int a[] = {5,4,2,3,0,1};<br>    for(int i = 0;i &lt; 6;i++)<br>        ret[i] = ss[a[i]];<br>    return ret;<br>}<br>string back(string ss){<br>    string ret;<br>    ret.resize(6);<br>    int a[] = {4,5,2,3,1,0};<br>    for(int i = 0;i &lt; 6;i++)<br>        ret[i] = ss[a[i]];<br>    return ret;<br>}<br>int solve(string start,string end){<br>    map&lt;string,int&gt;mp;<br>    mp[start] = 0;<br>    queue<string>q;<br>    q.push(start);<br>    while(!q.empty()){<br>        string tmp = q.front();<br>        q.pop();<br>        if(tmp == end)return mp[tmp];<br>        string nn;<br>        nn = left(tmp);<br>        if(mp.find(nn) == mp.end()){<br>            mp[nn] = mp[tmp] + 1;<br>            q.push(nn);<br>        }<br>        nn = right(tmp);<br>        if(mp.find(nn) == mp.end()){<br>            mp[nn] = mp[tmp] + 1;<br>            q.push(nn);<br>        }<br>        nn = front(tmp);<br>        if(mp.find(nn) == mp.end()){<br>            mp[nn] = mp[tmp] + 1;<br>            q.push(nn);<br>        }<br>        nn = back(tmp);<br>        if(mp.find(nn) == mp.end()){<br>            mp[nn] = mp[tmp] + 1;<br>            q.push(nn);<br>        }<br>    }<br>    return -1;<br>}</string></p>
<p>int main()<br>{<br>    //freopen(“in.txt”,”r”,stdin);<br>    //freopen(“out.txt”,”w”,stdout);<br>    int a;<br>    while(scanf(“%d”,&amp;a) == 1){<br>        string str1 = “”;<br>        str1 += (char)(a+’0’);<br>        for(int i = 1;i &lt; 6;i++)<br>        {<br>            scanf(“%d”,&amp;a);<br>            str1 += (char)(a+’0’);<br>        }<br>        string str2 = “”;<br>        for(int i = 0;i &lt; 6;i++){<br>            scanf(“%d”,&amp;a);<br>            str2 += (char)(a+’0’);<br>        }<br>        printf(“%d\n”,solve(str1,str2));<br>    }<br>    return 0;<br>}</p>

          
        
      
    </div>

    

    
    
    
	
	<div>
		
	</div>
 
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/09/15/hdu5011/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/09/15/hdu5011/" itemprop="url">
                  HDU 5011 Game （博弈水题）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-09-15 00:18:01" itemprop="dateCreated datePublished" datetime="2014-09-15T00:18:01+08:00">2014-09-15</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 13:43:28" itemprop="dateModified" datetime="2018-07-29T13:43:28+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/" itemprop="url" rel="index"><span itemprop="name">HDU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/博弈/" itemprop="url" rel="index"><span itemprop="name">博弈</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/博弈/算法/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="HDU5011"><a href="#HDU5011" class="headerlink" title="HDU5011"></a><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5011" target="_blank" rel="noopener">HDU5011</a></h2><p>简单博弈。</p>
<h1 id="Game"><a href="#Game" class="headerlink" title="Game"></a>Game</h1><p><strong>Time Limit: 2000/1000 MS (Java/Others)    Memory Limit: 65536/65536 K (Java/Others) Total Submission(s): 155    Accepted Submission(s): 120</strong></p>
<p>Problem Description</p>
<p>Here is a game for two players. The rule of the game is described below: ● In the beginning of the game, there are a lot of piles of beads. ● Players take turns to play. Each turn, player choose a pile i and remove some (at least one) beads from it. Then he could do nothing or split pile i into two piles with a beads and b beads.(a,b &gt; 0 and a + b equals to the number of beads of pile i after removing) ● If after a player’s turn, there is no beads left, the player is the winner. Suppose that the two players are all very clever and they will use optimal game strategies. Your job is to tell whether the player who plays first can win the game.</p>
<p>Input</p>
<p>There are multiple test cases. Please process till EOF. For each test case, the first line contains a postive integer n(n &lt; 105) means there are n piles of beads. The next line contains n postive integer, the i-th postive integer ai(ai &lt; 231) means there are ai beads in the i-th pile.</p>
<p>Output</p>
<p>For each test case, if the first player can win the game, ouput “Win” and if he can’t, ouput “Lose”</p>
<p>Sample Input</p>
<p>1 1 2 1 1 3 1 2 3</p>
<p>Sample Output</p>
<p>Win Lose Lose</p>
<p>Source</p>
<p><a href="http://acm.hdu.edu.cn/search.php?field=problem&amp;key=2014+ACM%2FICPC+Asia+Regional+Xi%27an+Online&amp;source=1&amp;searchmode=source" target="_blank" rel="noopener">2014 ACM/ICPC Asia Regional Xi’an Online</a></p>
<pre><code>这题的常规做法就是，暴力打SG表。 找规律， 发现sg\[i\] = i; 然后就是所有数异或起来，为0就是输，否则赢。   当然如果你YY功力足够好，直接猜出异或，然后AC， 那也是可以的。  
</code></pre><p>/* <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>***</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><br>Author        :kuangbin<br>Created Time  :2014/9/15 0:15:56<br>File Name     :E:\2014ACM\2014网络赛\2014西安\HDU5011.cpp<br>************************************************ */</p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;string.h&gt;</p>
<p>#include <iostream></iostream></p>
<p>#include <algorithm></algorithm></p>
<p>#include <vector></vector></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include <map></map></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;</p>
<p>#include &lt;stdlib.h&gt;</p>
<p>#include &lt;time.h&gt;<br>using namespace std;</p>
<p>int main()<br>{<br>    //freopen(“in.txt”,”r”,stdin);<br>    //freopen(“out.txt”,”w”,stdout);<br>    int n;<br>    while(scanf(“%d”,&amp;n) == 1){<br>        int a,sum = 0;<br>        while(n–){<br>            scanf(“%d”,&amp;a);<br>            sum ^= a;<br>        }<br>        if(sum)printf(“Win\n”);<br>        else printf(“Lose\n”);<br>    }<br>    return 0;<br>}</p>

          
        
      
    </div>

    

    
    
    
	
	<div>
		
	</div>
 
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/09/15/hdu5009/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/09/15/hdu5009/" itemprop="url">
                  HDU 5009 Paint Pearls （DP）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-09-15 00:12:12" itemprop="dateCreated datePublished" datetime="2014-09-15T00:12:12+08:00">2014-09-15</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 13:43:28" itemprop="dateModified" datetime="2018-07-29T13:43:28+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/DP/" itemprop="url" rel="index"><span itemprop="name">DP</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/DP/HDU/" itemprop="url" rel="index"><span itemprop="name">HDU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/DP/HDU/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/DP/HDU/Online-Judge/算法/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5009" target="_blank" rel="noopener">HDU5009</a> DP。 需要简单优化下就可以了。</p>
<h1 id="Paint-Pearls"><a href="#Paint-Pearls" class="headerlink" title="Paint Pearls"></a>Paint Pearls</h1><h1 id="Time-Limit-4000-2000-MS-Java-Others-Memory-Limit-65536-65536-K-Java-Others-Total-Submission-s-715-Accepted-Submission-s-228"><a href="#Time-Limit-4000-2000-MS-Java-Others-Memory-Limit-65536-65536-K-Java-Others-Total-Submission-s-715-Accepted-Submission-s-228" class="headerlink" title="Time Limit: 4000/2000 MS (Java/Others)    Memory Limit: 65536/65536 K (Java/Others) Total Submission(s): 715    Accepted Submission(s): 228"></a><strong>Time Limit: 4000/2000 MS (Java/Others)    Memory Limit: 65536/65536 K (Java/Others) Total Submission(s): 715    Accepted Submission(s): 228</strong></h1><p>Problem Description</p>
<p>Lee has a string of n pearls. In the beginning, all the pearls have no color. He plans to color the pearls to make it more fascinating. He drew his ideal pattern of the string on a paper and asks for your help. In each operation, he selects some continuous pearls and all these pearls will be painted to <strong>their target colors.</strong> When he paints a string which has k different target colors, Lee will cost k2 points. Now, Lee wants to cost as few as possible to get his ideal string. You should tell him the minimal cost.</p>
<p>Input</p>
<p>There are multiple test cases. Please process till EOF. For each test case, the first line contains an integer n(1 ≤ n ≤ 5×104), indicating the number of pearls. The second line contains a1,a2,…,an (1 ≤ ai ≤ 109) indicating the target color of each pearl.</p>
<p>Output</p>
<p>For each test case, output the minimal cost in a line.</p>
<p>Sample Input</p>
<p>3 1 3 3 10 3 4 2 4 4 2 4 3 2 2</p>
<p>Sample Output</p>
<p>2 7</p>
<p>Source</p>
<p><a href="http://acm.hdu.edu.cn/search.php?field=problem&amp;key=2014+ACM%2FICPC+Asia+Regional+Xi%27an+Online&amp;source=1&amp;searchmode=source" target="_blank" rel="noopener">2014 ACM/ICPC Asia Regional Xi’an Online</a></p>
<pre><code>注意到 n &lt;= 5*10^4 而且花费是 k^2 所以DP转移的时候， 转移不同的不要超过 sqrt(i)个。   为了找到不同的，可以搞个set去转移。   也可以搞个并查集去合并。
</code></pre><p>/* <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>***</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><br>Author        :kuangbin<br>Created Time  :2014/9/14 23:23:59<br>File Name     :E:\2014ACM\2014网络赛\2014西安\HDU5009.cpp<br>************************************************ */</p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;string.h&gt;</p>
<p>#include <iostream></iostream></p>
<p>#include <algorithm></algorithm></p>
<p>#include <vector></vector></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include <map></map></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;</p>
<p>#include &lt;stdlib.h&gt;</p>
<p>#include &lt;time.h&gt;<br>using namespace std;<br>const int MAXN = 50010;<br>int a[MAXN];<br>int F[MAXN];<br>int find(int x){<br>    if(F[x] == -1)return x;<br>    return F[x] = find(F[x]);<br>}<br>void bing(int x,int y){<br>    int t1 = find(x), t2 = find(y);<br>    if(t1 != t2)F[t2] = t1;<br>}<br>int b[MAXN];<br>int last[MAXN];<br>int dp[MAXN];</p>
<p>int main()<br>{<br>    //freopen(“in.txt”,”r”,stdin);<br>    //freopen(“out.txt”,”w”,stdout);<br>    int n;<br>    while(scanf(“%d”,&amp;n) == 1){<br>        int cnt = 0;<br>        for(int i = 1;i &lt;= n;i++){<br>            scanf(“%d”,&amp;a[i]);<br>            b[cnt++] = a[i];<br>        }<br>        sort(b,b+cnt);<br>        cnt = unique(b,b+cnt) - b;<br>        map&lt;int,int&gt;mp;<br>        for(int i = 0;i &lt; cnt;i++){<br>            mp[b[i]] = i;<br>            last[i] = -1;<br>        }<br>        for(int i = 1;i &lt;= n;i++)a[i] = mp[a[i]];<br>        dp[0] = 0;<br>        F[0] = -1;<br>        for(int i = 1;i &lt;= n;i++){<br>            F[i] = -1;<br>            if(last[a[i]] != -1){<br>                bing(last[a[i]]-1,last[a[i]]);<br>            }<br>            last[a[i]] = i;<br>            dp[i] = i;<br>            int num = 0;<br>            for(int j = i;j &gt; 0;j = find(j-1)){<br>                num++;<br>                if(num<em>num &gt;= dp[i])break;<br>                int nxt = find(j-1);<br>                dp[i] = min(dp[i],dp[nxt]+num</em>num);<br>            }<br>        }<br>        printf(“%d\n”,dp[n]);<br>    }<br>    return 0;<br>}</p>

          
        
      
    </div>

    

    
    
    
	
	<div>
		
	</div>
 
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/09/14/hdu5008/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/09/14/hdu5008/" itemprop="url">
                  HDU 5008 Boring String Problem （SA）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-09-14 23:20:32" itemprop="dateCreated datePublished" datetime="2014-09-14T23:20:32+08:00">2014-09-14</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 13:43:28" itemprop="dateModified" datetime="2018-07-29T13:43:28+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/" itemprop="url" rel="index"><span itemprop="name">HDU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/后缀数组/" itemprop="url" rel="index"><span itemprop="name">后缀数组</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/后缀数组/算法/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="HDU5008"><a href="#HDU5008" class="headerlink" title="HDU5008"></a><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5008" target="_blank" rel="noopener">HDU5008</a></h3><p>  后缀数组。</p>
<h1 id="Boring-String-Problem"><a href="#Boring-String-Problem" class="headerlink" title="Boring String Problem"></a>Boring String Problem</h1><p><strong>Time Limit: 6000/3000 MS (Java/Others)    Memory Limit: 65536/65536 K (Java/Others) Total Submission(s): 255    Accepted Submission(s): 58</strong></p>
<p>Problem Description</p>
<p>In this problem, you are given a string s and q queries. For each query, you should answer that when all distinct substrings of string s were sorted lexicographically, which one is the k-th smallest. A substring si…j of the string s = a1a2 …an(1 ≤ i ≤ j ≤ n) is the string aiai+1 …aj. Two substrings sx…y and sz…w are cosidered to be distinct if sx…y ≠ Sz…w</p>
<p>Input</p>
<p>The input consists of multiple test cases.Please process till EOF. Each test case begins with a line containing a string s(|s| ≤ 105) with only lowercase letters. Next line contains a postive integer q(1 ≤ q ≤ 105), the number of questions. q queries are given in the next q lines. Every line contains an integer v. You should calculate the k by k = (l⊕r⊕v)+1(l, r is the output of previous question, at the beginning of each case l = r = 0, 0 &lt; k &lt; 263, “⊕” denotes exclusive or)</p>
<p>Output</p>
<p>For each test case, output consists of q lines, the i-th line contains two integers l, r which is the answer to the i-th query. (The answer l,r satisfies that sl…r is the k-th smallest and if there are several l,r available, ouput l,r which with the smallest l. If there is no l,r satisfied, output “0 0”. Note that s1…n is the whole string)</p>
<p>Sample Input</p>
<p>aaa 4 0 2 3 5</p>
<p>Sample Output</p>
<p>1 1 1 3 1 2 0 0</p>
<p>Source</p>
<p><a href="http://acm.hdu.edu.cn/search.php?field=problem&amp;key=2014+ACM%2FICPC+Asia+Regional+Xi%27an+Online&amp;source=1&amp;searchmode=source" target="_blank" rel="noopener">2014 ACM/ICPC Asia Regional Xi’an Online</a></p>
<pre><code>这题就是找出所有子串中的第k大。 而且要找出下标最小的。     这题相对而言简直弱爆了。   用后缀数组可以随便搞。   首先sa数组就已经按照字典序排好了。   对于每个sa 都会增加一定的子串。 增加的子串个数就是  n - sa\[i\] - height\[i\].   然后二分就可以找到第k大的位置。 然后为了找到下标最小的。 二分确定一个区间，在这个区间求sa数组的最小值。 搞个rmq进行最大最小值查询。   记住 后缀的前缀就是子串！  
</code></pre><p>#include &lt;stdio.h&gt;</p>
<p>#include <algorithm></algorithm></p>
<p>#include <iostream></iostream></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include &lt;string.h&gt;</p>
<p>#include <map></map></p>
<p>#include <vector></vector></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;<br>using namespace std;<br>/<em>
</em>`suffix array`<br><em>`倍增算法  O(n</em>logn)<code>*</code>待排序数组长度为n,放在0~n-1中，在最后面补一个0<code>*\</code>da(str ,sa,rank,height, n ,   );//注意是n;`<br><em><code>例如：</code>
</em>`n   = 8;`<br>* num[]   = { 1, 1, 2, 1, 1, 1, 1, 2, $ }; <code>注意num最后一位为0，其他大于0</code><br><em>`rank[]  = { 4, 6, 8, 1, 2, 3, 5, 7, 0 };rank[0~n-1]为有效值，rank[n]必定为0无效值`
</em>`sa[]    = { 8, 3, 4, 5, 0, 6, 1, 7, 2 };sa[1~n]为有效值，sa[0]必定为n是无效值`<br><em>`height[]= { 0, 0, 3, 2, 3, 1, 2, 0, 1 };height[2~n]为有效值`
</em><br><em>/<br>const int MAXN=100010;<br>int t1[MAXN],t2[MAXN],c[MAXN];//<code>求SA数组需要的中间变量，不需要赋值</code><br>//<code>待排序的字符串放在s数组中，从s\[0\]到s\[n-1\],长度为n,且最大值小于m,</code><br>//<code>除s\[n-1\]外的所有s\[i\]都大于0，r\[n-1\]=0</code><br>//<code>函数结束以后结果放在sa数组中</code><br>bool cmp(int </em>r,int a,int b,int l){<br>    return r[a] == r[b] &amp;&amp; r[a+l] == r[b+l];<br>}<br>void da(int str[],int sa[],int rank[],int height[],int n,int m){<br>    n++;<br>    int i, j, p, *x = t1, *y = t2;<br>    //<code>第一轮基数排序，如果s的最大值很大，可改为快速排序</code><br>    for(i = 0;i &lt; m;i++)c[i] = 0;<br>    for(i = 0;i &lt; n;i++)c[x[i] = str[i]]++;<br>    for(i = 1;i &lt; m;i++)c[i] += c[i-1];<br>    for(i = n-1;i &gt;= 0;i–)sa[–c[x[i]]] = i;<br>    for(j = 1;j &lt;= n; j &lt;&lt;= 1){<br>        p = 0;<br>        //<code>直接利用sa数组排序第二关键字</code><br>        for(i = n-j; i &lt; n; i++)y[p++] = i;//<code>后面的j个数第二关键字为空的最小</code><br>        for(i = 0; i &lt; n; i++)if(sa[i] &gt;= j)y[p++] = sa[i] - j;<br>        //<code>这样数组y保存的就是按照第二关键字排序的结果</code><br>        //<code>基数排序第一关键字</code><br>        for(i = 0; i &lt; m; i++)c[i] = 0;<br>        for(i = 0; i &lt; n; i++)c[x[y[i]]]++;<br>        for(i = 1; i &lt; m;i++)c[i] += c[i-1];<br>        for(i = n-1; i &gt;= 0;i–)sa[–c[x[y[i]]]] = y[i];<br>        //<code>根据sa和x数组计算新的x数组</code><br>        swap(x,y);<br>        p = 1; x[sa[0]] = 0;<br>        for(i = 1;i &lt; n;i++)<br>            x[sa[i]] = cmp(y,sa[i-1],sa[i],j)?p-1:p++;<br>        if(p &gt;= n)break;<br>        m = p;//<code>下次基数排序的最大值</code><br>    }<br>    int k = 0;<br>    n–;<br>    for(i = 0;i &lt;= n;i++)rank[sa[i]] = i;<br>    for(i = 0;i &lt; n;i++){<br>        if(k)k–;<br>        j = sa[rank[i]-1];<br>        while(str[i+k] == str[j+k])k++;<br>        height[rank[i]] = k;<br>    }<br>}<br>int rank[MAXN],height[MAXN];<br>int RMQ[MAXN];<br>int mm[MAXN];<br>int best[20][MAXN];<br>void initRMQ(int n){<br>    mm[0]=-1;<br>    for(int i=1;i&lt;=n;i++)<br>        mm[i]=((i&amp;(i-1))==0)?mm[i-1]+1:mm[i-1];<br>    for(int i=1;i&lt;=n;i++)best[0][i]=i;<br>    for(int i=1;i&lt;=mm[n];i++)<br>        for(int j=1;j+(1&lt;&lt;i)-1&lt;=n;j++){<br>            int a=best[i-1][j];<br>            int b=best[i-1][j+(1&lt;&lt;(i-1))];<br>            if(RMQ[a]&lt;RMQ[b])best[i][j]=a;<br>            else best[i][j]=b;<br>        }<br>}<br>int askRMQ(int a,int b){<br>    int t;<br>    t=mm[b-a+1];<br>    b-=(1&lt;&lt;t)-1;<br>    a=best[t][a];b=best[t][b];<br>    return RMQ[a]&lt;RMQ[b]?a:b;<br>}<br>int lcp(int a,int b){<br>    a=rank[a];b=rank[b];<br>    if(a&gt;b)swap(a,b);<br>    return height[askRMQ(a+1,b)];<br>}<br>char str[MAXN];<br>int r[MAXN];<br>int sa[MAXN];<br>int dp[20][MAXN];<br>void init(int n){<br>    for(int i = 1;i &lt;= n;i++){<br>        dp[0][i] = sa[i];<br>    }<br>    for(int j = 1;j &lt;= mm[n];j++)<br>        for(int i = 1;i + (1&lt;&lt;j) - 1 &lt;= n;i++)<br>            dp[j][i] = min(dp[j-1][i],dp[j-1][i+(1&lt;&lt;(j-1))]);<br>}<br>int rmq(int x,int y){<br>    int k = mm[y-x+1];<br>    return min(dp[k][x],dp[k][y-(1&lt;&lt;k)+1]);<br>}</p>
<p>long long b[MAXN];<br>int main()<br>{<br>    //freopen(“in.txt”,”r”,stdin);<br>    //freopen(“out.txt”,”w”,stdout);<br>    while(scanf(“%s”,str) == 1){<br>        int n = strlen(str);<br>        for(int i = 0;i &lt; n;i++)r[i] = str[i];<br>        r[n] = 0;<br>        da(r,sa,rank,height,n,128);<br>        for(int i = 1;i &lt;= n;i++)RMQ[i] = height[i];<br>        initRMQ(n);<br>        init(n);<br>        b[0] = 0;<br>        for(int i = 1;i &lt;= n;i++)<br>            b[i] = b[i-1] + n - sa[i] - height[i];<br>        int m;<br>        scanf(“%d”,&amp;m);<br>        long long k;<br>        int lastl = 0, lastr = 0;<br>        while(m–){<br>            scanf(“%I64d”,&amp;k);//提交记得修改========<br>            k = (k^lastl^lastr) + 1;<br>            if(k &gt; b[n]){<br>                printf(“0 0\n”);<br>                lastl = 0;<br>                lastr = 0;<br>                continue;<br>            }<br>            int id = lower_bound(b+1,b+n+1,k) - b;<br>            k -= b[id-1];<br>            int len = height[id] + k;<br>            int ll = id;<br>            int rr = id;<br>            int l = id, r = n;<br>            while(l &lt;= r){<br>                int mid = (l+r)/2;<br>                if(sa[id] == sa[mid] || lcp(sa[id],sa[mid]) &gt;= len){<br>                    rr = mid;<br>                    l = mid+1;<br>                }<br>                else r = mid-1;<br>            }<br>            int ansl = rmq(ll,rr);<br>            int ansr = ansl + len - 1;<br>            ansl++; ansr++;<br>            printf(“%d %d\n”,ansl,ansr);<br>            lastl = ansl;<br>            lastr = ansr;<br>        }<br>    }<br>    return 0;<br>}</p>

          
        
      
    </div>

    

    
    
    
	
	<div>
		
	</div>
 
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/09/14/hdu5007/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/09/14/hdu5007/" itemprop="url">
                  HDU 5007 Post Robot （水题）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-09-14 23:00:16" itemprop="dateCreated datePublished" datetime="2014-09-14T23:00:16+08:00">2014-09-14</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 13:43:28" itemprop="dateModified" datetime="2018-07-29T13:43:28+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/" itemprop="url" rel="index"><span itemprop="name">HDU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5007" target="_blank" rel="noopener">HDU5008</a> 发个水题。   水题。题意啥就不说了，直接贴个代码</p>
<p>/* <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>***</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><br>Author        :kuangbin<br>Created Time  :2014/9/14 22:47:59<br>File Name     :E:\2014ACM\2014网络赛\2014西安\HDU5007.cpp<br>************************************************ */</p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;string.h&gt;</p>
<p>#include <iostream></iostream></p>
<p>#include <algorithm></algorithm></p>
<p>#include <vector></vector></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include <map></map></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;</p>
<p>#include &lt;stdlib.h&gt;</p>
<p>#include &lt;time.h&gt;<br>using namespace std;<br>char str[10010];</p>
<p>char ss[][10] = {<br>    “Apple”,”iPhone”,”iPod”,”iPad”,”Sony”<br>};</p>
<p>int main()<br>{<br>    //freopen(“in.txt”,”r”,stdin);<br>    //freopen(“out.txt”,”w”,stdout);<br>    while(gets(str)){<br>        int len = strlen(str);<br>        for(int i = 0;i &lt; len;i++){<br>            bool f1 = false;<br>            for(int j = 0;j &lt; 4;j++){<br>                bool ff = true;<br>                int slen = strlen(ss[j]);<br>                if(i + slen &gt; len)continue;<br>                for(int k = 0;k &lt; slen;k++)<br>                    if(str[i+k] != ss[j][k])<br>                        ff = false;<br>                if(ff)f1 = true;<br>            }<br>            if(f1)printf(“MAI MAI MAI!\n”);<br>            bool f2 = true;<br>            int slen = strlen(ss[4]);<br>            if(i + slen &gt; len)continue;<br>            for(int j = 0;j &lt; slen;j++)<br>                if(str[i+j] != ss[4][j])<br>                    f2 = false;<br>            if(f2)printf(“SONY DAFA IS GOOD!\n”);<br>        }<br>    }<br>    return 0;<br>}</p>

          
        
      
    </div>

    

    
    
    
	
	<div>
		
	</div>
 
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/09/14/hdu-5002-tree-ef-bc-88lct-ef-bc-89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/09/14/hdu-5002-tree-ef-bc-88lct-ef-bc-89/" itemprop="url">
                  HDU 5002 Tree （LCT）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-09-14 10:14:22" itemprop="dateCreated datePublished" datetime="2014-09-14T10:14:22+08:00">2014-09-14</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 13:43:28" itemprop="dateModified" datetime="2018-07-29T13:43:28+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/" itemprop="url" rel="index"><span itemprop="name">HDU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/LCT/" itemprop="url" rel="index"><span itemprop="name">LCT</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/LCT/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/LCT/Online-Judge/数据结构/" itemprop="url" rel="index"><span itemprop="name">数据结构</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/LCT/Online-Judge/数据结构/算法/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="HDU5002"><a href="#HDU5002" class="headerlink" title="HDU5002"></a><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5002" target="_blank" rel="noopener">HDU5002</a></h2><p>LCT模板题。 都是基本的操作。 很水。 把push_up和push_down搞好可以了。</p>
<h1 id="Tree"><a href="#Tree" class="headerlink" title="Tree"></a>Tree</h1><p><strong>Time Limit: 16000/8000 MS (Java/Others)    Memory Limit: 65536/65536 K (Java/Others) Total Submission(s): 78    Accepted Submission(s): 34</strong></p>
<p>Problem Description</p>
<p>You are given a tree with N nodes which are numbered by integers 1..N. Each node is associated with an integer as the weight. Your task is to deal with M operations of 4 types: 1.Delete an edge (x, y) from the tree, and then add a new edge (a, b). We ensure that it still constitutes a tree after adding the new edge. 2.Given two nodes a and b in the tree, change the weights of all the nodes on the path connecting node a and b (including node a and b) to a particular value x. 3.Given two nodes a and b in the tree, increase the weights of all the nodes on the path connecting node a and b (including node a and b) by a particular value d. 4.Given two nodes a and b in the tree, compute the second largest weight on the path connecting node a and b (including node a and b), and the number of times this weight occurs on the path. Note that here we need the strict second largest weight. For instance, the strict second largest weight of {3, 5, 2, 5, 3} is 3.</p>
<p>Input</p>
<p>The first line contains an integer T (T&lt;=3), which means there are T test cases in the input. For each test case, the first line contains two integers N and M (N, M&lt;=10^5). The second line contains N integers, and the i-th integer is the weight of the i-th node in the tree (their absolute values are not larger than 10^4). In next N-1 lines, there are two integers a and b (1&lt;=a, b&lt;=N), which means there exists an edge connecting node a and b. The next M lines describe the operations you have to deal with. In each line the first integer is c (1&lt;=c&lt;=4), which indicates the type of operation. If c = 1, there are four integers x, y, a, b (1&lt;= x, y, a, b &lt;=N) after c. If c = 2, there are three integers a, b, x (1&lt;= a, b&lt;=N, |x|&lt;=10^4) after c. If c = 3, there are three integers a, b, d (1&lt;= a, b&lt;=N, |d|&lt;=10^4) after c. If c = 4 (it is a query operation), there are two integers a, b (1&lt;= a, b&lt;=N) after c. All these parameters have the same meaning as described in problem description.</p>
<p>Output</p>
<p>For each test case, first output “Case #x:”” (x means case ID) in a separate line. For each query operation, output two values: the second largest weight and the number of times it occurs. If the weights of nodes on that path are all the same, just output “ALL SAME” (without quotes).</p>
<p>Sample Input</p>
<p>2 3 2 1 1 2 1 2 1 3 4 1 2 4 2 3 7 7 5 3 2 1 7 3 6 1 2 1 3 3 4 3 5 4 6 4 7 4 2 6 3 4 5 -1 4 5 7 1 3 4 2 4 4 3 6 2 3 6 5 4 3 6</p>
<p>Sample Output</p>
<p>Case #1: ALL SAME 1 2 Case #2: 3 2 1 1 3 2 ALL SAME</p>
<pre><code>手敲了下LCT。 我的LCT还是挺快的，TAT
</code></pre><p>/* <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>***</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong><br>Author        :kuangbin<br>Created Time  :2014/9/14 9:10:24<br>File Name     :E:\2014ACM\2014网络赛\2014鞍山\HDU5002.cpp<br>************************************************ */</p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;string.h&gt;</p>
<p>#include <iostream></iostream></p>
<p>#include <algorithm></algorithm></p>
<p>#include <vector></vector></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include <map></map></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;</p>
<p>#include &lt;stdlib.h&gt;</p>
<p>#include &lt;time.h&gt;<br>using namespace std;<br>const int INF = 0x3f3f3f3f;<br>const int MAXN = 100010;<br>struct Node <em>null;<br>struct Node{<br>    Node \</em>fa,*ch[2];<br>    int val,size;<br>    int same,add;<br>    int rev;<br>    int mm,mmc;<br>    int sm,smc;<br>    inline void clear(int _val){<br>        fa = ch[0] = ch[1] = null;<br>        val = _val; size = 1;<br>        same = -INF;<br>        add = 0;<br>        mm = _val; mmc = 1;<br>        sm = -INF; smc = 0;<br>    }<br>    inline void add_val(int _val,int num){<br>        if(_val == -INF)return;<br>        if(_val &lt; sm)return;<br>        if(_val == sm)smc += num;<br>        else if(_val &lt; mm){<br>            sm = _val; smc = num;<br>        }<br>        else if(_val == mm){<br>            mmc += num;<br>        }<br>        else{<br>            sm = mm; smc = mmc;<br>            mm = _val; mmc = num;<br>        }<br>    }<br>    inline void push_up(){<br>        size = 1 + ch[0]-&gt;size + ch[1]-&gt;size;<br>        mm = sm = -INF;<br>        mmc = smc = 0;<br>        add_val(val,1);<br>        add_val(ch[0]-&gt;mm,ch[0]-&gt;mmc);<br>        add_val(ch[0]-&gt;sm,ch[0]-&gt;smc);<br>        add_val(ch[1]-&gt;mm,ch[1]-&gt;mmc);<br>        add_val(ch[1]-&gt;sm,ch[1]-&gt;smc);<br>    }<br>    inline void setc(Node <em>p,int d){<br>        ch[d] = p;<br>        p-&gt;fa = this;<br>    }<br>    inline bool d(){<br>        return fa-&gt;ch[1] == this;<br>    }<br>    inline bool isroot(){<br>        return fa == null || fa-&gt;ch[0] != this &amp;&amp; fa-&gt;ch[1] != this;<br>    }<br>    inline void flip(){<br>        if(this == null)return;<br>        swap(ch[0],ch[1]);<br>        rev ^= 1;<br>    }<br>    inline void update_add(int w){<br>        if(this == null)return;<br>        if(mm != -INF)mm += w;<br>        if(sm != -INF)sm += w;<br>        val += w;<br>        add += w;<br>    }<br>    inline void update_same(int w){<br>        if(this == null)return;<br>        mm = w; mmc = size;<br>        sm = -INF; smc = 0;<br>        same = w;<br>        val = w;<br>        add = 0;<br>    }<br>    inline void push_down(){<br>        if(same != -INF){<br>            ch[0]-&gt;update_same(same);<br>            ch[1]-&gt;update_same(same);<br>            same = -INF;<br>        }<br>        if(add){<br>            ch[0]-&gt;update_add(add);<br>            ch[1]-&gt;update_add(add);<br>            add = 0;<br>        }<br>        if(rev){<br>            ch[0]-&gt;flip();<br>            ch[1]-&gt;flip();<br>            rev = 0;<br>        }<br>    }<br>    inline void go(){<br>        if(!isroot())fa-&gt;go();<br>        push_down();<br>    }<br>    inline void rot(){<br>        Node \</em>f = fa, *ff = fa-&gt;fa;<br>        int c = d(), cc = fa-&gt;d();<br>        f-&gt;setc(ch[!c],c);<br>        this-&gt;setc(f,!c);<br>        if(ff-&gt;ch[cc] == f)ff-&gt;setc(this,cc);<br>        else this-&gt;fa = ff;<br>        f-&gt;push_up();<br>    }<br>    inline Node<em> splay(){<br>        go();<br>        while(!isroot()){<br>            if(!fa-&gt;isroot())<br>                d()==fa-&gt;d() ? fa-&gt;rot() : rot();<br>            rot();<br>        }<br>        push_up();<br>        return this;<br>    }<br>    inline Node</em> access(){<br>        for(Node *p = this,*q = null; p != null; q = p, p = p-&gt;fa){<br>            p-&gt;splay()-&gt;setc(q,1);<br>            p-&gt;push_up();<br>        }<br>        return splay();<br>    }<br>    inline Node<em> find_root(){<br>        Node </em>x;<br>        for(x = access(); x-&gt;push_down(), x-&gt;ch[0] != null; x = x-&gt;ch[0]);<br>        return x;<br>    }<br>    void make_root(){<br>        access()-&gt;flip();<br>    }<br>    void cut(){<br>        access();<br>        ch[0]-&gt;fa = null;<br>        ch[0] = null;<br>        push_up();<br>    }<br>    void cut(Node <em>x){<br>        if(this == x || find_root() != x-&gt;find_root())return;<br>        else{<br>            x-&gt;make_root();<br>            cut();<br>        }<br>    }<br>    void link(Node </em>x){<br>        if(find_root() == x-&gt;find_root())return;<br>        else {<br>            make_root(); fa = x;<br>        }<br>    }<br>};<br>void SAME(Node *x,Node *y,int w){<br>    x-&gt;access();<br>    for(x = null; y != null; x = y, y = y-&gt;fa){<br>        y-&gt;splay();<br>        if(y-&gt;fa == null){<br>            y-&gt;ch[1]-&gt;update_same(w);<br>            x-&gt;update_same(w);<br>            y-&gt;val = w;<br>            y-&gt;push_up();<br>            return;<br>        }<br>        y-&gt;setc(x,1);<br>        y-&gt;push_up();<br>    }<br>}<br>void ADD(Node *x,Node *y,int w){<br>    x-&gt;access();<br>    for(x = null; y != null; x = y, y = y-&gt;fa){<br>        y-&gt;splay();<br>        if(y-&gt;fa == null){<br>            y-&gt;ch[1]-&gt;update_add(w);<br>            x-&gt;update_add(w);<br>            y-&gt;val += w;<br>            y-&gt;push_up();<br>            return;<br>        }<br>        y-&gt;setc(x,1);<br>        y-&gt;push_up();<br>    }<br>}<br>int MM,MMC;<br>int SM,SMC;<br>void ADD_VAL(int val,int num){<br>    if(val == -INF)return;<br>    if(val &lt; SM)return;<br>    if(val == SM)SMC += num;<br>    else if(val &lt; MM){<br>        SM = val;<br>        SMC = num;<br>    }<br>    else if(val == MM){<br>        MMC += num;<br>    }<br>    else {<br>        SM = MM; SMC = MMC;<br>        MM = val; MMC = num;<br>    }<br>}<br>void ask(Node *x,Node *y){<br>    x-&gt;access();<br>    for(x=null; y != null; x = y, y = y-&gt;fa){<br>        y-&gt;splay();<br>        if(y-&gt;fa == null){<br>            MM = SM = -INF;<br>            MMC = SMC = 0;<br>            ADD_VAL(y-&gt;val,1);<br>            ADD_VAL(y-&gt;ch[1]-&gt;mm,y-&gt;ch[1]-&gt;mmc);<br>            ADD_VAL(y-&gt;ch[1]-&gt;sm,y-&gt;ch[1]-&gt;smc);<br>            ADD_VAL(x-&gt;sm,x-&gt;smc);<br>            ADD_VAL(x-&gt;mm,x-&gt;mmc);<br>            return;<br>        }<br>        y-&gt;setc(x,1);<br>        y-&gt;push_up();<br>    }<br>}<br>Node pool[MAXN],<em>tail;<br>Node </em>node[MAXN];<br>int main()<br>{<br>    //freopen(“in.txt”,”r”,stdin);<br>    //freopen(“out.txt”,”w”,stdout);<br>    int T;<br>    int iCase = 0;<br>    int n,m;<br>    scanf(“%d”,&amp;T);<br>    while(T–){<br>        iCase++;<br>        printf(“Case #%d:\n”,iCase);<br>        scanf(“%d%d”,&amp;n,&amp;m);<br>        tail = pool;<br>        null = tail++;<br>        null-&gt;fa = null-&gt;ch[0] = null-&gt;ch[1] = null;<br>        null-&gt;size = null-&gt;rev = 0;<br>        null-&gt;same = -INF; null-&gt;add = 0;<br>        null-&gt;mm = null-&gt;sm = -INF;<br>        null-&gt;mmc = null-&gt;smc = 0;<br>        for(int i = 1;i &lt;= n;i++){<br>            int v ;<br>            scanf(“%d”,&amp;v);<br>            node[i] = tail++;<br>            node[i]-&gt;clear(v);<br>        }<br>        int u,v;<br>        for(int i = 1;i &lt; n;i++){<br>            scanf(“%d%d”,&amp;u,&amp;v);<br>            node[u]-&gt;link(node[v]);<br>        }<br>        int op;<br>        int x,y,a,b;<br>        while(m–){<br>            scanf(“%d”,&amp;op);<br>            if(op == 1){<br>                scanf(“%d%d%d%d”,&amp;x,&amp;y,&amp;a,&amp;b);<br>                node[x]-&gt;cut(node[y]);<br>                node[a]-&gt;link(node[b]);<br>            }<br>            else if(op == 2){<br>                scanf(“%d%d%d”,&amp;a,&amp;b,&amp;x);<br>                SAME(node[a],node[b],x);<br>            }<br>            else if(op == 3){<br>                scanf(“%d%d%d”,&amp;a,&amp;b,&amp;x);<br>                ADD(node[a],node[b],x);<br>            }<br>            else{<br>                scanf(“%d%d”,&amp;a,&amp;b);<br>                ask(node[a],node[b]);<br>                if(SM == -INF)<br>                    printf(“ALL SAME\n”);<br>                else printf(“%d %d\n”,SM,SMC);<br>            }<br>        }<br>    }<br>    return 0;<br>}</p>

          
        
      
    </div>

    

    
    
    
	
	<div>
		
	</div>
 
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/09/12/hdu4347/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/09/12/hdu4347/" itemprop="url">
                  HDU 4347 The Closest M Points （KD树）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-09-12 21:48:03" itemprop="dateCreated datePublished" datetime="2014-09-12T21:48:03+08:00">2014-09-12</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 20:55:48" itemprop="dateModified" datetime="2018-07-29T20:55:48+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/算法/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/" itemprop="url" rel="index"><span itemprop="name">HDU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/数据结构/" itemprop="url" rel="index"><span itemprop="name">数据结构</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/KD树/" itemprop="url" rel="index"><span itemprop="name">KD树</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="HDU4347"><a href="#HDU4347" class="headerlink" title="HDU4347"></a><a href="http://acm.hdu.edu.cn/showproblem.php?pid=4347" target="_blank" rel="noopener">HDU4347</a></h2><p>  KD树模板题，求K近邻，暴力，加个优先队列。</p>
<h1 id="The-Closest-M-Points"><a href="#The-Closest-M-Points" class="headerlink" title="The Closest M Points"></a>The Closest M Points</h1><p><strong>Time Limit: 16000/8000 MS (Java/Others)    Memory Limit: 98304/98304 K (Java/Others) Total Submission(s): 1963    Accepted Submission(s): 786</strong></p>
<p>Problem Description</p>
<p>The course of Software Design and Development Practice is objectionable. ZLC is facing a serious problem .There are many points in K-dimensional space .Given a point. ZLC need to find out the closest m points. Euclidean distance is used as the distance metric between two points. The Euclidean distance between points p and q is the length of the line segment connecting them.In Cartesian coordinates, if p = (p1, p2,…, pn) and q = (q1, q2,…, qn) are two points in Euclidean n-space, then the distance from p to q, or from q to p is given by:</p>
<p><img src="http://acm.hdu.edu.cn/data/images/C402-1009-1.jpg" alt=""></p>
<p>Can you help him solve this problem?</p>
<p>Input</p>
<p>In the first line of the text file .there are two non-negative integers n and K. They denote respectively: the number of points, 1 &lt;= n &lt;= 50000, and the number of Dimensions,1 &lt;= K &lt;= 5. In each of the following n lines there is written k integers, representing the coordinates of a point. This followed by a line with one positive integer t, representing the number of queries,1 &lt;= t &lt;=10000.each query contains two lines. The k integers in the first line represent the given point. In the second line, there is one integer m, the number of closest points you should find,1 &lt;= m &lt;=10. The absolute value of all the coordinates will not be more than 10000. There are multiple test cases. Process to end of file.</p>
<p>Output</p>
<p>For each query, output m+1 lines: The first line saying :”the closest m points are:” where m is the number of the points. The following m lines representing m points ,in accordance with the order from near to far It is guaranteed that the answer can only be formed in one ways. The distances from the given point to all the nearest m+1 points are different. That means input like this: 2 2 1 1 3 3 1 2 2 1 will not exist.</p>
<p>Sample Input</p>
<p>3 2 1 1 1 3 3 4 2 2 3 2 2 3 1</p>
<p>Sample Output</p>
<p>the closest 2 points are: 1 3 3 4 the closest 1 points are: 1 3</p>
<p>Author</p>
<p>HIT</p>
<p>Source</p>
<p><a href="http://acm.hdu.edu.cn/search.php?field=problem&amp;key=2012%20Multi-University%20Training%20Contest%205&amp;source=1&amp;searchmode=source" target="_blank" rel="noopener">2012 Multi-University Training Contest 5</a></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ***************</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Author        :kuangbin</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Created Time  :2014/9/6 18:26:05</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">File Name     :E:\2014ACM\专题学习\KD树\HDU4347.cpp</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> ************************************************ */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">50010</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> DIM = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">sqr</span><span class="params">(<span class="keyword">double</span> x)</span></span>&#123;<span class="keyword">return</span> x*x;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> KDTree&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> K;<span class="comment">//维数</span></span><br><span class="line"></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">Point</span>&#123;</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> x[DIM];</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">double</span> <span class="title">distance</span><span class="params">(<span class="keyword">const</span> Point &amp;b)</span><span class="keyword">const</span></span>&#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">double</span> ret = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; K;i++)</span><br><span class="line"></span><br><span class="line">				ret += sqr(x[i]-b.x[i]);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">return</span> ret;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">void</span> <span class="title">input</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; K;i++)<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x[i]);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">void</span> <span class="title">output</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; K;i++)</span><br><span class="line"></span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">"%d%c"</span>,x[i],i &lt; K<span class="number">-1</span>?<span class="string">' '</span>:<span class="string">'\n'</span>);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">qnode</span>&#123;</span></span><br><span class="line"></span><br><span class="line">		Point p;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">double</span> dis;</span><br><span class="line"></span><br><span class="line">		qnode()&#123;&#125;</span><br><span class="line"></span><br><span class="line">		qnode(Point _p,<span class="keyword">double</span> _dis)&#123;</span><br><span class="line"></span><br><span class="line">			p = _p; dis = _dis;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> qnode &amp;b)<span class="keyword">const</span>&#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">return</span> dis &lt; b.dis;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	priority_queue&lt;qnode&gt;q;</span><br><span class="line"></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">cmpx</span>&#123;</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> div;</span><br><span class="line"></span><br><span class="line">		cmpx(<span class="keyword">const</span> <span class="keyword">int</span> &amp;_div)&#123;div = _div;&#125;</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="keyword">const</span> Point &amp;a,<span class="keyword">const</span> Point &amp;b)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; K;i++)</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span>(a.x[(div+i)%K] != b.x[(div+i)%K])</span><br><span class="line"></span><br><span class="line">					<span class="keyword">return</span> a.x[(div+i)%K] &lt; b.x[(div+i)%K];</span><br><span class="line"></span><br><span class="line">			<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">const</span> Point &amp;a,<span class="keyword">const</span> Point &amp;b,<span class="keyword">int</span> div)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		cmpx cp = cmpx(div);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> cp(a,b);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line"></span><br><span class="line">		Point e;</span><br><span class="line"></span><br><span class="line">		Node *lc,*rc;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> div;</span><br><span class="line"></span><br><span class="line">	&#125;pool[MAXN],*tail,*root;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		tail = pool;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function">Node* <span class="title">build</span><span class="params">(Point *a,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> div)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(l &gt;= r)<span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">		Node *p = tail++;</span><br><span class="line"></span><br><span class="line">		p-&gt;div = div;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> mid = (l+r)/<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">		nth_element(a+l,a+mid,a+r,cmpx(div));</span><br><span class="line"></span><br><span class="line">		p-&gt;e = a[mid];</span><br><span class="line"></span><br><span class="line">		p-&gt;lc = build(a,l,mid,(div+<span class="number">1</span>)%K);</span><br><span class="line"></span><br><span class="line">		p-&gt;rc = build(a,mid+<span class="number">1</span>,r,(div+<span class="number">1</span>)%K);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> p;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">search</span><span class="params">(Point p,Node *x,<span class="keyword">int</span> div,<span class="keyword">int</span> m)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(!x)<span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(cmp(p,x-&gt;e,div))&#123;</span><br><span class="line"></span><br><span class="line">			search(p,x-&gt;lc,(div+<span class="number">1</span>)%K,m);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(q.size() &lt; m)&#123;</span><br><span class="line"></span><br><span class="line">				q.push(qnode(x-&gt;e,p.distance(x-&gt;e)));</span><br><span class="line"></span><br><span class="line">				search(p,x-&gt;rc,(div+<span class="number">1</span>)%K,m);</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span>(p.distance(x-&gt;e) &lt; q.top().dis)&#123;</span><br><span class="line"></span><br><span class="line">					q.pop(); </span><br><span class="line"></span><br><span class="line">					q.push(qnode(x-&gt;e,p.distance(x-&gt;e)));</span><br><span class="line"></span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span>(sqr(x-&gt;e.x[div]-p.x[div]) &lt; q.top().dis)</span><br><span class="line"></span><br><span class="line">					search(p,x-&gt;rc,(div+<span class="number">1</span>)%K,m);</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">			search(p,x-&gt;rc,(div+<span class="number">1</span>)%K,m);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(q.size() &lt; m)&#123;</span><br><span class="line"></span><br><span class="line">				q.push(qnode(x-&gt;e,p.distance(x-&gt;e)));</span><br><span class="line"></span><br><span class="line">				search(p,x-&gt;lc,(div+<span class="number">1</span>)%K,m);</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span>(p.distance(x-&gt;e) &lt; q.top().dis)&#123;</span><br><span class="line"></span><br><span class="line">					q.pop();</span><br><span class="line"></span><br><span class="line">					q.push(qnode(x-&gt;e,p.distance(x-&gt;e)));</span><br><span class="line"></span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span>(sqr(x-&gt;e.x[div]-p.x[div]) &lt; q.top().dis)</span><br><span class="line"></span><br><span class="line">					search(p,x-&gt;lc,(div+<span class="number">1</span>)%K,m);</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">search</span><span class="params">(Point p,<span class="keyword">int</span> m)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span>(!q.empty())q.pop();</span><br><span class="line"></span><br><span class="line">		search(p,root,<span class="number">0</span>,m);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">KDTree::Point p[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> n,k;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;k) == <span class="number">2</span>)&#123;</span><br><span class="line"></span><br><span class="line">		KDTree::K = k;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)p[i].input();</span><br><span class="line"></span><br><span class="line">		KDTree::init();</span><br><span class="line"></span><br><span class="line">		KDTree::root = KDTree::build(p,<span class="number">0</span>,n,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> Q;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;Q);</span><br><span class="line"></span><br><span class="line">		KDTree::Point o;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span>(Q--)&#123;</span><br><span class="line"></span><br><span class="line">			o.input();</span><br><span class="line"></span><br><span class="line">			<span class="keyword">int</span> m;</span><br><span class="line"></span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;m);</span><br><span class="line"></span><br><span class="line">			KDTree::search(o,m);</span><br><span class="line"></span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"the closest %d points are:\n"</span>,m);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">while</span>(!KDTree::q.empty())&#123;</span><br><span class="line"></span><br><span class="line">				p[cnt++] = KDTree::q.top().p;</span><br><span class="line"></span><br><span class="line">				KDTree::q.pop();</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; m;i++)p[m<span class="number">-1</span>-i].output();</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    
	
	<div>
		
	</div>
 
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/09/08/hdu4796/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/09/08/hdu4796/" itemprop="url">
                  HDU 4796 Winter's Coming （插头DP）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-09-08 22:01:17" itemprop="dateCreated datePublished" datetime="2014-09-08T22:01:17+08:00">2014-09-08</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 21:00:21" itemprop="dateModified" datetime="2018-07-29T21:00:21+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/" itemprop="url" rel="index"><span itemprop="name">HDU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/插头DP/" itemprop="url" rel="index"><span itemprop="name">插头DP</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>AC 了。 一个地方写错，导致产生了多余的环！！！！！ 13年长沙的插头DP题。 //写了一下插头DP， WA到死，然后这题有天坑！！！！ //留个坑吧！ 记录下自己写的插头DP代码！ 当年写得很熟悉的插头DP现在都快忘记了。 已经AC    </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ***************</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Author        :kuangbin</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Created Time  :2014/9/8 19:22:58</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">File Name     :tmp.cpp</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">************************************************ */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXD = <span class="number">15</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> STATE = <span class="number">1000010</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> HASH = <span class="number">10007</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N,M;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> maze[<span class="number">24</span>][MAXD];<span class="comment">//-1禁止，-2左边，-3右边</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> code[MAXD];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ch[MAXD];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">HASHMAP</span>&#123;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> head[HASH],next[STATE],size;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">long</span> <span class="keyword">long</span> state[STATE];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> f[STATE];</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		size = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="keyword">sizeof</span>(head));</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">push</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> st,<span class="keyword">int</span> ans)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> h = st%HASH;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = head[h];i != <span class="number">-1</span>;i = next[i])</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(state[i] == st)&#123;</span><br><span class="line"></span><br><span class="line">				f[i] = min(f[i],ans);</span><br><span class="line"></span><br><span class="line">				<span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		state[size] = st;</span><br><span class="line"></span><br><span class="line">		f[size] = ans;</span><br><span class="line"></span><br><span class="line">		next[size] = head[h];</span><br><span class="line"></span><br><span class="line">		head[h] = size++;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;hm[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">decode</span><span class="params">(<span class="keyword">int</span> *code,<span class="keyword">int</span> m,<span class="keyword">long</span> <span class="keyword">long</span> st)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = m;i &gt;= <span class="number">0</span>;i--)&#123;</span><br><span class="line"></span><br><span class="line">		code[i] = st&amp;<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line">		st &gt;&gt;= <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">encode</span><span class="params">(<span class="keyword">int</span> *code,<span class="keyword">int</span> m)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> cnt = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">memset</span>(ch,<span class="number">-1</span>,<span class="keyword">sizeof</span>(ch));</span><br><span class="line"></span><br><span class="line">	ch[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">long</span> <span class="keyword">long</span> st = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= m;i++)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(ch[code[i]] == <span class="number">-1</span>)ch[code[i]] = cnt++;</span><br><span class="line"></span><br><span class="line">		code[i] = ch[code[i]];</span><br><span class="line"></span><br><span class="line">		st &lt;&lt;= <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">		st |= code[i];</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> st;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dpblank</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j,<span class="keyword">int</span> cur)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> k,left,up;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(k = <span class="number">0</span>;k &lt; hm[cur].size;k++)&#123;</span><br><span class="line"></span><br><span class="line">		decode(code,M,hm[cur].state[k]);</span><br><span class="line"></span><br><span class="line">		left = code[j<span class="number">-1</span>];</span><br><span class="line"></span><br><span class="line">		up = code[j];</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(left &amp;&amp; up)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(left == up)&#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">continue</span>;<span class="comment">//这种情况不能合并，否则会形成多余的环</span></span><br><span class="line"></span><br><span class="line">				code[j<span class="number">-1</span>] = code[j] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">				hm[cur^<span class="number">1</span>].push(encode(code,j==M?M<span class="number">-1</span>:M),hm[cur].f[k]+maze[i][j]);</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">				code[j<span class="number">-1</span>] = code[j] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> t = <span class="number">0</span>;t &lt;= M;t++)</span><br><span class="line"></span><br><span class="line">					<span class="keyword">if</span>(code[t] == up)</span><br><span class="line"></span><br><span class="line">						code[t] = left;</span><br><span class="line"></span><br><span class="line">				hm[cur^<span class="number">1</span>].push(encode(code,j==M?M<span class="number">-1</span>:M),hm[cur].f[k]+maze[i][j]);</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(left || up)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">int</span> t ;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(left) t = left;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> t = up;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(i == N)&#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">int</span> cc = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> p = <span class="number">0</span>;p &lt; j<span class="number">-1</span>;p++)</span><br><span class="line"></span><br><span class="line">					<span class="keyword">if</span>(code[p])</span><br><span class="line"></span><br><span class="line">						cc++;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span>(cc == <span class="number">0</span>)&#123;</span><br><span class="line"></span><br><span class="line">					code[j] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">					code[j<span class="number">-1</span>] = t;</span><br><span class="line"></span><br><span class="line">					hm[cur^<span class="number">1</span>].push(encode(code,j==M?M<span class="number">-1</span>:M),hm[cur].f[k]+maze[i][j]);</span><br><span class="line"></span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(maze[i+<span class="number">1</span>][j] &gt;= <span class="number">0</span>)&#123;</span><br><span class="line"></span><br><span class="line">				code[j] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">				code[j<span class="number">-1</span>] = t;</span><br><span class="line"></span><br><span class="line">				hm[cur^<span class="number">1</span>].push(encode(code,j==M?M<span class="number">-1</span>:M),hm[cur].f[k]+maze[i][j]);</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(maze[i][j+<span class="number">1</span>] &gt;= <span class="number">0</span>)&#123;</span><br><span class="line"></span><br><span class="line">				code[j<span class="number">-1</span>] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">				code[j] = t;</span><br><span class="line"></span><br><span class="line">				hm[cur^<span class="number">1</span>].push(encode(code,j==M?M<span class="number">-1</span>:M),hm[cur].f[k]+maze[i][j]);</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">			code[j<span class="number">-1</span>] = code[j] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">			hm[cur^<span class="number">1</span>].push(encode(code,j==M?M<span class="number">-1</span>:M),hm[cur].f[k]);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(i == N)&#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">int</span> cc = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> p = <span class="number">0</span>;p &lt; j<span class="number">-1</span>;p++)</span><br><span class="line"></span><br><span class="line">					<span class="keyword">if</span>(code[p])</span><br><span class="line"></span><br><span class="line">						cc++;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span>(cc == <span class="number">0</span> &amp;&amp; maze[i][j+<span class="number">1</span>] &gt;= <span class="number">0</span>)&#123;</span><br><span class="line"></span><br><span class="line">					code[j] = code[j<span class="number">-1</span>] = <span class="number">13</span>;</span><br><span class="line"></span><br><span class="line">					hm[cur^<span class="number">1</span>].push(encode(code,j==M?M<span class="number">-1</span>:M),hm[cur].f[k]+maze[i][j]);</span><br><span class="line"></span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(maze[i+<span class="number">1</span>][j] &gt;= <span class="number">0</span> &amp;&amp; maze[i][j+<span class="number">1</span>] &gt;= <span class="number">0</span>)&#123;</span><br><span class="line"></span><br><span class="line">				code[j] = code[j<span class="number">-1</span>] = <span class="number">13</span>;</span><br><span class="line"></span><br><span class="line">				hm[cur^<span class="number">1</span>].push(encode(code,j==M?M<span class="number">-1</span>:M),hm[cur].f[k]+maze[i][j]);</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dpblock</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j,<span class="keyword">int</span> cur)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>;k &lt; hm[cur].size;k++)&#123;</span><br><span class="line"></span><br><span class="line">		decode(code,M,hm[cur].state[k]);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(code[j] || code[j<span class="number">-1</span>])<span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> cc = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> p = <span class="number">0</span>;p &lt; j<span class="number">-1</span>;p++)</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(code[p])</span><br><span class="line"></span><br><span class="line">				cc++;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(maze[i][j] == <span class="number">-2</span> &amp;&amp; cc%<span class="number">2</span> == <span class="number">0</span>)&#123;</span><br><span class="line"></span><br><span class="line">			code[j<span class="number">-1</span>] = code[j] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">			hm[cur^<span class="number">1</span>].push(encode(code,j==M?M<span class="number">-1</span>:M),hm[cur].f[k]);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(maze[i][j] == <span class="number">-3</span> &amp;&amp; cc%<span class="number">2</span> == <span class="number">1</span>)&#123;</span><br><span class="line"></span><br><span class="line">			code[j<span class="number">-1</span>] = code[j] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">			hm[cur^<span class="number">1</span>].push(encode(code,j==M?M<span class="number">-1</span>:M),hm[cur].f[k]);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(maze[i][j] == <span class="number">-1</span>)&#123;</span><br><span class="line"></span><br><span class="line">			code[j<span class="number">-1</span>] = code[j] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">			hm[cur^<span class="number">1</span>].push(encode(code,j==M?M<span class="number">-1</span>:M),hm[cur].f[k]);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> str[<span class="number">20</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">memset</span>(maze,<span class="number">-1</span>,<span class="keyword">sizeof</span>(maze));</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= N;i++)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>,str);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= M;j++)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(str[j<span class="number">-1</span>] == <span class="string">'#'</span>)maze[i][j] = <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(str[j<span class="number">-1</span>] == <span class="string">'W'</span>)maze[i][j] = <span class="number">-2</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(str[j<span class="number">-1</span>] == <span class="string">'L'</span>)maze[i][j] = <span class="number">-3</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> maze[i][j] = str[j<span class="number">-1</span>] - <span class="string">'0'</span>;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> i,j,cur = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	hm[cur].init();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">1</span>;i &lt;= M;i++)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(maze[<span class="number">1</span>][i] &lt; <span class="number">0</span>)<span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(j = <span class="number">0</span>;j &lt;= M;j++)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(j == i)code[j] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> code[j] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		hm[cur].push(encode(code,M),<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">1</span>;i &lt;= N;i++)</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(j = <span class="number">1</span>;j &lt;= M;j++)&#123;</span><br><span class="line"></span><br><span class="line">			hm[cur^<span class="number">1</span>].init();</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(maze[i][j] &gt;= <span class="number">0</span>)dpblank(i,j,cur);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">else</span> dpblock(i,j,cur);</span><br><span class="line"></span><br><span class="line">			cur ^= <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> ans = INF;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>;i &lt; hm[cur].size;i++)&#123;</span><br><span class="line"></span><br><span class="line">		decode(code,M,hm[cur].state[i]);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> cc = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(j = <span class="number">1</span>;j &lt;= M;j++)</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(code[j])</span><br><span class="line"></span><br><span class="line">				cc++;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(cc == <span class="number">1</span>)ans = min(ans,hm[cur].f[i]);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(ans == INF)ans = <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("in.txt","r",stdin);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//freopen("out.txt","w",stdout);</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;N,&amp;M) == <span class="number">2</span>)&#123;</span><br><span class="line"></span><br><span class="line">		init();</span><br><span class="line"></span><br><span class="line">		solve();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    
	
	<div>
		
	</div>
 
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/09/08/zoj3813/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/09/08/zoj3813/" itemprop="url">
                  ZOJ 3813 Alternating Sum （胡搞）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-09-08 08:19:04" itemprop="dateCreated datePublished" datetime="2014-09-08T08:19:04+08:00">2014-09-08</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 13:43:28" itemprop="dateModified" datetime="2018-07-29T13:43:28+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Online-Judge/ZJU/" itemprop="url" rel="index"><span itemprop="name">ZJU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Online-Judge/ZJU/数据结构/" itemprop="url" rel="index"><span itemprop="name">数据结构</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Online-Judge/ZJU/数据结构/树状数组/" itemprop="url" rel="index"><span itemprop="name">树状数组</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Online-Judge/ZJU/数据结构/树状数组/算法/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://acm.zju.edu.cn/onlinejudge/showProblem.do?problemId=5345" target="_blank" rel="noopener">ZOJ3813</a>   推一下公式，然后分类讨论一下。</p>
<p>Alternating Sum</p>
<hr>
<p>Time Limit: 2 Seconds      Memory Limit: 65536 KB</p>
<hr>
<p>There is a digit string S with infinite length. In addition, S is periodic and it can be formed by concatenating infinite repetitions of a base string P. For example, if P = 3423537, then S = 3423537342353734235373423537…</p>
<p>Let’s define the alternating sum on substrings of S. Assume Sl..r is a substring of S from index l to index r (all indexes are 1-based), then the alternating sum of Sl..r is:</p>
<p>G(l, r) = Sl - Sl+1 + Sl+2 - … + (-1)r-lSr</p>
<p>For example, S2..10 = 423537342, then G(2, 10) = 4 - 2 + 3 - 5 + 3 - 7 + 3 - 4 + 2 = -3.</p>
<p>Now, you are given the base string P and you have to do many operations. There are only two kinds of operations:</p>
<ul>
<li>1 x d: set Px to d, d is a single digit.</li>
<li>2 l r: find the sum of G(i, j) that l &lt;= i &lt;= j &lt;= r.</li>
</ul>
<p>For each second operation, you should output the sum modulo 109 + 7.</p>
<h4 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h4><p>There are multiple test cases. The first line of input contains an integer T indicating the number of test cases. For each test case:</p>
<p>The first line contains a digit string P (1 &lt;= length(P) &lt;= 100000).</p>
<p>The second line contains an integer Q (1 &lt;= Q &lt;= 100000) indicating the number of operations. Each of the following Q lines is an operation in such format:</p>
<ul>
<li>1 x d (1 &lt;= x &lt;= length(P), 0 &lt;= d &lt;= 9)</li>
<li>2 l r (1 &lt;= l &lt;= r &lt;= 1018)</li>
</ul>
<h4 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h4><p>For each “2 l r” operation, output an integer, indicating the sum modulo 109 + 7.</p>
<h4 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h4><p>2<br>324242<br>4<br>2 1 1<br>2 1 4<br>1 3 7<br>2 3 4<br>324242<br>6<br>2 1 1<br>1 3 7<br>2 2 4<br>1 3 4<br>2 7 10<br>2 1 30</p>
<h4 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h4><p>3<br>20<br>14<br>3<br>8<br>20<br>870</p>
<pre><code>如果是对于1操作，直接修改就是了，注意把要维护的东西更新一下。   对于2操作。 比如要查询 \[l,r\] 很容易发现，答案其实是  \\(a\_l*(r-l+1)+a\_(l+2)*(r-l+1-2)+a_(l+4)*(r-l+1-4)+........\\) 其实也就是说是从l出发的奇数项是有值的。 而且前面的系数刚好是等差数列。 那么我们需要维护的是， 奇数和偶数项的 \\(a\_i*(n+1-i)\\)的前缀和。 奇数和偶数项的\\(a\_i\\)的前缀和。 明显树状数组已经足矣。   为何这样维护是可以的呢？   因为刚才说的要求的 \[l,r\]区间的，是可以分段的。 首先是首尾的两段，还有中间的很多段。（当然有可能只有一段或者两段） 所以首先找到 l,r所属于的块，也就是  (i+(n-1))/n 对于需要求的第一段，形式明显是要求  \\(a\_i*(r-l+1)+a\_(i+2)*(r-l+1-2)+......\\) 这里加的是 \[i,n\]这一段的了。 这个其实是我们维护了的后缀和。 因为我们可以很快求出 \\a\_i*(n+1-i)+a\_(i+2)*(n+1-i-2)+....\\) 要求的只需要加了  \\(a\_i+a\_(i+2)+....\\)的倍数就可以了。   尾部和 r 同一段的求的方法类似。 至于中间部分。 只需要对 n分奇数和偶数去讨论。 如果n是偶数。 那么一段一段是周期的。 可以用等差数列求和。 如果n是奇数，然么两段两段是周期的，一样可以用等差数列去求和。         最近写代码能力急剧下降！ 尤其是在比赛后期，思路完全乱掉了，经常犯SB错误，sad
</code></pre><p>#include &lt;stdio.h&gt;</p>
<p>#include <algorithm></algorithm></p>
<p>#include <iostream></iostream></p>
<p>#include <queue></queue></p>
<p>#include <set></set></p>
<p>#include &lt;string.h&gt;</p>
<p>#include <map></map></p>
<p>#include <vector></vector></p>
<p>#include <string></string></p>
<p>#include &lt;math.h&gt;<br>using namespace std;<br>const int MAXN = 100010;<br>const int MOD = 1e9+7;<br>void Add(long long &amp;a,long long b){<br>    a += b;<br>    if(a &gt;= MOD)a -= MOD;<br>}<br>int lowbit(int x){<br>    return x&amp;(-x);<br>}<br>struct BIT{<br>    long long c[MAXN];<br>    int n;<br>    void init(int _n){<br>        n = _n;<br>        memset(c,0,sizeof(c));<br>    }<br>    long long sum(int i){<br>        long long s = 0;<br>        while(i &gt; 0){<br>            Add(s,c[i]);<br>            i -= lowbit(i);<br>        }<br>        return s;<br>    }<br>    void add(int i,long long val){<br>        while(i &lt;= n){<br>            Add(c[i],val);<br>            i += lowbit(i);<br>        }<br>    }<br>}bt0,bt1,bt2,bt3;<br>int a[MAXN];<br>char str[MAXN];<br>int n;<br>long long getid(long long x){<br>    return (x + n-1)/n;<br>}<br>int getpos(long long x){<br>    return (x-1)%n + 1;<br>}<br>long long SUM(int pos1,int pos2,long long loc){<br>    long long ans = 0;<br>    long long sum;<br>    if(pos1%2 != pos2%2)pos2–;<br>    if(pos1%2 == 1){<br>        ans = bt0.sum(pos2) - bt0.sum(pos1-1);<br>        sum = bt2.sum(pos2) - bt2.sum(pos1-1);<br>    }<br>    else {<br>        ans = bt1.sum(pos2) - bt1.sum(pos1-1);<br>        sum = bt3.sum(pos2) - bt3.sum(pos1-1);<br>    }<br>    ans = ans + (loc - (n+1-pos1))%MOD<em>sum%MOD;<br>    ans = (ans%MOD+MOD)%MOD;<br>    return ans;<br>}<br>long long inv(long long a,long long m){<br>    if(a == 1)return 1;<br>    return inv(m%a,m)</em>(m-m/a)%m;<br>}<br>int main()<br>{<br>    //freopen(“in.txt”,”r”,stdin);<br>    //freopen(“out1.txt”,”w”,stdout);<br>    int T;<br>    scanf(“%d”,&amp;T);<br>    while(T–){<br>        scanf(“%s”,str);<br>        n = strlen(str);<br>        for(int i = 0;i &lt; n;i++)<br>            a[i+1] = str[i] - ‘0’;<br>        bt0.init(n);<br>        bt1.init(n);<br>        bt2.init(n);<br>        bt3.init(n);<br>        for(int i = 1;i &lt;= n;i++){<br>            if(i%2 == 1){<br>                bt0.add(i,a[i]<em>(n+1-i));<br>                bt2.add(i,a[i]);<br>            }<br>            else{<br>                bt1.add(i,a[i]</em>(n+1-i));<br>                bt3.add(i,a[i]);<br>            }<br>        }<br>        int op;<br>        int x,d;<br>        long long l,r;<br>        int m;<br>        scanf(“%d”,&amp;m);<br>        while(m–){<br>            scanf(“%d”,&amp;op);<br>            if(op == 1){<br>                scanf(“%d%d”,&amp;x,&amp;d);<br>                if(x%2 == 1){<br>                    bt0.add(x,-a[x]<em>(n+1-x));<br>                    bt0.add(x,d</em>(n+1-x));<br>                    bt2.add(x,-a[x]);<br>                    bt2.add(x,d);<br>                }<br>                else {<br>                    bt1.add(x,-a[x]<em>(n+1-x));<br>                    bt1.add(x,d</em>(n+1-x));<br>                    bt3.add(x,-a[x]);<br>                    bt3.add(x,d);<br>                }<br>                a[x] = d;<br>            }<br>            else {<br>                scanf(“%lld%lld”,&amp;l,&amp;r);<br>                long long id1 = getid(l);<br>                long long id2 = getid(r);<br>                int pos1 = getpos(l);<br>                int pos2 = getpos(r);<br>                if(id1 == id2){<br>                    long long ans = SUM(pos1,pos2,r-l+1);<br>                    printf(“%lld\n”,ans);<br>                }<br>                else {<br>                    long long ans = 0;<br>                    int pos11 = pos1;<br>                    int pos12 = n;<br>                    if(pos11%2 != pos12%2)pos12–;<br>                    ans += SUM(pos11,pos12,r-l+1);<br>                    ans = (ans%MOD+MOD)%MOD;<br>                    int pos21 = 1;<br>                    int pos22 = pos2;<br>                    if( ((id2-1)<em>n + 1 - l)%2 != 0 )pos21++;<br>                    if(pos22%2 != pos21%2)pos22–;<br>                    if(pos21 &lt;= pos22){<br>                        ans += SUM(pos21,pos22,r - ((id2-1)</em>n + pos21) + 1);<br>                        ans = (ans%MOD+MOD)%MOD;<br>                    }<br>                    if(id1 &lt; id2-1){<br>                        if(n % 2 == 0){<br>                            int pos11 = 1;<br>                            int pos12 = n;<br>                            if( (id1<em>n+1-l)%2 != 0 )pos11++;<br>                            if(pos12 % 2 != pos11%2)pos12–;<br>                            if(pos11 &lt;= pos12){<br>                                long long tmp1 = SUM(pos11,pos12,0);<br>                                long long sou = (r - (id1</em>n + pos11) + 1);<br>                                sou = (sou%MOD+MOD)%MOD;<br>                                long long nn = id2 - id1 - 1;<br>                                nn %= MOD;<br>                                long long ttt = nn*sou%MOD + nn*(nn-1)%MOD*inv(2,MOD)%MOD*(-n)%MOD;<br>                                ttt = (ttt%MOD+MOD)%MOD;<br>                                long long s1;<br>                                if(pos11%2 == 1)s1 = bt2.sum(pos12) - bt2.sum(pos11-1);<br>                                else s1 = bt3.sum(pos12) - bt3.sum(pos11-1);<br>                                long long tttt = tmp1*nn%MOD + s1*ttt%MOD;<br>                                tttt = (tttt%MOD+MOD)%MOD;<br>                                ans = (ans + tttt)%MOD;<br>                            }<br>                        }<br>                        else {<br>                            long long idcnt = id2 - id1 - 1;<br>                            if((idcnt/2) &gt; 0){<br>                                int pos11 = 1;<br>                                int pos12 = n;<br>                                if((id1<em>n+1-l)%2 != 0)pos11++;<br>                                if(pos12%2 != pos11%2)pos12–;<br>                                int pos21 = 1;<br>                                int pos22 = n;<br>                                if(((id1+1)</em>n+1-l)%2 != 0)pos21++;<br>                                if(pos22%2 != pos21%2)pos22–;<br>                                long long tmp1 = SUM(pos11,pos12,0);<br>                                long long tmp2 = SUM(pos21,pos22,-( pos21 + n - pos11 ));</p>
<pre><code>                            long long tmp = tmp1 + tmp2;
                            tmp = (tmp%MOD+MOD)%MOD;
                            long long sou = (r - (id1*n + pos11) + 1);
                            sou = (sou%MOD+MOD)%MOD;
                            long long nn = idcnt/2;
                            nn %= MOD;
                            long long ttt = nn\*sou%MOD + nn\*(nn-1)%MOD\*inv(2,MOD)%MOD\*(-2*n)%MOD;
                            ttt = (ttt%MOD+MOD)%MOD;
                            long long s1,s2;
                            if(pos11%2 == 1)s1 = bt2.sum(pos12) - bt2.sum(pos11-1);
                            else s1 = bt3.sum(pos12) - bt3.sum(pos11-1);
                            if(pos21%2 == 1)s2 = bt2.sum(pos22) - bt2.sum(pos21-1);
                            else s2 = bt3.sum(pos22) - bt3.sum(pos21-1);
                            s1 = (s1 + s2)%MOD;
                            long long tttt = (tmp\*nn%MOD+s1\*ttt%MOD)%MOD;
                            tttt = (tttt%MOD + MOD)%MOD;
                            ans = (ans + tttt)%MOD;
                        }
                        if(idcnt%2 != 0){
                            int pos1 = 1;
                            int pos2 = n;
                            if( ((id2-2)*n + 1-l)%2 != 0 )pos1++;
                            if(pos2%2 != pos1%2)pos2--;
                            if(pos2 &gt;= pos1){
                                ans += SUM(pos1,pos2,r - ((id2-2)*n + pos1) + 1);
                                ans = (ans%MOD+MOD)%MOD;
                            }
                        }
                    }
                }
                printf(&quot;%lld\\n&quot;,ans);
            }
        }
    }
}
return 0;
</code></pre><p>}</p>

          
        
      
    </div>

    

    
    
    
	
	<div>
		
	</div>
 
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kuangbin.github.io/2014/09/05/hdu4742-kd/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kuangbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blogLogo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kuangbin的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/09/05/hdu4742-kd/" itemprop="url">
                  HDU 4742 Pinball Game 3D （KD树）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2014-09-05 23:55:30" itemprop="dateCreated datePublished" datetime="2014-09-05T23:55:30+08:00">2014-09-05</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-29 20:59:52" itemprop="dateModified" datetime="2018-07-29T20:59:52+08:00">2018-07-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Online-Judge/" itemprop="url" rel="index"><span itemprop="name">Online Judge</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/HDU/" itemprop="url" rel="index"><span itemprop="name">HDU</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/数据结构/" itemprop="url" rel="index"><span itemprop="name">数据结构</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/KD树/" itemprop="url" rel="index"><span itemprop="name">KD树</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="HDU4742"><a href="#HDU4742" class="headerlink" title="HDU4742"></a><a href="http://acm.hdu.edu.cn/showproblem.php?pid=4742" target="_blank" rel="noopener">HDU4742</a></h2><p>用cdq分治搞了这题以后，再用KD树搞一发，KD树也挺裸的了，就是求一个范围里面的最小值。  </p>
<h1 id="Pinball-Game-3D"><a href="#Pinball-Game-3D" class="headerlink" title="Pinball Game 3D"></a>Pinball Game 3D</h1><p><strong>Time Limit: 10000/5000 MS (Java/Others)    Memory Limit: 32768/32768 K (Java/Others) Total Submission(s): 633    Accepted Submission(s): 256</strong>  </p>
<p>Problem Description</p>
<p>RD is a smart boy and excel in pinball game. However, playing common 2D pinball game for a great number of times results in accumulating tedium. Recently, RD has found a new type of pinball game, a 3D pinball game. The 3D pinball game space can be regarded as a three dimensional coordinate system containing N balls. A ball can be considered as a point. At the beginning, RD made a shot and hit a ball. The ball hit by RD will move and may hit another ball and the “another ball” may move and hit another another ball, etc. But once a ball hit another ball, it will disappear. RD is skilled in this kind of game, so he is able to control every ball’s moving direction. But there is a limitation: if ball A’s coordinate is (x1,y1,z1) and ball B’s coordinate is (x2,y2,z2), then A can hit B only if x1 &lt;= x2 and y1 &lt;= y2 and z1 &lt;= z2. Now, you should help RD to calculate the maximum number of balls that can be hit and the number of different shooting schemes that can achieve that number. Two schemes are different if the sets of hit balls are not the same. The order doesn’t matter.</p>
<p>Input</p>
<p>The first line contains one integer T indicating the number of cases. In each case, the first line contains one integer N indicating the number of balls. The next N lines each contains three non-negative integer (x, y, z), indicating the coordinate of a ball. The data satisfies T &lt;= 3, N &lt;= 105, 0 &lt;= x, y, z &lt;= 230, no two balls have the same coordinate in one case.</p>
<p>Output</p>
<p>Print two integers for each case in a line, indicating the maximum number of balls that can be hit and the number of different shooting schemes. As the number of schemes can be quite large, you should output this number mod 230.</p>
<p>Sample Input</p>
<p>2 3 2 0 0 0 1 0 0 1 1 5 3 0 0 0 1 0 0 0 1 0 2 2 3 3 3</p>
<p>Sample Output</p>
<p>2 1 3 2</p>
<p><em>Hint</em></p>
<p>In the first case, RD can shoot the second ball at first and hit the third ball indirectly. In the second case, RD can shoot the second or the third ball initially and hit the fourth ball as well as the fifth ball. Two schemes are both the best.</p>
<pre><code>直接上代码了！！！！
</code></pre><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ***************</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Author        :kuangbin</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Created Time  :2014/9/4 23:32:36</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">File Name     :E:\2014ACM\专题学习\KD树\HDU4742.cpp</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">************************************************ */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">100010</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MOD = <span class="number">1</span>&lt;&lt;<span class="number">30</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x7fffffff</span>;<span class="comment">//这个一定要够大</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line"></span><br><span class="line">	pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;e,sub,cur;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">bool</span> div;</span><br><span class="line"></span><br><span class="line">	Node *lc,*rc;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Node pool[MAXN],*tail;</span><br><span class="line"></span><br><span class="line">Node *root;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmpX</span><span class="params">(<span class="keyword">const</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; &amp;a,<span class="keyword">const</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; &amp;b)</span></span>&#123;<span class="keyword">return</span> a.first &lt; b.first || (a.first ==  b.first &amp;&amp; a.second &lt; b.second);&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmpY</span><span class="params">(<span class="keyword">const</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; &amp;a,<span class="keyword">const</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; &amp;b)</span></span>&#123;<span class="keyword">return</span> a.second &lt; b.second || (a.second == b.second &amp;&amp; a.first &lt; b.first);&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">const</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; &amp;a,<span class="keyword">const</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; &amp;b,<span class="keyword">bool</span> div)</span></span>&#123;<span class="keyword">return</span> div?cmpY(a,b):cmpX(a,b);&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Node* <span class="title">build</span><span class="params">(pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; *a,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">bool</span> div)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(l &gt;= r)<span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">	Node *p = tail++;</span><br><span class="line"></span><br><span class="line">	p-&gt;div = div;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> mid = (l+r)/<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">	nth_element(a+l,a+mid,a+r,div?cmpY:cmpX);</span><br><span class="line"></span><br><span class="line">	p-&gt;e = a[mid];</span><br><span class="line"></span><br><span class="line">	p-&gt;cur = p-&gt;sub = make_pair(<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">	p-&gt;lc = build(a,l,mid,!div);</span><br><span class="line"></span><br><span class="line">	p-&gt;rc = build(a,mid+<span class="number">1</span>,r,!div);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> p;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; &amp;a,pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; b)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(a.first &lt; b.first)a = b;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(a.first == b.first)&#123;</span><br><span class="line"></span><br><span class="line">		a.second += b.second;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(a.second &gt;= MOD)a.second -= MOD;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(Node *p,pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; e,pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; v)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	update(p-&gt;sub,v);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(e == p-&gt;e)&#123;</span><br><span class="line"></span><br><span class="line">		update(p-&gt;cur,v);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(cmp(p-&gt;e,e,p-&gt;div))add(p-&gt;rc,e,v);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">else</span> add(p-&gt;lc,e,v);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;ans;</span><br><span class="line"></span><br><span class="line"><span class="comment">//查询最大值</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get</span><span class="params">(Node *p,pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;e,<span class="keyword">int</span> maxx,<span class="keyword">int</span> maxy)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(!p)<span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(p-&gt;sub.first &lt; ans.first)<span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(maxx &lt;= e.first &amp;&amp; maxy &lt;= e.second)</span><br><span class="line"></span><br><span class="line">		update(ans,p-&gt;sub);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(p-&gt;e.first &lt;= e.first &amp;&amp; p-&gt;e.second &lt;= e.second)update(ans,p-&gt;cur);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(p-&gt;div)&#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(p-&gt;e.second &lt;= e.second)get(p-&gt;rc,e,maxx,maxy);</span><br><span class="line"></span><br><span class="line">			get(p-&gt;lc,e,maxx,min(maxy,p-&gt;e.second));</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(p-&gt;e.first &lt;= e.first)get(p-&gt;rc,e,maxx,maxy);</span><br><span class="line"></span><br><span class="line">			get(p-&gt;lc,e,min(maxx,p-&gt;e.first),maxy);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">TNode</span>&#123;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> x,y,z;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">input</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;x,&amp;y,&amp;z);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> TNode &amp;b)<span class="keyword">const</span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(x != b.x)<span class="keyword">return</span> x &lt; b.x;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(y != b.y)<span class="keyword">return</span> y &lt; b.y;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">return</span> z &lt; b.z;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;node[MAXN];</span><br><span class="line"></span><br><span class="line">pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;p[MAXN];</span><br><span class="line"></span><br><span class="line">pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;dp[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(T--)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)&#123;</span><br><span class="line"></span><br><span class="line">			node[i].input();</span><br><span class="line"></span><br><span class="line">			p[cnt++] = make_pair(node[i].y,node[i].z);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		sort(node,node+n);</span><br><span class="line"></span><br><span class="line">		sort(p,p+cnt);</span><br><span class="line"></span><br><span class="line">		cnt = unique(p,p+cnt)-p;</span><br><span class="line"></span><br><span class="line">		tail = pool;</span><br><span class="line"></span><br><span class="line">		root = build(p,<span class="number">0</span>,cnt,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)dp[i] = make_pair(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)&#123;</span><br><span class="line"></span><br><span class="line">			ans = make_pair(<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">			get(root,make_pair(node[i].y,node[i].z),INF,INF);</span><br><span class="line"></span><br><span class="line">			ans.first++;</span><br><span class="line"></span><br><span class="line">			update(dp[i],ans);</span><br><span class="line"></span><br><span class="line">			add(root,make_pair(node[i].y,node[i].z),dp[i]);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>,root-&gt;sub.first,root-&gt;sub.second);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    
	
	<div>
		
	</div>
 
	<div>
      
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/7/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><span class="page-number current">8</span><a class="page-number" href="/page/9/">9</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><a class="extend next" rel="next" href="/page/9/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/blogLogo.jpg"
                alt="kuangbin" />
            
              <p class="site-author-name" itemprop="name">kuangbin</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">128</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">150</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">53</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  <a href="https://github.com/kuangbin" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://www.linkedin.com/in/kuangbin/" target="_blank" title="Linkedin"><i class="fa fa-fw fa-globe"></i>Linkedin</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:kuangbin2009@126.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://www.zhihu.com/people/kuang-bin-95" target="_blank" title="zhihu"><i class="fa fa-fw fa-globe"></i>zhihu</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="http://www.cnblogs.com/kuangbin/" target="_blank" title="cnblogs"><i class="fa fa-fw fa-globe"></i>cnblogs</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="http://wpa.qq.com/msgrd?v=3&uin=1691626124&site=qq&menu=yes" target="_blank" title="QQ"><i class="fa fa-fw fa-globe"></i>QQ</a>
                  
                </span>
              
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-友情链接"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.cnblogs.com/kuangbin/" title="我的博客园" target="_blank">我的博客园</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://zhiyi.live/" title="MoonChasing" target="_blank">MoonChasing</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://taowusheng.cn/" title="YIFEI" target="_blank">YIFEI</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://fancypei.github.io/" title="Fancy" target="_blank">Fancy</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://vincentxwd.github.io/" title="Wendong Xu" target="_blank">Wendong Xu</a>
                  </li>
                
              </ul>
            </div>
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">kuangbin</span>

  

  
</div>




  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动 v3.7.1</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://theme-next.org">NexT.Pisces</a> v6.3.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>












  















  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.3.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.3.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.3.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.3.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.3.0"></script>



  



  










  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  
  

  

  

  

  

  

</body>
</html>
